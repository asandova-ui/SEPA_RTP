# Project Directory Structure:
.
├── .gptree_config
├── MemoriaTFG/
│   ├── Codes/
│   │   └── example.m
│   ├── Imagenes/
│   │   ├── 4CornerModel.pdf
│   │   ├── 4CornerModel.png
│   │   ├── Arranque1.png
│   │   ├── CU01.pdf
│   │   ├── CU01.svg
│   │   ├── CU01.svg:Zone.Identifier
│   │   ├── CU02.pdf
│   │   ├── CU02.svg
│   │   ├── CU02.svg:Zone.Identifier
│   │   ├── ConexionSockets.png
│   │   ├── Cuentas.png
│   │   ├── DIAGRAMA.pdf
│   │   ├── DIAGRAMA.pdf:Zone.Identifier
│   │   ├── DIAGRAMA.svg
│   │   ├── DIAGRAMA.svg:Zone.Identifier
│   │   ├── DIAGRAMAaER.pdf
│   │   ├── DIAGRAMAaER.pdf:Zone.Identifier
│   │   ├── DIAGRAMAaER.svg
│   │   ├── DIAGRAMAaER.svg:Zone.Identifier
│   │   ├── DashBoard.png
│   │   ├── DiagComp.pdf
│   │   ├── DiagComp.svg
│   │   ├── DiagComp.svg:Zone.Identifier
│   │   ├── DiagEstado.pdf
│   │   ├── DiagEstado.svg
│   │   ├── DiagEstado.svg:Zone.Identifier
│   │   ├── ER.pdf
│   │   ├── ER.svg
│   │   ├── ER.svg:Zone.Identifier
│   │   ├── Flujo.png
│   │   ├── LayerComp.png
│   │   ├── LoginForm.png
│   │   ├── MAPA.png.avif
│   │   ├── MAQUINAESTADOS.pdf
│   │   ├── MAQUINAESTADOS.pdf:Zone.Identifier
│   │   ├── MAQUINAESTADOS.svg
│   │   ├── MAQUINAESTADOS.svg:Zone.Identifier
│   │   ├── MiAPITFG.png
│   │   ├── Notification.png
│   │   ├── PaisesSEPA.png
│   │   ├── PaisesSEPA2.avif
│   │   ├── Perfil.png
│   │   ├── RunResults.png
│   │   ├── SEPA-direct-debit-logo.png
│   │   ├── Tarjetas.png
│   │   ├── Universidad-de-Valladolid.png
│   │   ├── baseURL.png
│   │   ├── crearActor.png
│   │   ├── crearActorResponse.png
│   │   ├── crearRTP.png
│   │   ├── crearRTPResponse.png
│   │   ├── decision.png
│   │   ├── decisionResponse.png
│   │   ├── enrutarBenef.png
│   │   ├── enrutarBenefResponse.png
│   │   ├── error1.png
│   │   ├── error2_1.png
│   │   ├── error2_2.png
│   │   ├── error3.png
│   │   ├── esq1.png
│   │   ├── esq2.png
│   │   ├── logoETSIT.jpeg
│   │   ├── logs.png
│   │   ├── logsResponse.png
│   │   ├── treeB.pdf
│   │   ├── treeB.png
│   │   ├── validarBenef.png
│   │   ├── validarBenefResponse.png
│   │   ├── validarPayer.png
│   │   └── validarPayerResponse.png
│   ├── MemoriaTFG.pdf
│   ├── bibliografia.bib
│   ├── castellano2.bst
│   ├── main.aux
│   ├── main.bbl
│   ├── main.bcf
│   ├── main.blg
│   ├── main.fdb_latexmk
│   ├── main.fls
│   ├── main.lof
│   ├── main.log
│   ├── main.lol
│   ├── main.lot
│   ├── main.out
│   ├── main.run.xml
│   ├── main.synctex.gz
│   ├── main.tex
│   ├── main.toc
│   └── src/
│       ├── agradecimientos.tex
│       ├── codigos.tex
│       ├── conclusiones.tex
│       ├── diseño.tex
│       ├── estado_arte.tex
│       ├── implementacion.tex
│       ├── implementacion_past.tex
│       ├── introduccion.tex
│       ├── metodos.tex
│       ├── resultados.tex
│       ├── resumen.tex
│       └── validacion.tex
├── backend/
│   ├── app.py
│   ├── config.py
│   ├── ext_socketio.py
│   ├── models.py
│   ├── requirements.txt
│   ├── routes.py
│   ├── routes_actors.py
│   ├── rtp.db
│   ├── services.py
│   ├── utils.py
│   └── utils_roles.py
└── frontend/
    ├── RTP.html
    ├── RTP.js
    ├── app.js
    ├── index.html
    └── styles.css

# BEGIN FILE CONTENTS

# File: MemoriaTFG/Codes/example.m

 fID1 = fopen('myoutput1.txt','r');
 for n = 1:4
    b = fscanf(fID1,'%7u %7u %7u \r',3);
    btotal = b(1)+b(2)+b(3);
    fprintf('%7u + %7u + %7u = %7u \r', b(1), b(2), b(3), btotal)
 end

# END FILE CONTENTS


# File: MemoriaTFG/src/introduccion.tex

\chapter{Introducción}
\label{sec:Introduccion}

Para comprender el entorno actual de los pagos en Europa, conviene arrancar por la \emph{Single Euro Payments Area} (SEPA): un espacio comunitario en el que todos los pagos en euros se rigen por los mismos estándares técnicos y normas operativas, de modo que enviar dinero de un país a otro resulta tan ágil y claro como una transferencia nacional\cite{ecb_sepa}. SEPA estableció protocolos de mensajería comunes, armonizó los plazos de liquidación y fijó reglas uniformes de protección al usuario, creando la base sobre la que se despliegan hoy los servicios de pago más innovadores.

En los últimos diez años, la digitalización de los servicios financieros ha cambiado por completo cómo particulares y empresas gestionan sus transacciones dentro de ese marco SEPA. Las transferencias instantáneas, las API abiertas de los bancos y el auge del comercio electrónico han disparado la demanda de procesos de cobro que sean sencillos, transparentes y en tiempo real. No obstante, los instrumentos de pago tradicionales (tarjetas, transferencias convencionales o domiciliaciones) nacieron en un contexto muy distinto y todavía arrastran limitaciones que penalizan tanto la experiencia de usuario como la eficiencia operativa.

Aquí es donde entra en juego \emph{Request-to-Pay} (RTP). Este servicio de mensajería permite al beneficiario enviar al pagador una solicitud de pago digital estructurada, con todos los detalles (importe, concepto, vencimiento), y recibir en segundos una respuesta (aceptación, rechazo o aplazamiento) antes de iniciar el movimiento de fondos. RTP no sustituye los métodos de pago existentes, sino que actúa como una capa de orquestación sobre la infraestructura SEPA (y, en especial, los pagos inmediatos) y los canales de banca online, facilitando la conciliación, reduciendo la fricción en el cobro y modernizando la experiencia tanto para empresas como para consumidores.

\section{Motivación}
\label{subsec:Motivacion}

La domiciliación bancaria, regulada por el esquema \textit{SEPA Direct Debit} (\textbf{SDD})\cite{epc_sdd_2025} (instrumento paneuropeo de cargo en cuenta regulado por el \emph{European Payments Council} (EPC)) desde 2014, sigue siendo el método principal para cobros recurrentes en España. No obstante, su estructura, pensada para un entorno de procesos \emph{offline} genera hoy inconvenientes que chocan con las demandas de inmediatez, seguridad y experiencia de usuario fluida que caracterizan la economía digital actual. Así se detectan una serie de ineficiencias, que se describen en la sección \ref{subsec:ineficiencias}, y una oportunidad de introducir un nuevo método de pago que solvente dichas ineficiencias, el cual se presenta en la sección \ref{subsec:oportunidadRTP}.

\subsection{Ineficiencias operativas detectadas}
\label{subsec:ineficiencias}

Tras analizar la operativa SDD nacional se han identificado una serie de ineficiencias que afectan tanto a los usuarios como a las entidades participantes en el proceso de pago resumidas en los siguientes \textbf{5} puntos:
\begin{enumerate}[label=\textbf{\arabic*.}, leftmargin=0.75cm]
      \item \textbf{Modelo offline y necesidad de mandato físico}\\
            El proceso de pago mediante el esquema SDD opera bajo un modelo offline, lo que implica una ausencia total de interacción en tiempo real entre las partes involucradas. Para iniciar el cobro, el deudor debe firmar y enviar un \textbf{mandato SEPA} en formato físico. Este mandato es un documento mediante el cual el deudor autoriza al acreedor a realizar cobros automáticos a través de la domiciliación bancaria. El documento debe ser conservado por el acreedor durante toda la duración del contrato y hasta 14 meses después de la última transacción realizada. Aunque la digitalización ha avanzado en muchos ámbitos, aún no existe un estándar único y interoperable para los \textit{\textbf{eMandates}}, que son la versión electrónica de los mandatos SEPA que permitem autorizar cobros de manera digital, lo que lleva a que cada entidad bancaria implemente su propio sistema. Esta falta de uniformidad genera inconsistencias y dificulta la estandarización del proceso.\\
            \textbf{Consecuencias}:
      \begin{itemize}
            \item Fricciones significativas en los procesos de venta digital, ya que los usuarios deben completar pasos adicionales que rompen con la inmediatez esperada en el comercio electrónico actual.
            \item Costes operativos considerables asociados a la gestión administrativa, como el archivado, las auditorías y el mantenimiento de los mandatos físicos.
            \item Riesgos legales y financieros en caso de disputa, como devoluciones costosas o conflictos prolongados con los deudores, debido a la ausencia de un mandato válido.
      \end{itemize}

  \item \textbf{Derecho a devolución prolongado}\\
        El esquema SDD otorga al deudor un derecho a devolución excepcionalmente amplio, lo que genera incertidumbre en la gestión de los ingresos por parte de los acreedores. En el caso de un \emph{cobro autorizado}, el deudor puede solicitar la devolución del importe sin necesidad de justificar su decisión durante un periodo de \textbf{ocho semanas}, bajo la política conocida como \emph{“no-questions-asked”}. Por otro lado, si el cobro se clasifica como \emph{no autorizado} (por ejemplo, si el banco emisor no puede probar la existencia de un mandato válido), el plazo para reclamar se extiende hasta \textbf{trece meses}.
        
        \textbf{Consecuencias}:
        \begin{itemize}
          \item Notable inseguridad para los acreedores, quienes deben mantener reservas de liquidez y provisiones contables para cubrir posibles devoluciones tardías.
          \item Facilitación de prácticas como el \emph{friendly fraud}\footnote{El \emph{friendly fraud} ocurre cuando un usuario consume un bien o servicio y, posteriormente, solicita una devolución sin justificación, aprovechando las políticas de devolución laxas.}, donde los deudores reclaman reembolsos injustificados tras haber recibido el producto o servicio.
          \item Impacto directo en la rentabilidad de las empresas debido a las devoluciones inesperadas.
        \end{itemize}

  \item \textbf{Ciclos de cobro lentos}\\
        Los tiempos de procesamiento en el esquema SDD son significativamente prolongados, lo que compromete tanto la eficiencia operativa como la experiencia del usuario. En el esquema \textsc{Core} \cite{epc016}, el acreedor debe enviar la orden de cobro al banco con una antelación de \textbf{D-5 días} para la primera domiciliación y de \textbf{D-2 días} para las domiciliaciones recurrentes. A esto se suman \textbf{dos días adicionales} para la liquidación interbancaria. En total, el proceso puede demorar entre seis y ocho días naturales desde que se solicita el cobro hasta que se confirma el abono, un plazo incompatible con las expectativas de inmediatez en la venta de bienes o servicios digitales.
        
        \textbf{Consecuencias}:
        \begin{itemize}
          \item Afectación en la planificación financiera de las empresas, ya que los ingresos no están disponibles de manera inmediata, generando una tesorería imprevisible.
          \item Riesgo de prestar servicios o entregar productos sin la certeza de que el pago se completará con éxito.
          \item Pérdidas económicas significativas debido a la falta de confirmación inmediata del pago.
        \end{itemize}

  \item \textbf{Costes y complejidad de las R-transactions}\\
        Las \textbf{R-transactions}, que son transacciones de rechazo, devolución o reembolso asociadas a pagos fallidos o no autorizados, representan una fuente notable de complicaciones y costes adicionales. Estas transacciones se clasifican mediante diversos códigos, cada uno asociado a un flujo y reglas específicas, lo que dificulta su gestión y seguimiento. Los acreedores deben dedicar recursos a identificar las causas de cada R-transaction y aplicar las medidas correctivas correspondientes, un proceso que frecuentemente requiere intervención manual debido a la falta de automatización.
        
        \textbf{Consecuencias}:
        \begin{itemize}
          \item Necesidad de equipos especializados en conciliación y recobro, incrementando los costes operativos.
          \item Reducción de la eficiencia general del sistema debido a la complejidad de los procesos.
          \item Posibilidad de errores o retrasos que afectan la productividad y la confianza en el esquema SDD.
        \end{itemize}

  \item \textbf{Ausencia de autorización fuerte}\\
        El esquema SDD se basa en un consentimiento previo otorgado mediante el mandato SEPA, pero no incorpora la \textbf{autorización fuerte del cliente (SCA)}, que es un requisito de seguridad que exige la verificación del usuario mediante al menos dos factores de autenticación \cite{EC_2018_RTS_SCA} en el momento de cada transacción. Una vez firmado el mandato, los cobros se ejecutan automáticamente sin que se solicite al deudor una autenticación adicional para cada operación.
        
        \textbf{Consecuencias}:
        \begin{itemize}
          \item Elevado riesgo de disputas por cargos no autorizados, lo que puede derivar en conflictos y devoluciones.
          \item Pérdida de una oportunidad clave para fortalecer la seguridad y la confianza en el proceso de cobro mediante métodos de autenticación modernos.
        \end{itemize}
\end{enumerate}

% Conclusión
\paragraph{En conclusión.} Estas ineficiencias tienen un gran impacto en la operativa y la competitividad de las empresas y entidades financieras que lo utilizan y se traducen en:

\begin{itemize}[leftmargin=0.45cm]
  \item Una \textbf{estructura de costes elevada}, derivada de la alta frecuencia de devoluciones y la necesidad de personal especializado para gestionarlas, lo que incrementa los gastos operativos.
  \item \textbf{Liquidez incierta}, ya que los ingresos no se confirman de inmediato y pueden ser revertidos incluso meses después de haberse registrado, dificultando la gestión financiera.
  \item Un \textbf{freno al desarrollo de la economía digital}, puesto que el SDD no está diseñado para ofrecer experiencias de pago instantáneas y fluidas, como las que proporcionan métodos alternativos como las tarjetas de crédito, los monederos electrónicos o plataformas como Bizum.
\end{itemize}

\subsection{Oportunidad de un esquema RTP}
\label{subsec:oportunidadRTP}
El estándar \textit{SEPA RTP} (\textbf{SRTP}) aborda de manera efectiva las limitaciones técnicas y operativas del SDD, ofreciendo una laternativa más ágil y adaptada al entorno digital.

A continuación se describen las principales ventajas del SRTP frente al SDD:

\begin{enumerate}[label=\alph*)]
  \item \textbf{Autenticación reforzada y consentimiento digital inmediato}\\
      El SRTP reemplaza el mandato físico del SDD por una solicitud de pago que el deudor aprueba directamente desde su banca en línea o wallet digital mediante SCA. Este proceso genera una prueba eléctronica de consentimiento, firmada y resgistrada en el sistema del Payment Service Provider (PSP) del pagador, eliminando la dependencia de documentos en papel y simplificando la gestión de autorizaciones.

  \item \textbf{Irrevocabilidad y mitigación de fraude \emph{post-servicio}}\\
      Una vez aceptada la solicitd, el pago se ejecuta mediante SCT Inst, que es una transferencia inmediata SEPA con liquidación en menos de 10 s \cite{epc_sctinst_2025}. A diferencia del SDD que permite devoluciones automáticas en plazos amplios, el SRTP no admite reversiones sin causa justificada. Esto minimiza el riesgo de \textit{friendly fraud} y reduce la necesidad de provisiones por impagos.

  \item \textbf{Liquidez \emph{real-time} y conciliación automática}\\
      Con fondos disponibles en menos de 10 segundos, las empresas pueden gestionar su tesorería con mayor precisión. Además, el uso de identificadores únicos y referencias estructuradas según el estándar ISO 20022 \cite{iso20022_55005}, asegura que la información del pago se transmita íntegramente de extremo a extremo, permitiendo una conciliación automática y eliminando los retrasos y errores típicos del SDD.

  \item \textbf{Simplificación operativa}\\
      El SRTP elimina las R-transactions, la custodia de mandatos físicos y las tareas administrativas asociadas. El flujo se reduce a dos mensajes principales -solicitud y aceptación-, con la opción de una transferenciua instantánea, ofreciendo una trazabilidad clara y directa.

  \item \textbf{Flexibilidad comercial y costes reducidos}\\
      Este esquema soporta cobros únicos, recurrentes o fraccionados a través de canales digitales como enlaces profundos, códigos QR o APIs. Al estar basado en SCT Inst, las comisiones bancarias son bastante menores a las de las tarjetas o la gestión de devoluciones del SDD, lo que mejora la eficiencias y amplía su aplicabilidad en el comercio electrónico.
\end{enumerate}

En conjunto, el SRTP conserva los puntos fuertes del SDD pero los adapta a las necesidades actuales, proporcionando una solución más rápida, segura y eficiente. Al superar las ineficiencias del SDD se convierte en una herramienta clave para modernizar los sistema de pago en la zona SEPA y, en concreto, en España.
\vspace{0.5cm}

\begin{table}[h]
\centering
\caption{Comparativa entre SDD y SRTP con SCT Inst}
\label{tab:comparativa-sdd-srtp}
\renewcommand{\arraystretch}{1.2}
\begin{tabular}{@{}L{4.8cm}C{4.8cm}C{4.8cm}@{}}
\toprule
\textbf{Aspecto} & \textbf{SDD} & \textbf{SRTP (+ SCT Inst)} \\
\midrule
Autorización & Mandato off-line & Consentimiento digital (\textsc{sca}) \\
Plazo de devolución & 8 semanas / 13 meses & No aplica (irrevocable) \\
Disponibilidad de fondos & 5--8 días & Menos de 10 segundos \\
Coste operativo & Alto (mandatos, \textsc{r-codes}) & Bajo (mensajería ISO 20022) \\
Cobertura \emph{e-commerce} & Limitada & Amplia (API / móvil) \\
Riesgo de fraude & Medio-Alto (devoluciones) & Bajo (\textsc{sca} + irreversibilidad) \\
\bottomrule
\end{tabular}
\end{table}

\bigskip


\section{Objetivos fundamentales}
\label{subsec:Objetivos}
El propósito de este Trabajo de Fin de Grado es \textbf{demostrar}, de forma general, \textbf{cómo el esquema SRTP puede subsanar las ineficiencias operativas del SDD} y adaptarse al contexto digital actual. Para ello \textbf{se plantea el desarrollo de un prototipo de referencia que reproduzca el ciclo completo de una petición de pago} y permita evaluar sus ventajas frente al modelo tradicional. De manera deliberada, en esta sección los objetivos se formulan en términos generales; los detalles de implementación (arquitectura, tecnologías y herramientas concretas) se presentan más adelante, en el capítulo de Diseño (\ref{sec:diseno}).

A continuación se recogen los objetivos principales, ordenados de lo general a lo particular:

\begin{itemize}
    \item \textbf{Demostrar la viabilidad del SRTP como alternativa al SDD} \\
    Validar que un flujo basado en solicitudes de pago inmediatas ofrece mayor agilidad, trazabilidad y control que la domiciliación bancaria, sin comprometer la seguridad ni la interoperabilidad dentro del ecosistema SEPA.
    
    \item \textbf{Emular de extremo a extremo el ciclo operativo de un proveedor RTP}\\
    Construir un prototipo funcional que reproduzca los pasos esenciales de una operación SRTP (creación, presentación, decisión, ejecución y cierre) implicando a los actores y mensajes definidos por el \textit{rulebook} \cite{epc014}.
    
    \item \textbf{Garantizar integridad, confidencialidad y trazabilidad de las transacciones}\\
    Incorporar salvaguardas de seguridad y gobierno del dato que permitan certificar el origen de cada mensaje, registrar su histórico de estados y conservar evidencias de consentimiento digital.
    
    \item \textbf{Facilitar la interacción en tiempo real entre los participantes}\\
    Asegurar que los eventos relevantes del ciclo (solicitud, aceptación, rechazo, expiración, etc.) se propaguen al instante, de modo que pagador y beneficiario dispongan siempre de información actualizada para la toma de decisiones.
    
    \item \textbf{Proveer una base flexible y extensible para futuras integraciones}\\
    Diseñar la solución de manera modular, de modo que pueda evolucionar hacia escenarios de producción y aplicaciones reales o incorporar mejoras como autenticación reforzada y analítica de eventos.
    
    \item \textbf{Evaluar el desempeño y las limitaciones del prototipo mediante pruebas controladas}\\
    Someter la solución a distintos escenarios (casos favorables, errores operativos, etc) y contrastar los resultados con los objetivos de negocio y los requisitos técnicos del esquema SRTP.
    
    \item \textbf{Documentar los aprendizajes y proponer líneas de mejora}\\
    Reflejar de forma crítica las decisiones tomadas, las diferencias respecto a la especificación oficial y las oportunidades para optimizar, escalar o industrializar la solución en trabajos posteriores.
\end{itemize}

En definitiva, este TFG busca construir una solución práctica que demuestre el potencial del SRTP para superar las trabas del SDD, usando tecnologías modernas y un enfoque riguroso. Este prototipo no solo debe cumplir con los estándares técnicos, sino que también inspire confianza en una nueva forma de gestionar pagos en Europa.

\section{Fases y Métodos}
\label{subsec:FasesMetodos}
El TFG se ha estructurado en 3 fases principales:

\begin{description}
  \item[Fase 1 – Análisis y planificación]\\
      En esta primera etapa se estudiará el mundo de los pagos en la zona SEPA, revisando los documentos emitidos por el EPC \cite{EPC_official} para identificar las posibles mejoras que el RTP podría suponer.
      
      Luego, se estudiaron los casos de uso del RTP, identificando qué necesitan hacer los actores principales y se planificará el prototipo.
  \item[Fase 2 – Diseño e implementación]\\
      Una vez claro el contexto, se comenzará a diseñar la estructura del prototipo definiendo los roles de los actores y cómo interactúan entre si.
      La implementación se llevará a cabo usando herramientas que se detallarán en el capítulo de diseño (\ref{sec:diseno}) e implementación (\ref{sec:implementacion}).
  \item[Fase 3 – Pruebas y validación]\\
      Por último, una vez implementado el prototipo se realizarán una serie de pruebas y comprobaciones para verificar que todo funciona correctamente, como veremos en el capítulo de validación (\ref{sec:validacion}).
\end{description}



# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/CU01.svg:Zone.Identifier



# END FILE CONTENTS


# File: MemoriaTFG/main.lof

\boolfalse {citerequest}\boolfalse {citetracker}\boolfalse {pagetracker}\boolfalse {backtracker}\relax 
\babel@toc {english}{}
\babel@toc {spanish}{}
\babel@toc {spanish}{}
\babel@toc {english}{}
\babel@toc {spanish}{}
\addvspace {10\p@ }
\addvspace {10\p@ }
\contentsline {figure}{\numberline {2.1}{\ignorespaces Modelo de 4 esquinas}}{9}{figure.2.1}%
\contentsline {figure}{\numberline {2.2}{\ignorespaces Diagrama de flujo de intercambio RTP}}{11}{figure.2.2}%
\contentsline {figure}{\numberline {2.3}{\ignorespaces Esquema por capas}}{19}{figure.2.3}%
\contentsline {figure}{\numberline {2.4}{\ignorespaces LayerComp}}{21}{figure.2.4}%
\addvspace {10\p@ }
\contentsline {figure}{\numberline {3.1}{\ignorespaces Diagrama de secuencia para CU‑01 (crear solicitud RTP).}}{30}{figure.3.1}%
\contentsline {figure}{\numberline {3.2}{\ignorespaces Diagrama de secuencia para CU‑02 (decisión final RTP).}}{31}{figure.3.2}%
\contentsline {figure}{\numberline {3.3}{\ignorespaces Modelo entidad-relación del prototipo.}}{32}{figure.3.3}%
\contentsline {figure}{\numberline {3.4}{\ignorespaces Arquitectura lógica y flujo de dependencias del prototipo.}}{34}{figure.3.4}%
\contentsline {figure}{\numberline {3.5}{\ignorespaces Máquina de estados del objeto RTP.}}{35}{figure.3.5}%
\addvspace {10\p@ }
\contentsline {figure}{\numberline {4.1}{\ignorespaces Estructura en árbol del directorio}}{40}{figure.4.1}%
\addvspace {10\p@ }
\contentsline {figure}{\numberline {5.1}{\ignorespaces Variable \texttt {baseURL} en Postman}}{53}{figure.5.1}%
\contentsline {figure}{\numberline {5.2}{\ignorespaces crearActor}}{53}{figure.5.2}%
\contentsline {figure}{\numberline {5.3}{\ignorespaces crearActorResponse}}{54}{figure.5.3}%
\contentsline {figure}{\numberline {5.4}{\ignorespaces MiAPITFG}}{54}{figure.5.4}%
\contentsline {figure}{\numberline {5.5}{\ignorespaces RunResults}}{54}{figure.5.5}%
\contentsline {figure}{\numberline {5.6}{\ignorespaces crearRTP}}{55}{figure.5.6}%
\contentsline {figure}{\numberline {5.7}{\ignorespaces crearRTPResponse}}{55}{figure.5.7}%
\contentsline {figure}{\numberline {5.8}{\ignorespaces validarBenef}}{55}{figure.5.8}%
\contentsline {figure}{\numberline {5.9}{\ignorespaces validarBenefResponse}}{56}{figure.5.9}%
\contentsline {figure}{\numberline {5.10}{\ignorespaces enrutarBenef}}{56}{figure.5.10}%
\contentsline {figure}{\numberline {5.11}{\ignorespaces enrutarBenefResponse}}{56}{figure.5.11}%
\contentsline {figure}{\numberline {5.12}{\ignorespaces validarPayer}}{56}{figure.5.12}%
\contentsline {figure}{\numberline {5.13}{\ignorespaces validarPayerResponse}}{57}{figure.5.13}%
\contentsline {figure}{\numberline {5.14}{\ignorespaces decision}}{57}{figure.5.14}%
\contentsline {figure}{\numberline {5.15}{\ignorespaces decisionResponse}}{57}{figure.5.15}%
\contentsline {figure}{\numberline {5.16}{\ignorespaces error1}}{58}{figure.5.16}%
\contentsline {figure}{\numberline {5.17}{\ignorespaces error2\_1}}{58}{figure.5.17}%
\contentsline {figure}{\numberline {5.18}{\ignorespaces error2\_2}}{59}{figure.5.18}%
\contentsline {figure}{\numberline {5.19}{\ignorespaces error3}}{59}{figure.5.19}%
\addvspace {10\p@ }
\addvspace {10\p@ }


# END FILE CONTENTS


# File: MemoriaTFG/main.run.xml

<?xml version="1.0" standalone="yes"?>
<!-- logreq request file -->
<!-- logreq version 1.0 / dtd version 1.0 -->
<!-- Do not edit this file! -->
<!DOCTYPE requests [
  <!ELEMENT requests (internal | external)*>
  <!ELEMENT internal (generic, (provides | requires)*)>
  <!ELEMENT external (generic, cmdline?, input?, output?, (provides | requires)*)>
  <!ELEMENT cmdline (binary, (option | infile | outfile)*)>
  <!ELEMENT input (file)+>
  <!ELEMENT output (file)+>
  <!ELEMENT provides (file)+>
  <!ELEMENT requires (file)+>
  <!ELEMENT generic (#PCDATA)>
  <!ELEMENT binary (#PCDATA)>
  <!ELEMENT option (#PCDATA)>
  <!ELEMENT infile (#PCDATA)>
  <!ELEMENT outfile (#PCDATA)>
  <!ELEMENT file (#PCDATA)>
  <!ATTLIST requests
    version CDATA #REQUIRED
  >
  <!ATTLIST internal
    package CDATA #REQUIRED
    priority (9) #REQUIRED
    active (0 | 1) #REQUIRED
  >
  <!ATTLIST external
    package CDATA #REQUIRED
    priority (1 | 2 | 3 | 4 | 5 | 6 | 7 | 8) #REQUIRED
    active (0 | 1) #REQUIRED
  >
  <!ATTLIST provides
    type (static | dynamic | editable) #REQUIRED
  >
  <!ATTLIST requires
    type (static | dynamic | editable) #REQUIRED
  >
  <!ATTLIST file
    type CDATA #IMPLIED
  >
]>
<requests version="1.0">
  <internal package="biblatex" priority="9" active="1">
    <generic>latex</generic>
    <provides type="dynamic">
      <file>main.bcf</file>
    </provides>
    <requires type="dynamic">
      <file>main.bbl</file>
    </requires>
    <requires type="static">
      <file>blx-dm.def</file>
      <file>blx-compat.def</file>
      <file>biblatex.def</file>
      <file>standard.bbx</file>
      <file>alphabetic.bbx</file>
      <file>alphabetic.cbx</file>
      <file>biblatex.cfg</file>
      <file>english.lbx</file>
      <file>spanish.lbx</file>
    </requires>
  </internal>
  <external package="biblatex" priority="5" active="1">
    <generic>biber</generic>
    <cmdline>
      <binary>biber</binary>
      <infile>main</infile>
    </cmdline>
    <input>
      <file>main.bcf</file>
    </input>
    <output>
      <file>main.bbl</file>
    </output>
    <provides type="dynamic">
      <file>main.bbl</file>
    </provides>
    <requires type="dynamic">
      <file>main.bcf</file>
    </requires>
    <requires type="editable">
      <file>bibliografia.bib</file>
    </requires>
  </external>
</requests>


# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/MAQUINAESTADOS.pdf:Zone.Identifier

[ZoneTransfer]
ZoneId=3
ReferrerUrl=https://convertio.co/
HostUrl=https://s142.convertio.me/p/z4G4WmG_jjvACtuNyDcCbg/a41c7c2113f6e5a22b7187c20642ecc7/MAQUINAESTADOS.pdf


# END FILE CONTENTS


# File: backend/models.py

from flask_sqlalchemy import SQLAlchemy

db = SQLAlchemy()

class Actor(db.Model):
    __tablename__ = 'actor'
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(50), unique=True)
    password = db.Column(db.String(50))
    name = db.Column(db.String(50), nullable=False)
    role = db.Column(db.String(20), nullable=False)

    photo_url = db.Column(db.String(200), nullable=True)  # URL o base64
    iban = db.Column(db.String(34), nullable=True)
    balance = db.Column(db.Float, default=0.0)

    # Campo nuevo: psp_id, que referencia a otro Actor que es PSP
    psp_id = db.Column(db.Integer, db.ForeignKey('actor.id'), nullable=True)
    # Relación para que se pueda acceder con actor.psp
    psp = db.relationship('Actor', remote_side=[id])

    def to_dict(self):
        return {
            "id": self.id,
            "username": self.username,
            "name": self.name,
            "role": self.role,
            "photo_url": self.photo_url,
            "iban": self.iban,
            "balance": self.balance,
            "psp_id": self.psp_id  # Podríamos incluir más info del psp, etc.
        }

class RTP(db.Model):
    __tablename__ = 'rtp'
    id = db.Column(db.Integer, primary_key=True)
    iban = db.Column(db.String(34), nullable=False)
    amount = db.Column(db.Float, nullable=False)
    status = db.Column(db.String(20), default="creado")
    timestamp = db.Column(db.DateTime, default=db.func.current_timestamp())
    beneficiary_id = db.Column(db.Integer)
    psp_beneficiary_id = db.Column(db.Integer)
    psp_payer_id = db.Column(db.Integer)
    payer_id = db.Column(db.Integer)

    def to_dict(self):
        return {
            "id": self.id,
            "iban": self.iban,
            "amount": self.amount,
            "status": self.status,
            "timestamp": self.timestamp.isoformat(),
            "beneficiary_id": self.beneficiary_id,
            "psp_beneficiary_id": self.psp_beneficiary_id,
            "psp_payer_id": self.psp_payer_id,
            "payer_id": self.payer_id
        }

class Log(db.Model):
    __tablename__ = 'log'
    id = db.Column(db.Integer, primary_key=True)
    rtp_id = db.Column(db.Integer, nullable=False)
    old_status = db.Column(db.String(20))
    new_status = db.Column(db.String(20))
    timestamp = db.Column(db.DateTime, default=db.func.current_timestamp())
    hash_value = db.Column(db.String(64))

    def to_dict(self):
        return {
            "id": self.id,
            "rtp_id": self.rtp_id,
            "old_status": self.old_status,
            "new_status": self.new_status,
            "timestamp": self.timestamp.isoformat(),
            "hash_value": self.hash_value
        }


# END FILE CONTENTS


# File: MemoriaTFG/src/diseño.tex

%--------------------------------------------------------------------
% 3 Diseño – SEPA Request‑to‑Pay Prototype (Clase `article`)
%--------------------------------------------------------------------
\chapter{Diseño}
\label{sec:diseno}

En este apartado se detalla la estrategia adoptada para \emph{emular, con un prototipo funcional, el comportamiento extremo‑a‑extremo del servicio SEPA RTP}. Se parte de los requisitos funcionales publicados en el \emph{EPC RTP Rulebook 4.0} y se traducen a casos de uso concretos, modelo de datos y flujos de interacción que servirán de base a la implementación descrita en el apartado~\ref{sec:implementacion}. Se persigue, ante todo, una visión que facilite al lector identificar primero el~\emph{qué} resuelve la solución y, a continuación, el~\emph{cómo} se materializa.

\section{Objetivos técnicos}
\label{subsec:diseno_objetivos}


El diseño e implementación del prototipo desarrollado responden a los objetivos técnicos fundamentales definidos en el capítulo \ref{subsec:Objetivos}. Estos objetivos buscan demostrar que el esquema SEPA RTP puede superar las limitaciones del sistema tradicional de domiciliación bancaria, ofreciendo una solución moderna, eficiente y adaptada a las demandas de la economía digital actual. A continuación se detallan estos objetivos en orden de prioridad, explicando qué se pretende conseguir con cada uno, cómo se implementaría y por qué son esenciales para el éxito del prototipo.

\begin{enumerate}[label=\textbf{\arabic*}]
  % Objetivo 1
  \item \textbf{Reproducir el ciclo RTP extremo a extremo}
    
    El propósito fundamental del prototipo es desarrollar un sistema que emule de manera completa y fiel el ciclo del esquema RTP, abarcando todas las etapas definidas en la tabla de pasos del SRTP \ref{tab:srtp-steps-b}. Esto implica que el prototipo debe ser capaz de replicar el flujo completo del proceso, desde el momento en que el beneficiario inicia una solicitud de pago hasta la resolución final por parte del pagador, incluyendo tanto escenarios exitosos como aquellos en los que se producen errores o rechazos.
    
    Se quiere que el sistema emule todas las operaciones clave del RTP: la creación de la solicitud por parte del beneficiario, la validación por parte de los PSP y la decisión final del pagador. Esto incluye manejar situaciones reales, como la falta de fondos del pagador o errores en los datos de la solicitud, para garantizar que el prototipo sea robusto y represente fielmente cómo funcionaría un proveedor de RTP en un entorno real.
    
    El sistema implementará una API basada en HTTP/JSON que cubra las operaciones principales de RTP. Además se diseñarán mecanismos para simular errores como IBAN inválidos o saldos insuficientes, y se registrarán los resultados de cada etapa para analizar su comportamiento.
    
    Reproducir el ciclo completo es esencial para demostrar que el RTP puede ser una alternativa viable al SDD, resolviendo los problemas como la lentitud o la falta de interacción en tiempo real y proporcionando una base sólida para futuras implementaciones reales.

  % Objetivo 2
  \item \textbf{Ofrecer notificación en tiempo real}
    
    Dado que el RTP es un esquema diseñado para operar en un entorno digital y online, se busca garantizar que todas las partes involucradas reciban información inmediata sobre cualquier cambio o evento relacionado con la solicitud de pago.

   Se quiere que el sistema notifique instantáneamente a los actores cada vez que ocurra un evento significativo, como la creación de una solicitud RTP, su validación por un PSP o la decisión final del pagador. Esto simulará la experiencia que un usuario tendría al recibir una notificación en su aplicación bancaria, permitiendo al pagador reaccionar rápidamente y al beneficiario conocer el estado de su solicitud sin demoras.

    Se utilizarán eventos de WebSocket, una tecnología que permite una comunicación bidireccional en tiempo real entre el servidor y los clientes. Por ejemplo, cuando el beneficiario crea una solicitud, el sistema enviará una notificación al pagador a través de una sala específica WebSocket; de manera similar, cuando el pagador tome una decisión, el beneficiario será informado de inmediato. Este enfoque asegura que las actualizaciones sean push en lugar de depender de consultas manuales.

    La inmediatez es una de las principales ventajas de RTP frente a SDD, que opera en un modelo offline con retrasos de días. Este objetivo refleja la necesidad de una experiencia de usuario fluida y ágil, alineada con las expectativas actuales de rapidez en el comercio digital.
  
  % Objetivo 3
  \item \textbf{Garantizar seguridad y trazabilidad}

    La seguridad y la capacidad de rastrear todas las acciones realizadas son pilares fundamentales para cualquier sistema de pagos, especialmente uno que aspire a ser adoptado en un contexto real.

    Se quiere que cada cambio de estado en una solicitud RTP quede registrado de forma segura e inalterable en la base de datos, permitiendo reconstruir el historial completo de cualquier solicitud en cualquier momento. Esto servirá para auditar el sistema, prevenir fraudes y resolver disputas entre las partes.

    Cada transición de estado se almacenará junto con un hash SHA-256, que asegura la integridad de los datos, y una marca de tiempo en formato UTC, que indica el momento exacto de la acción. Por ejemplo, si un PSP valida una solicitud, se generará un registro con estos elementos, y cualquier intento de modificar los datos será detectable gracias al hash. Además se implementarán controles de acceso por roles para limitar quién puede realizar cada acción.

    Sin seguridad y trazabilidad, el sistema será vulnerable a manipulaciones o ataques, lo que comprometería su credibilidad. Este objetivo asegura que el prototipo cumpla con los requisitos de confianza y auditoría, esenciales para su evolución hacia un sistema de producción.
  
  % Objetivo 4
  \item \textbf{Persistir la información de forma ligera}

    Es importante diseñar un sistema de almacenamiento que sea práctico para las fases iniciales del desarrollo y pruebas, pero que también permita crecer en el futuro si el prototipo se expande.

    Se quiere que la información generada por las solicitudes RTP se guarde de forma sencilla y sin requerir recursos excesivos durante el desarrollo, utilizando herramientas que no dependan de configuraciones complejas o servidores externos. Al mismo tiempo, quiero que el diseño sea flexible para adaptarse a necesidades mayores más adelante.

    Se empleará SQLite como base de datos, gestionada mediante SQLAlchemy, una biblioteca que facilita la interacción con los datos. SQLite es ideal para este prototipo porque es ligera, no requiere instalación adicional y funciona bien en entornos locales. Sin embargo, el sistema se estructurará de manera modular, permitiendo una migración futura a PostgreSQL u otra base de datos más robusta si el volumen de transacciones o usuarios aumenta.

    Un almacenamiento eficiente reduce la complejidad del desarrollo inicial y asegura que el prototipo sea fácil de instalar y probar. La flexibilidad para escalar es clave para que el sistema no quede obsoleto si se decide llevarlo a un entorno real.
  
  % Objetivo 5
  \item \textbf{Facilitar pruebas automatizadas e integración continua}

    Para garantizar la calidad y fiabilidad del prototipo, este objetivo busca establecer un proceso de verificación continua que detecte errores y asegure que el sistema funciona correctamente a medida que evoluciona.

    Se quiere crear un conjunto de pruebas que revisen automáticamente las funcionalidades del servidor y que estas pruebas se ejecuten de manera recurrente cada vez que se realicen cambios en el código. Esto asegurará que el sistema permanezca estable y funcional durante todo el desarrollo.

    Se diseñarán pruebas automáticas utilizando Postman, una herramienta que permite simular peticiones HTTP y validar las respuestas de la API. Estas pruebas cubrirán los endpoints principales y se integrarán en un flujo de integración continua.

    Las pruebas automatizadas son esenciales para mantener la calidad del software, especialmente en un prototipo que simula un sistema crítico como el RTP. Este objetivo reduce el riesgo de errores no detectados y facilita la incorporación de nuevas funcionalidades sin comprometer la estabilidad.

\end{enumerate}

\section{Actores y alcance}
\label{subsec:diseno_actores}

La emulacion del SRTP en este prototipo se basa en el modelo de cuatro esquinas expuesto anteriormente en la figura \ref{fig:4corner}. Este modelo es ampliamente utilizado en sistemas de pagos europeos porque proporciona un marco claro y seguro para gestionar transacciones, dividiendo las responsabilidades entre cuatro actores principales. Estos actores trabajan juntos para garantizar que una solicitud de pago fluya desde quien la inicia hasya quien debe responderla, pasando por intermediarios financieros que facilitan el proceso. A continuación se describen en detalle los actores y cómo interactúan, seguidos por una explicación del alcance de la emulación en el prototipo.

\textbf{Actores del modelo de cuatro esquinas}

Los cuatro actores que conforman el modelo son los siguientes:
\begin{description}
  \item[\textbf{Beneficiario.}]
  Es el comercio, empresa o persona que indica la solicitud de pago (RTP). Este actor es quien tiene la necesidad de recibir un pago, como un comercio enviando una factura a un cliente, una empresa de servicios solicitando el pago de una cuenta o incluso un individuo pidiendo dinero a otr. En el prototipo, el beneficiario es simulado para dar comienzo al proceso, enviando la solicitud de pago a su proveedor de servicios para que sea procesada.
  \item[\textbf{PSP Beneficiario.}]
  Este es el PSP que da soporte al beneficiario. Un PSP es tipicamente un banco, una entidad financiera o una plataforma de pagos que actúa en nombre del beneficiario. Su rol principal consiste en recibir la solicitud de pago iniciada por el beneficiario, verificar que sea válida y luego enrutarla hacia el PSP del pagador. En el prototipo, este actor simula esta función de validación y enrutamiento, asegurando que la solicitud avance al siguiente paso.
  \item[\textbf{PSP Pagador.}]
  Es el PSP que atiende al pagador final. Recibe la solicitud de pago enviada por el PSP beneficiario, la valida y la comunica al pagador para que tome una decisión. En un sistema real, si el pagador acepta la solicitud, el PSP pagador también ejecutaría la transferencia de fondos, pero en este prorotipo, como se detalla más adelante, esta parte no está incluida. Aquí, el PSp pagador simula la entrega de la solicitud y la recepción de la respuesta del pagador.
  \item[\textbf{Pagador.}]
  Es el cliente bancario o usuario final que recibe la solicitud de pago y decide si la acepta o la rechaza. En la vida real, esto podría ser una persona que recibe una notificación en su banca en línea o aplicación móvil, donde se le pide autorizar un pago. En el prototipo, el pagador es simulado para cerrar el ciclo de la solicitud, tomando la decisión final de aceptación o rechazo.
\end{description}

Estas interacciones entre los actores de ilustran en la figura \ref{fig:4corner}.

\paragraph{Alcance de la emulación.}  

El prototipo tiene como objetivo simular el flujo del esquema SRTP en un entorno controlado, pero con un alcance limitado para enfocarse en los aspectos esenciales del proceso de solicitud de pago. Esto significa que no replica todas las funcionalidades de un sistema RTP real, sino que prioriza ciertas partes para cumplir con los objetivos del proyecto. A continuación, se explica qué incluye la emulación, qué se deja fuera y las razones detrás de estas decisiones.

\begin{description}
  %\item[\textbf{Entorno de despliegue.}]
  %El prototipo opera en una red local utilizando \textit{Docker Compose}, una herramienta que permite gestionar varios contenedores Docker. En este caso, se crean cuatro contenedores, uno por cada actor, ejecutados sobre un sistema operativo Linux como host. Este enfoque simula un entorno distribuido donde cada actor opera de manera independiente, reflejando como funcionaría el esquema RTP en la realidad, pero dentro de un entorno aislado y fácil de configurar. Usar Docker Compose facilita la portabilidad y la reproducibilidad del prototipo, lo que es ideal para pruebas y demostraciones.
  \item[\textbf{Registro en la OSM.}]
  En un sistema RTP real, los actores deben estar registrados y autenticados a través de la OSM, una entidad central que asegura que todas las partes sean legítimas y cumplan con las reglas del esquema. Sin embargo, en este prototipo, no se aplica el registro en la OSM. En lugar de implementar este proceso, se asume que los actores ya están registrados y autenticados de antemano. Esta simplificación elimina la necesidad de desarrollar una lógica compleja de registro y autenticación, lo que reduce el esfuerzo de desarrollo y permite centrarse en el flujo de la solicitud de pago. Sin embargo, esto implica que el prototipo no abroda aspectos de seguridad relacionados con la verificación de identidad de los actores, una limitación aceptable para los fines de esta simulación.
  \item[\textbf{Materialización de la orden de pago SCT Inst.}]
  En un sistema RTP completo, cuando el pagador acepta la solicitud del pago, se genera una orden de pago mediante SEPA Inst, un esquema que permite transferenciuas de fondos instantáneas entre cuentas bancarias en la zona SEPA. En este prototipo, no se materializa la órden de pago SCT Inst después de que la solicitud es aceptada. Esto significa que el sistema simula todo el proceso hasta la aceptación o rechazo de la solicitud, pero no ejecuta la transferencia de dinero real. Esta decisión se basa en las limitaciones discutidas en el SRTP Scheme Rulebook \cite{epc014}, y se justifica porque el objetivo principal del prototipo es demostrar la interacción entre los actores y la lógica de la solicitud de pago, no integrar un sistema de pagos real. Incluir la ejecución de SCT Inst requeriría conectar el prototipo a servicios bancarios o simular un sistema financiero completo, lo que añadiría una complejidad innecesaria a este proyecto.
\end{description}

En resumen, la emulación sigue el modelo de cuatro esquinas de la EPC, con cuatro actores claramente definidos que interactúan en una red local. El prototipo se centra en simular la solicitud de pago y las respuestas entre los actores, omitiendo deliberadamente el registro en la OSM y la materialización de la orden de pago SCT Inst para mantener el enfoque en los aspectos clave del RTP, alineándose con los objetivos del proyecto y las limitaciones establecidas.
\section{Requisitos}
\label{subsec:diseno_requisitos}

\subsection{Requisitos funcionales (RF)}
Los requisitos funcionales detallan las operaciones específicas que el sistema debe realizar para emular el esquema SRTP. Estos requisitos aseguran que el prototipo implementado cubra el flujo completo de una solicitud de pago, desde su creación hasta la decisión final, incluyendo las interacciones entre los actores del modelo de cuatro esquinas.

\begin{longtable}{@{}>{\raggedright\arraybackslash}p{0.11\textwidth}p{0.8\textwidth}@{}}
\toprule
\textbf{Id.} & \textbf{Descripción} \\
\midrule\endhead
RF-01 & El Beneficiario debe poder crear una solicitud RTP indicando el IBAN del pagador, el importe en una moneda compatible con ISO 4217 (por ejemplo, euros) y un concepto descriptivo en formato UTF-8. La solicitud debe ser enviada al PSP Beneficiario para su procesamiento. \\
RF-02 & El PSP Beneficiario debe validar la sintaxis y el formato de la solicitud RTP recibida, asegurando que cumpla con los estándares del esquema (por ejemplo, IBAN válido, importe correcto). Una vez validada, debe enrutar la solicitud al PSP pagador correspondiente. \\
RF-03 & El PSP pagador debe aplicar reglas básicas de \textsc{KYC} (\emph{Know Your Customer}) y \textsc{AML} (\emph{Anti-Money Laundering}), como verificar que el pagador esté registrado y tenga capacidad para responder a la solicitud. Tras la validación, debe presentar la solicitud al pagador para que tome una decisión. \\
RF-04 & El pagador debe poder aprobar o rechazar la solicitud RTP con un tiempo máximo, simulando la inmediatez del esquema RTP. La decisión debe ser comunicada de vuelta al PSP pagador. \\
RF-05 & El Beneficiario debe recibir una notificación inmediata sobre la decisión del pagador (aceptación o rechazo) a través del sistema de notificaciones en tiempo real. \\
RF-06 & Cualquier parte involucrada debe poder emitir una solicitud de cancelación (\emph{cancellation request}) antes de que se tome la decisión final sobre la solicitud RTP. \\
\bottomrule
\caption{Requisitos funcionales}
\label{tab:RF}
\end{longtable}

\subsection{Requisitos no funcionales (RNF)}
Los requisitos no funcionales especifican las cualidades y restricciones del sistema que garantizan su rendimiento, seguridad y mantenibilidad. Estos requisitos aseguran que el prototipo sea eficiente y adecuado para simular un sistema de pagos en tiempo real, incluso en un entorno controlado.

\begin{longtable}{@{}>{\raggedright\arraybackslash}p{0.11\textwidth}p{0.8\textwidth}@{}}
\toprule
\textbf{Id.} & \textbf{Descripción} \\
\midrule\endhead
RNF-01 & El sistema debe incluir documentación detallada sobre su arquitectura, componentes y cómo desplegarlo, para facilitar su comprensión y mantenimiento. \\
RNF-02 & Toda la comunicación entre los actores debe estar cifrada. Además, cada transición de estado de la solicitud RTP debe registrarse con una huella digital SHA-256 para garantizar la integridad y trazabilidad. \\
RNF-03 & El prototipo debe depender exclusivamente de tecnologías portables como Python 3.12 para el backend y SQLite para la persistencia de datos, asegurando su ejecución en cualquier entorno compatible. \\
\bottomrule
\caption{Requisitos no funcionales}
\label{tab:RNF}
\end{longtable}

Los requisitos enlazan con la implememtación \ref{sec:implementacion} y con pruebas de validación incluidas en el apartado~\ref{sec:validacion}. Además, cada transición de estado se acompaña de un identificador único para facilitar el seguimiento en los logs.

\section{Casos de uso}
\label{subsec:diseno_casos_uso}

Los casos de uso describen las interacciones clave entre los actores y el sistema para cumplir con los requisitos funcionales del esquema. A continuación, se presentan dos casos de uso: CU-01 para la creación de una solicitud RTP y CU-02 para la decisión sobre dicha solicitud.

\subsection{CU-01 Crear solicitud RTP}
Este caso de uso describe cómo el \textit{Beneficiario} inicia una solicitud de pago (\textit{Request To Pay}, RTP) y cómo esta es procesada por el \textit{PSP Beneficiario} para su enrutamiento al \textit{PSP pagador}.
\begin{description}
  \item[Actor primario] ~ \textit{Beneficiario}
  \item[Flujo principal] ~
    \begin{enumerate}
      \item El \textit{Beneficiario} envía una solicitud HTTP \texttt{POST /rtp} con los datos requeridos: IBAN del pagador, importe y concepto.
      \item El \textit{PSP Beneficiario} valida la sintaxis y el formato de la solicitud.
      \item Si es válida, el \textit{PSP Beneficiario} enruta la solicitud al \textit{PSP pagador}.
      \item El sistema responde con \texttt{RTP creado con exito} y un identificador único (\textit{RTP-ID}).
    \end{enumerate}
  \item[Escenarios alternativos] ~
    \begin{itemize}
      \item Si el IBAN es inválido, el sistema devuelve \texttt{RTP no creado con éxito (IBAN inválido)}.
      % \item Si el \textit{PSP pagador} no está disponible, se devuelve \texttt{RTP no creado con éxito (Pagador no encontrado)}.
    \end{itemize}
  \item[Requisitos cubiertos] ~
    \begin{itemize}
      \item \textbf{RF-01:} Creación de la solicitud RTP por el \textit{Beneficiario}.
      \item \textbf{RF-02:} Validación y enrutamiento por el \textit{PSP Beneficiario}.
    \end{itemize}
\end{description}

\subsection{CU-02: Decidir solicitud RTP}
Este caso de uso detalla cómo el \textit{pagador} recibe la solicitud RTP a través del \textit{PSP pagador}, toma una decisión (\textit{accept} o \textit{reject}), y cómo esta decisión se notifica a los demás actores.
\begin{description}
  \item[Actor primario] ~ \textit{pagador}
  \item[Flujo principal] ~
    \begin{enumerate}
      \item El \textit{PSP pagador} presenta la solicitud RTP al \textit{pagador}.
      \item El \textit{pagador} selecciona \textit{accept} o \textit{reject} dentro del tiempo límite.
      \item El \textit{PSP pagador} registra la decisión y notifica a los demás actores mediante eventos.
    \end{enumerate}
  \item[Escenarios alternativos] ~
    \begin{itemize}
      \item Si el \textit{pagador} no responde a tiempo, la solicitud se rechaza automáticamente.
    \end{itemize}
  \item[Requisitos cubiertos] ~
    \begin{itemize}
      \item \textbf{RF-03:} Presentación de la solicitud al \textit{pagador} por el \textit{PSP pagador}.
      \item \textbf{RF-04:} Decisión del \textit{pagador} en un tiempo máximo.
      \item \textbf{RF-05:} Notificación de la decisión al \textit{Beneficiario}.
    \end{itemize}
\end{description}

Los flujos completos se ilustran en los diagramas de secuencia (Fig.~\ref{fig:seq_cu01} y Fig.~\ref{fig:seq_cu02}).

\begin{figure}[htbp]
  \centering
  % placeholder
  \includegraphics[width=.9\textwidth]{Imagenes/CU01.pdf}
  \caption{Diagrama de secuencia para CU‑01 (crear solicitud RTP).}
  \label{fig:seq_cu01}
\end{figure}

\begin{figure}[htbp]
  \centering
  % placeholder
  \includegraphics[width=.9\textwidth]{Imagenes/CU02.pdf}
  \caption{Diagrama de secuencia para CU‑02 (decisión final RTP).}
  \label{fig:seq_cu02}
\end{figure}

\section{Modelo de datos}
\label{subsec:diseno_datos}

% Descripción del esquema de la base de datos y referencia a la figura del modelo ER
El esquema de la base de datos, representado en el modelo entidad-relación (ER) de la Figura~\ref{fig:er_model}, está diseñado para soportar el flujo del esquema SRTP. Consta de tres tablas principales: \texttt{Actor}, \texttt{RTP} y \texttt{Log}, cada una con atributos específicos para almacenar la información necesaria del sistema.

% Inclusión de la figura del modelo ER
\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio]{Imagenes/ER.pdf}
  \caption{Modelo entidad-relación del prototipo.}
  \label{fig:er_model}
\end{figure}

% Listado de las tablas y sus atributos
Las tablas que componen el modelo de datos son las siguientes:

\begin{itemize}
  \item \textbf{Actor} (\texttt{id}, \texttt{username}, \texttt{password}, \texttt{name}, \texttt{role}, \texttt{photo\_url}, \texttt{iban}, \texttt{balance}, \texttt{psp\_id}) --- Almacena información sobre los actores involucrados en el sistema, como beneficiarios, pagadores y proveedores de servicios de pago (PSP). Sus atributos son:
    \begin{itemize}
      \item \texttt{id}: Identificador único del actor (clave primaria).
      \item \texttt{username}: Nombre de usuario único para autenticación.
      \item \texttt{password}: Contraseña del actor.
      \item \texttt{name}: Nombre completo del actor.
      \item \texttt{role}: Rol del actor, que puede ser \emph{beneficiary}, \emph{psp\_beneficiary}, \emph{psp\_payer} o \emph{payer}.
      \item \texttt{photo\_url}: URL o base64 de la foto del actor (opcional).
      \item \texttt{iban}: Número de cuenta bancaria internacional (IBAN).
      \item \texttt{balance}: Saldo disponible del actor.
      \item \texttt{psp\_id}: Referencia al actor que actúa como PSP (clave foránea a \texttt{Actor}).
    \end{itemize}

  \item \textbf{RTP} (\texttt{id}, \texttt{iban}, \texttt{amount}, \texttt{status}, \texttt{timestamp}, \texttt{beneficiary\_id}, \texttt{psp\_beneficiary\_id}, \texttt{psp\_payer\_id}, \texttt{payer\_id}, \texttt{concept}) --- Registra las solicitudes de pago (\emph{Request To Pay}). Sus atributos son:
    \begin{itemize}
      \item \texttt{id}: Identificador único de la solicitud (clave primaria).
      \item \texttt{iban}: IBAN del pagador.
      \item \texttt{amount}: Monto de la solicitud de pago.
      \item \texttt{status}: Estado actual de la solicitud (e.g., "creado").
      \item \texttt{timestamp}: Fecha y hora de creación de la solicitud.
      \item \texttt{beneficiary\_id}: Referencia al actor beneficiario.
      \item \texttt{psp\_beneficiary\_id}: Referencia al PSP del beneficiario.
      \item \texttt{psp\_payer\_id}: Referencia al PSP del pagador.
      \item \texttt{payer\_id}: Referencia al actor pagador.
      \item \texttt{concept}: Descripción o motivo de la solicitud de pago.
    \end{itemize}

  \item \textbf{Log} (\texttt{id}, \texttt{rtp\_id}, \texttt{old\_status}, \texttt{new\_status}, \texttt{timestamp}, \texttt{hash\_value}) --- Almacena el historial de cambios de estado de las solicitudes RTP. Sus atributos son:
    \begin{itemize}
      \item \texttt{id}: Identificador único del registro (clave primaria).
      \item \texttt{rtp\_id}: Referencia a la solicitud RTP asociada.
      \item \texttt{old\_status}: Estado anterior de la solicitud.
      \item \texttt{new\_status}: Nuevo estado de la solicitud.
      \item \texttt{timestamp}: Marca de tiempo del cambio de estado.
      \item \texttt{hash\_value}: Hash para verificar la integridad del registro.
    \end{itemize}
\end{itemize}

% Explicación del mecanismo de hash y las relaciones entre tablas
El atributo \texttt{hash\_value} de la tabla \texttt{Log} se calcula utilizando el algoritmo SHA-256 sobre una concatenación de campos clave, como \texttt{rtp\_id}, \texttt{old\_status}, \texttt{new\_status} y \texttt{timestamp}. Este hash asegura la integridad de cada entrada, permitiendo detectar cualquier modificación no autorizada en el historial de estados.

Las relaciones entre las tablas están definidas mediante claves foráneas:
- En \texttt{RTP}, los campos \texttt{beneficiary\_id}, \texttt{psp\_beneficiary\_id}, \texttt{psp\_payer\_id} y \texttt{payer\_id} referencian a \texttt{Actor.id}.
- En \texttt{Log}, \texttt{rtp\_id} referencia a \texttt{RTP.id}.
- En \texttt{Actor}, \texttt{psp\_id} referencia a otro \texttt{Actor.id}, estableciendo una relación recursiva para indicar el PSP asociado.

Todas las claves foráneas están configuradas con \emph{\texttt{ON DELETE CASCADE}}, lo que significa que la eliminación de un registro en una tabla padre (como \texttt{Actor} o \texttt{RTP}) provocará la eliminación automática de los registros dependientes en las tablas hijas (como \texttt{RTP} o \texttt{Log}), facilitando las pruebas y el mantenimiento del prototipo.


\section{Arquitectura lógica}
\label{subsec:diseno_arquitectura}

La arquitectura lógica del prototipo, ilustrada en la Figura~\ref{fig:componentes}, organiza los componentes del sistema en capas para garantizar una separación clara de responsabilidades y facilitar la escalabilidad y el mantenimiento. El diseño se basa en un enfoque modular que permite simular el flujo del esquema SRTP en un entorno distribuido, utilizando tecnologías modernas como REST y WebSocket para la comunicación y SQLAlchemy para la persistencia.

% Inclusión de la figura de la arquitectura
\begin{figure}[htbp]
  \centering
  \includegraphics[width=.85\textwidth]{Imagenes/DiagComp.pdf}
  \caption{Arquitectura lógica y flujo de dependencias del prototipo.}
  \label{fig:componentes}
\end{figure}

% Descripción de los componentes principales
\subsection{Componentes principales}
\label{subsec:componentes_principales}
El sistema se estructura en tres componentes principales:
\begin{itemize}
  \item \textbf{Gateway REST}: Actúa como punto de entrada para las solicitudes HTTP, gestionando la validación inicial de las peticiones y enrutándolas al componente adecuado. Este componente asegura que las solicitudes cumplan con los formatos esperados antes de procesarlas.
  \item \textbf{Service RTP}: Encapsula la lógica de negocio del esquema SRTP, incluyendo la creación, validación, enrutamiento y decisión de solicitudes de pago. Interactúa con la base de datos para almacenar y recuperar información.
  \item \textbf{Notification Hub}: Mantiene canales WebSocket abiertos con los cuatro actores del modelo de cuatro esquinas (Beneficiary, PSP Beneficiary, PSP Payer y Payer), enviando notificaciones en tiempo real sobre eventos como la creación o decisión de una solicitud RTP.
\end{itemize}

%----------------------------------------------
% 3.6.2 – Flujo de interacción lógico
%----------------------------------------------
\subsection{Flujo de interacción lógico}
\label{subsec:flujo_interaccion}

El ciclo \textbf{SRTP} se articula en los cuatro pasos lógicos que se detallan a continuación:

\begin{enumerate}[label=\arabic*.]
  \item \textbf{Recepción} – El \emph{Gateway} recibe la petición
        \verb|POST /rtp| y la delega al \emph{Service RTP}.
  \item \textbf{Procesamiento} – El \emph{Service RTP} aplica la lógica de negocio
        y actualiza el estado
        \mbox{\texttt{created} $\rightarrow$ \texttt{validated} $\rightarrow$ \texttt{routed} …}.
  \item \textbf{Publicación} – Tras cada transición de estado válida,
        el servicio emite un evento de dominio.
  \item \textbf{Notificación} – El \emph{Notification Hub} reenvía dicho evento,
        vía WebSocket, a las salas correspondientes
        (\emph{psp\_beneficiary}, \emph{psp\_payer}, \emph{payer} o \emph{beneficiary}).
\end{enumerate}

Con este patrón se obtienen las siguientes ventajas:

\begin{itemize}
  \item Los \emph{clientes} no interrogan al servidor; reciben notificaciones \emph{push}.
  \item La \emph{consistencia} del estado queda centralizada en el \emph{Service RTP}.
  \item El sistema puede escalar horizontalmente añadiendo réplicas del servicio
        sin romper el contrato público.
\end{itemize}



\section{Emulación del flujo RTP}
\label{subsec:emulacion_flujo_rtp}

% Inclusión de la figura de la máquina de estados
\begin{figure}[htbp]
  \centering
  \includegraphics[width=.85\textwidth]{Imagenes/DiagEstado.pdf}
  \caption{Máquina de estados del objeto RTP.}
  \label{fig:state_machine_rtp}
\end{figure}

El objetivo de este apartado es describir cómo el prototipo recrea, de extremo a extremo, el ciclo de vida de una solicitud RTP dentro del bloque \textbf{Service RTP}, único responsable de aplicar la lógica de negocio y salvaguardar la coherencia del estado global. A diferencia de otros componentes, este servicio actúa como \emph{single source of truth}: valida, persiste, publica eventos de dominio y rechaza cualquier transición inválida.

\subsection{Máquina de estados del objeto RTP}
\label{subsec:rtp_state_machine}

La Figura~\ref{fig:state_machine_rtp} sintetiza el recorrido que puede seguir una solicitud:  
\textbf{Creado $\rightarrow$ Validado Beneficiario $\rightarrow$ Enrutado $\rightarrow$ Validado Payer $\rightarrow$ (Aceptado $|$ Rechazado $|$ Cancelado)}.  
Cada arista representa una operación expuesta por la API (por ejemplo, \texttt{create}, \texttt{validate\_beneficiary}, \texttt{route}, \texttt{validate\_payer}, \texttt{accept}, \texttt{reject}, \texttt{cancel}) y sólo puede ejecutarse si el objeto se encuentra en el estado de origen indicado.

\subsection{Transiciones y reglas de negocio}

\begin{description}
  \item[\textbf{Creación} (\texttt{create})]  
        El \emph{Beneficiary} emite un \texttt{POST /rtp}. \textbf{Service RTP} valida sintaxis y semántica (IBAN, ISO 4217, etc.), calcula un hash SHA-256 para evitar duplicados y persiste el registro como \textsc{CREADO}.
  \item[\textbf{Validación del PSP Beneficiary} (\texttt{validate\_beneficiary})]  
        El PSP del beneficiario comprueba el cumplimiento de las reglas SRTP (formato, AML/KYC básico). Si falla, genera un \texttt{reject} inmediato con motivo normalizado.
  \item[\textbf{Enrutado} (\texttt{route})]  
        Una vez validada, la solicitud se envía al PSP \emph{Payer}. El estado avanza a \textsc{ENRUTADO} y se incorpora un \texttt{timestamp} a la traza.
  \item[\textbf{Validación del PSP Payer} (\texttt{validate\_payer})]  
        El PSP del pagador confirma que el cliente puede recibir la solicitud. La aprobación conduce a \textsc{VALIDADO\_PAYER}; de lo contrario, devuelve \texttt{reject}.
  \item[\textbf{Decisión del Payer} (\texttt{accept} / \texttt{reject})]  
        El pagador dispone de un máximo de diez segundos para responder. La aceptación transita a \textsc{ACEPTADO}; la denegación, a \textsc{RECHAZADO}.
  \item[\textbf{Cancelación} (\texttt{cancel})]  
        Cualquiera de los cuatro actores puede solicitar la anulación antes de la decisión final, llevando el flujo a \textsc{CANCELADO}.
\end{description}

Todas las reglas están encapsuladas en métodos de dominio homogéneos en firma y manejo de errores, favoreciendo la mantenibilidad y la trazabilidad entre diseño y código.

\subsection{Condiciones excepcionales y \emph{timeouts}}

Si el pagador no responde antes de la \textbf{fecha/hora de expiración} definida en la solicitud, el sistema ejecuta una transición automática a \textsc{CANCELADO}. Del mismo modo, cualquier error técnico de un PSP desemboca en un \texttt{reject}, manteniendo la consistencia global sin intervención manual.
%
%\subsection{Resumen}
%
%El modelo de estados implementado consagra tres principios:
%
%\begin{enumerate}
%  \item \textbf{Centralización}: toda la lógica reside en \textbf{Service RTP}, evitando duplicidades y condiciones de carrera.
%  \item \textbf{Observabilidad}: cada evento se persiste, firma y publica, facilitando auditoría y \emph{monitoring}.
%  \item \textbf{Extensibilidad}: la adición de nuevos estados o transiciones (p.\,ej.\ \emph{refund}) sólo requiere ampliar la máquina y los servicios asociados, sin impactar capas externas.
%\end{enumerate}
%
%
%Con ello, la emulación demuestra que el ciclo SRTP puede implementarse de forma robusta y trazable aprovechando patrones de \emph{domain-driven design} y mensajería asíncrona, sentando las bases para una futura conexión con infraestructuras de pago reales.


# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/DIAGRAMAaER.svg:Zone.Identifier



# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/esq2.png

﻿<?xml version="1.0" encoding="utf-8"?><Error><Code>AuthenticationFailed</Code><Message>Server failed to authenticate the request. Make sure the value of Authorization header is formed correctly including the signature.
RequestId:129a59e7-a01e-0003-55c3-c85cc8000000
Time:2025-05-19T13:41:03.7386366Z</Message><AuthenticationErrorDetail>Signed expiry time [Mon, 19 May 2025 13:39:25 GMT] must be after signed start time [Mon, 19 May 2025 13:41:03 GMT]</AuthenticationErrorDetail></Error>

# END FILE CONTENTS


# File: backend/routes_actors.py

# routes_actors.py (podrías crear un nuevo archivo de rutas o incluirlo en routes.py)

from flask import Blueprint, request, jsonify
from models import db, Actor

actors_blueprint = Blueprint('actors', __name__)

@actors_blueprint.route('/actors', methods=['POST'])
def create_actor():
    data = request.get_json()
    name = data.get('name')
    role = data.get('role')  # 'beneficiary', 'psp_beneficiary', 'psp_payer', 'payer'

    if not name or not role:
        return jsonify({"error": "Faltan campos requeridos: name, role"}), 400

    # Validar que el role sea uno de los cuatro permitidos:
    valid_roles = ['beneficiary', 'psp_beneficiary', 'psp_payer', 'payer']
    if role not in valid_roles:
        return jsonify({"error": f"Rol '{role}' no válido"}), 400

    actor = Actor(name=name, role=role)
    db.session.add(actor)
    db.session.commit()

    return jsonify({"message": "Actor creado", "id": actor.id, "role": actor.role}), 201


# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/DiagEstado.svg

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="STATE" height="667px" preserveAspectRatio="none" style="width:1111px;height:667px;background:#FFFFFF;" version="1.1" viewBox="0 0 1111 667" width="1111px" zoomAndPan="magnify"><defs/><g><ellipse cx="715.15" cy="16" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1;"/><g id="Creado"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="70.1758" x="680.06" y="103"/><line style="stroke:#181818;stroke-width:0.5;" x1="680.06" x2="750.2358" y1="129.2969" y2="129.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.1758" x="690.06" y="120.9951">Creado</text></g><g id="Validado_Beneficiario"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="170.7529" x="436.77" y="230"/><line style="stroke:#181818;stroke-width:0.5;" x1="436.77" x2="607.5229" y1="256.2969" y2="256.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.7529" x="446.77" y="247.9951">Validado_Beneficiario</text></g><g id="Enrutado"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="83.8682" x="466.21" y="357"/><line style="stroke:#181818;stroke-width:0.5;" x1="466.21" x2="550.0782" y1="383.2969" y2="383.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.8682" x="476.21" y="374.9951">Enrutado</text></g><g id="Validado_Payer"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="127.5293" x="289.38" y="484"/><line style="stroke:#181818;stroke-width:0.5;" x1="289.38" x2="416.9093" y1="510.2969" y2="510.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107.5293" x="299.38" y="501.9951">Validado_Payer</text></g><g id="Aceptado"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="86.2949" x="7" y="611"/><line style="stroke:#181818;stroke-width:0.5;" x1="7" x2="93.2949" y1="637.2969" y2="637.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.2949" x="17" y="628.9951">Aceptado</text></g><g id="Rechazado"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="96.8701" x="346.71" y="611"/><line style="stroke:#181818;stroke-width:0.5;" x1="346.71" x2="443.5801" y1="637.2969" y2="637.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.8701" x="356.71" y="628.9951">Rechazado</text></g><g id="Cancelado"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="93.459" x="759.42" y="611"/><line style="stroke:#181818;stroke-width:0.5;" x1="759.42" x2="852.879" y1="637.2969" y2="637.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.459" x="769.42" y="628.9951">Cancelado</text></g><g class="entity" data-entity="GMN2" data-source-line="15" data-uid="ent0003" id="entity_GMN2"><path d="M785.22,115.43 L785.22,124 L750.55,128 L785.22,132 L785.22,140.5628 A0,0 0 0 0 785.22,140.5628 L1039.0711,140.5628 A0,0 0 0 0 1039.0711,140.5628 L1039.0711,125.43 L1029.0711,115.43 L785.22,115.43 A0,0 0 0 0 785.22,115.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M1029.0711,115.43 L1029.0711,125.43 L1039.0711,125.43 L1029.0711,115.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.8511" x="791.22" y="132.4969">Solicitud iniciada por el Beneficiario</text></g><g class="entity" data-entity="GMN5" data-source-line="18" data-uid="ent0006" id="entity_GMN5"><path d="M642.96,242.43 L642.96,251 L607.72,255 L642.96,259 L642.96,267.5628 A0,0 0 0 0 642.96,267.5628 L855.3355,267.5628 A0,0 0 0 0 855.3355,267.5628 L855.3355,252.43 L845.3355,242.43 L642.96,242.43 A0,0 0 0 0 642.96,242.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M845.3355,242.43 L845.3355,252.43 L855.3355,252.43 L845.3355,242.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.3755" x="648.96" y="259.4969">Validada por PSP Beneficiario</text></g><g class="entity" data-entity="GMN8" data-source-line="21" data-uid="ent0009" id="entity_GMN8"><path d="M585.25,369.43 L585.25,378 L550.48,382 L585.25,386 L585.25,394.5628 A0,0 0 0 0 585.25,394.5628 L767.0488,394.5628 A0,0 0 0 0 767.0488,394.5628 L767.0488,379.43 L757.0488,369.43 L585.25,369.43 A0,0 0 0 0 585.25,369.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M757.0488,369.43 L757.0488,379.43 L767.0488,379.43 L757.0488,369.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.7988" x="591.25" y="386.4969">Enrutada al PSP Pagador</text></g><g class="entity" data-entity="GMN11" data-source-line="24" data-uid="ent0012" id="entity_GMN11"><path d="M451.66,496.43 L451.66,505 L417.23,509 L451.66,513 L451.66,521.5628 A0,0 0 0 0 451.66,521.5628 L640.6317,521.5628 A0,0 0 0 0 640.6317,521.5628 L640.6317,506.43 L630.6317,496.43 L451.66,496.43 A0,0 0 0 0 451.66,496.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M630.6317,496.43 L630.6317,506.43 L640.6317,506.43 L630.6317,496.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.9717" x="457.66" y="513.4969">Validada por PSP Pagador</text></g><g class="entity" data-entity="GMN14" data-source-line="27" data-uid="ent0015" id="entity_GMN14"><path d="M128.64,623.43 L128.64,632 L93.64,636 L128.64,640 L128.64,648.5628 A0,0 0 0 0 128.64,648.5628 L311.6512,648.5628 A0,0 0 0 0 311.6512,648.5628 L311.6512,633.43 L301.6512,623.43 L128.64,623.43 A0,0 0 0 0 128.64,623.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M301.6512,623.43 L301.6512,633.43 L311.6512,633.43 L301.6512,623.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.0112" x="134.64" y="640.4969">Aprobada por el Pagador</text></g><g class="entity" data-entity="GMN17" data-source-line="30" data-uid="ent0018" id="entity_GMN17"><path d="M478.39,623.43 L478.39,632 L443.74,636 L478.39,640 L478.39,648.5628 A0,0 0 0 0 478.39,648.5628 L669.9134,648.5628 A0,0 0 0 0 669.9134,648.5628 L669.9134,633.43 L659.9134,623.43 L478.39,623.43 A0,0 0 0 0 478.39,623.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M659.9134,623.43 L659.9134,633.43 L669.9134,633.43 L659.9134,623.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.5234" x="484.39" y="640.4969">Rechazada por el Pagador</text></g><g class="entity" data-entity="GMN20" data-source-line="33" data-uid="ent0021" id="entity_GMN20"><path d="M887.6,623.43 L887.6,632 L853.28,636 L887.6,640 L887.6,648.5628 A0,0 0 0 0 887.6,648.5628 L1104.6918,648.5628 A0,0 0 0 0 1104.6918,648.5628 L1104.6918,633.43 L1094.6918,623.43 L887.6,623.43 A0,0 0 0 0 887.6,623.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M1094.6918,623.43 L1094.6918,633.43 L1104.6918,633.43 L1094.6918,623.43" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.0918" x="893.6" y="640.4969">Cancelada por cualquier actor</text></g><!--link *start* to Creado--><g class="link" data-entity-1=".start." data-entity-2="Creado" data-source-line="3" data-uid="lnk4" id="link_.start._Creado"><path d="M715.15,26.38 C715.15,43.11 715.15,72.59 715.15,96.63" fill="none" id="*start*-to-Creado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="715.15,102.63,719.15,93.63,715.15,97.63,711.15,93.63,715.15,102.63" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.8013" x="716.15" y="69.0669">crear</text></g><!--link Creado to Validado_Beneficiario--><g class="link" data-entity-1="Creado" data-entity-2="Validado_Beneficiario" data-source-line="4" data-uid="lnk6" id="link_Creado_Validado_Beneficiario"><path d="M679.75,151.93 C645.8,173.92 599.736,203.7483 564.996,226.2483" fill="none" id="Creado-to-Validado_Beneficiario" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="559.96,229.51,569.6885,227.9748,564.1567,226.7919,565.3396,221.2601,559.96,229.51" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.1362" x="632.15" y="196.0669">validate_beneficiary</text></g><!--link Validado_Beneficiario to Enrutado--><g class="link" data-entity-1="Validado_Beneficiario" data-entity-2="Enrutado" data-source-line="5" data-uid="lnk8" id="link_Validado_Beneficiario_Enrutado"><path d="M519.41,280.4 C516.95,302.42 514.0094,328.6975 511.5394,350.6975" fill="none" id="Validado_Beneficiario-to-Enrutado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="510.87,356.66,515.8492,348.1625,511.4279,351.6912,507.8991,347.2699,510.87,356.66" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.2295" x="517.15" y="323.0669">enrutar</text></g><!--link Enrutado to Validado_Payer--><g class="link" data-entity-1="Enrutado" data-entity-2="Validado_Payer" data-source-line="6" data-uid="lnk10" id="link_Enrutado_Validado_Payer"><path d="M477.89,407.4 C450.58,429.42 415.2812,457.8943 387.9912,479.8943" fill="none" id="Enrutado-to-Validado_Payer" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="383.32,483.66,392.8372,481.1256,387.2126,480.5219,387.8163,474.8974,383.32,483.66" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.0615" x="441.15" y="450.0669">validado_payer</text></g><!--link Validado_Payer to Aceptado--><g class="link" data-entity-1="Validado_Payer" data-entity-2="Aceptado" data-source-line="7" data-uid="lnk12" id="link_Validado_Payer_Aceptado"><path d="M294.01,534.4 C235.11,558.7 151.6365,593.1316 99.0165,614.8416" fill="none" id="Validado_Payer-to-Aceptado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="93.47,617.13,103.3153,617.3951,98.0921,615.223,100.2641,609.9998,93.47,617.13" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.772" x="221.15" y="577.0669">aceptar</text></g><!--link Validado_Payer to Rechazado--><g class="link" data-entity-1="Validado_Payer" data-entity-2="Rechazado" data-source-line="8" data-uid="lnk14" id="link_Validado_Payer_Rechazado"><path d="M361.35,534.4 C368.75,556.42 377.6695,582.9723 385.0595,604.9723" fill="none" id="Validado_Payer-to-Rechazado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="386.97,610.66,387.896,600.8548,385.3779,605.9203,380.3124,603.4022,386.97,610.66" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56.8306" x="378.15" y="577.0669">rechazar</text></g><!--link Creado to Cancelado--><g class="link" data-entity-1="Creado" data-entity-2="Cancelado" data-source-line="9" data-uid="lnk16" id="link_Creado_Cancelado"><path d="M750.55,147.76 C806.26,177.86 908.15,235.44 908.15,254 C908.15,254 908.15,254 908.15,510 C908.15,552.29 877.4207,584.5281 848.3107,606.8581" fill="none" id="Creado-to-Cancelado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="843.55,610.51,853.1256,608.206,847.5172,607.4668,848.2564,601.8584,843.55,610.51" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.4214" x="909.15" y="386.5669">cancelar</text></g><!--link Validado_Beneficiario to Cancelado--><g class="link" data-entity-1="Validado_Beneficiario" data-entity-2="Cancelado" data-source-line="10" data-uid="lnk17" id="link_Validado_Beneficiario_Cancelado"><path d="M607.79,278.34 C675.52,297.86 762.21,327.6 784.15,357 C841.61,434.03 824.4482,552.8834 813.2682,605.0134" fill="none" id="Validado_Beneficiario-to-Cancelado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="812.01,610.88,817.8083,602.9189,813.0585,605.9912,809.9862,601.2413,812.01,610.88" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.4214" x="822.15" y="450.0669">cancelar</text></g><!--link Enrutado to Cancelado--><g class="link" data-entity-1="Enrutado" data-entity-2="Cancelado" data-source-line="11" data-uid="lnk18" id="link_Enrutado_Cancelado"><path d="M549.2,407.48 C580.28,426.74 623.4,455.08 658.15,484 C707.1,524.74 753.7067,575.1141 781.2267,606.2541" fill="none" id="Enrutado-to-Cancelado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="785.2,610.75,782.2374,601.3573,781.8889,607.0034,776.2428,606.655,785.2,610.75" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.4214" x="712.15" y="513.5669">cancelar</text></g><!--link Validado_Payer to Cancelado--><g class="link" data-entity-1="Validado_Payer" data-entity-2="Cancelado" data-source-line="12" data-uid="lnk19" id="link_Validado_Payer_Cancelado"><path d="M417.22,529.13 C422.94,530.79 428.64,532.44 434.15,534 C550.67,567.08 682.5799,602.334 753.2699,621.054" fill="none" id="Validado_Payer-to-Cancelado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="759.07,622.59,751.3939,616.4193,754.2366,621.31,749.3459,624.1528,759.07,622.59" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.4214" x="599.15" y="577.0669">cancelar</text></g><!--SRC=[ZLB1QiCm3BtxAtGUz0Ts67Hbzx32BcCKrL4RCyVED6VGVVtasCcIOfhUdkNtdlGiVtyQro5Z2wrtNZViMuB0FIdr_l01cyqJx9Ymzl08MW2hV8mtRsXDBOV3Cpaw6MsGJIJ-3FL0X-DKlwWoETgyEEv3Qa43P3ML5cqgl11F_bBeOa5TtKV9LbENBN60HTOhwGP_4uqJNkJReTDaS_Y4-KQE8dsHvBRX_s15dd8-4B0vDm7yAQz50UozbIb2NuDnSPmQeVCCP64-eI9NGtIuiYd64TTSJrxLlhhBR0mh-WmHq0xo2izomQjZ38zGwhzYC6vSfDkE_N7s32lAwHU8TCJtQgT5YNR4IQjxj5-zaOMY3ZE3Fm00]--></g></svg>

# END FILE CONTENTS


# File: .gptree_config

# GPTree Local Config
version: 2

# Whether to use .gitignore
useGitIgnore: true
# File types to include (e.g., .py,.js)
includeFileTypes: *
# File types to exclude when includeFileTypes is '*'
excludeFileTypes: 
# Output file name
outputFile: gptree_output.txt
# Whether to output the file locally or relative to the project directory
outputFileLocally: true
# Whether to copy the output to the clipboard
copyToClipboard: false
# Whether to use safe mode (prevent overly large files from being combined)
safeMode: true
# Whether to store the files chosen in the config file (--save, -s)
storeFilesChosen: true
# Whether to include line numbers in the output (--line-numbers, -n)
lineNumbers: false
# Whether to show ignored files in the directory tree
showIgnoredInTree: false
# Whether to show only default ignored files in the directory tree while still respecting gitignore
showDefaultIgnoredInTree: false
# Previously selected files (when using the -s or --save flag previously)
previousFiles: 


# END FILE CONTENTS


# File: frontend/RTP.js

// RTP.js

// Espera a que el DOM esté cargado y luego carga el contenido de RTP.html en el div "seccionRTP"
document.addEventListener("DOMContentLoaded", function() {
    fetch('RTP.html')
      .then(response => response.text())
      .then(html => {
        document.getElementById('seccionRTP').innerHTML = html;
        attachRTPEventListeners();
        if (!document.getElementById('seccionRTP').classList.contains('invisible-section')) {
          mostrarPanelRTPporRol();
        }
      })
      .catch(err => console.error('Error al cargar RTP.html:', err));
});

// Array para todas las notificaciones recibidas
let notificationsList = [];

// Función para ajustar la visibilidad de los paneles según el rol del usuario
function mostrarPanelRTPporRol() {
  const allRTPpanels = ['beneficiaryActions', 'pspBeneficiaryActions', 'pspPayerActions', 'payerActions'];
  allRTPpanels.forEach(p => {
    let elem = document.getElementById(p);
    if (elem) {
      elem.classList.add('invisible-section');
    }
  });
  
  if (currentActorRole === 'beneficiary') {
    document.getElementById('beneficiaryActions').classList.remove('invisible-section');
  } else if (currentActorRole === 'psp_beneficiary') {
    document.getElementById('pspBeneficiaryActions').classList.remove('invisible-section');
  } else if (currentActorRole === 'psp_payer') {
    document.getElementById('pspPayerActions').classList.remove('invisible-section');
  } else if (currentActorRole === 'payer') {
    document.getElementById('payerActions').classList.remove('invisible-section');
  }
}

// Registra todos los event listeners para los formularios y botones de la sección RTP
function attachRTPEventListeners() {
  // Beneficiary: Crear RTP
  const createRTPForm = document.getElementById('createRTPForm');
  if (createRTPForm) {
    createRTPForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const iban = document.getElementById('ibanField').value;
      const amount = parseFloat(document.getElementById('amountField').value);
  
      const data = {
        actor_id: currentActorId,
        payer_iban: iban,
        amount: amount
      };
  
      fetch('http://127.0.0.1:5000/rtp', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(r => r.json())
      .then(result => {
        const respDiv = document.getElementById('createRTPResponse');
        respDiv.classList.remove('invisible-section');
        respDiv.innerText = JSON.stringify(result, null, 2);
      })
      .catch(err => console.error(err));
    });
  }
  
  // PSP Beneficiary: Validar RTP
  const validateBeneficiaryForm = document.getElementById('validateBeneficiaryForm');
  if (validateBeneficiaryForm) {
    validateBeneficiaryForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const rtpId = document.getElementById('rtpIdValidateBene').value;
      const data = { actor_id: currentActorId };
  
      fetch(`http://127.0.0.1:5000/rtp/${rtpId}/validate-beneficiary`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(r => r.json())
      .then(result => {
        const respDiv = document.getElementById('validateBeneficiaryResponse');
        respDiv.classList.remove('invisible-section');
        respDiv.innerText = JSON.stringify(result, null, 2);
      })
      .catch(err => console.error(err));
    });
  }
  
  // PSP Beneficiary: Enrutar RTP
  const routeForm = document.getElementById('routeForm');
  if (routeForm) {
    routeForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const rtpId = document.getElementById('rtpIdRoute').value;
      const data = { actor_id: currentActorId };
  
      fetch(`http://127.0.0.1:5000/rtp/${rtpId}/route`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(r => r.json())
      .then(result => {
        const respDiv = document.getElementById('routeResponse');
        respDiv.classList.remove('invisible-section');
        respDiv.innerText = JSON.stringify(result, null, 2);
      })
      .catch(err => console.error(err));
    });
  }
  
  // PSP Payer: Validar RTP
  const validatePayerForm = document.getElementById('validatePayerForm');
  if (validatePayerForm) {
    validatePayerForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const rtpId = document.getElementById('rtpIdValidatePayer').value;
      const data = { actor_id: currentActorId };
  
      fetch(`http://127.0.0.1:5000/rtp/${rtpId}/validate-payer`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(r => r.json())
      .then(result => {
        const respDiv = document.getElementById('validatePayerResponse');
        respDiv.classList.remove('invisible-section');
        respDiv.innerText = JSON.stringify(result, null, 2);
      })
      .catch(err => console.error(err));
    });
  }
  
  // Payer: Decidir RTP
  const decisionForm = document.getElementById('decisionForm');
  if (decisionForm) {
    decisionForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const rtpId = document.getElementById('rtpIdDecision').value;
      const decisionValue = document.getElementById('decision').value;
      const data = {
        actor_id: currentActorId,
        decision: decisionValue
      };
  
      fetch(`http://127.0.0.1:5000/rtp/${rtpId}/decision`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(r => r.json())
      .then(result => {
        const respDiv = document.getElementById('decisionResponse');
        respDiv.classList.remove('invisible-section');
        respDiv.innerText = JSON.stringify(result, null, 2);
      })
      .catch(err => console.error(err));
    });
  }
  
  // Mostrar Logs
  const showLogsBtn = document.getElementById('showLogs');
  if (showLogsBtn) {
    showLogsBtn.addEventListener('click', () => {
      fetch('http://127.0.0.1:5000/logs')
      .then(r => r.json())
      .then(logs => {
        let html = `<ul class="list-group">`;
        logs.forEach(l => {
          html += `<li class="list-group-item">
            <strong>RTP ${l.rtp_id}:</strong> ${l.old_status} ⇒ ${l.new_status}
            <small> (${l.timestamp})</small>
          </li>`;
        });
        html += `</ul>`;
        document.getElementById('logsResponse').innerHTML = html;
      })
      .catch(err => console.error(err));
    });
  }
  
  // -- LISTENERS de SOCKET.IO: quitamos setTimeout y almacenamos en notificationsList --

  // Añade notificación a la lista y vuelve a renderizar la tabla
  function addNotificationToList(rtpData) {
    // rtpData => {id, amount, status, ...}
    notificationsList.push(rtpData);
    renderNotificationsTable();
  }

  // Renderiza la tabla con las notificaciones
  function renderNotificationsTable() {
    const tableBody = document.querySelector('#notificationsTable tbody');
    tableBody.innerHTML = ''; // Limpia
    notificationsList.forEach((rtp) => {
      const row = document.createElement('tr');

      // ID
      const tdId = document.createElement('td');
      tdId.textContent = rtp.id;
      row.appendChild(tdId);

      // Monto
      const tdMonto = document.createElement('td');
      tdMonto.textContent = rtp.amount;
      row.appendChild(tdMonto);

      // Status
      const tdStatus = document.createElement('td');
      tdStatus.textContent = rtp.status;
      row.appendChild(tdStatus);

      // Acciones (botón)
      const tdAction = document.createElement('td');
      // Dependiendo del rol, la acción varía:
      if (currentActorRole === 'psp_beneficiary') {
        // p.ej. un botón "Validar" o "Enrutar" si procede
        // Comprobaremos su status para ver qué acción es adecuada
        if (rtp.status === 'creado') {
          let btnVal = document.createElement('button');
          btnVal.className = 'btn btn-sm btn-warning me-2';
          btnVal.textContent = 'Validar';
          btnVal.onclick = () => doValidateBeneficiary(rtp.id);
          tdAction.appendChild(btnVal);
        }
        if (rtp.status === 'creado' || rtp.status === 'validado-beneficiario') {
          let btnRoute = document.createElement('button');
          btnRoute.className = 'btn btn-sm btn-warning';
          btnRoute.textContent = 'Enrutar';
          btnRoute.onclick = () => doRoute(rtp.id);
          tdAction.appendChild(btnRoute);
        }
      }
      else if (currentActorRole === 'psp_payer') {
        if (rtp.status === 'enrutado') {
          let btnVal2 = document.createElement('button');
          btnVal2.className = 'btn btn-sm btn-info';
          btnVal2.textContent = 'Validar';
          btnVal2.onclick = () => doValidatePayer(rtp.id);
          tdAction.appendChild(btnVal2);
        }
      }
      else if (currentActorRole === 'payer') {
        // Muestra un botón para 'decidir' si la status es 'validado_payer'
        if (rtp.status === 'validado_payer') {
          let btnDecisionA = document.createElement('button');
          btnDecisionA.className = 'btn btn-sm btn-success me-2';
          btnDecisionA.textContent = 'Aceptar';
          btnDecisionA.onclick = () => doDecision(rtp.id, 'aceptado');
          tdAction.appendChild(btnDecisionA);

          let btnDecisionR = document.createElement('button');
          btnDecisionR.className = 'btn btn-sm btn-danger';
          btnDecisionR.textContent = 'Rechazar';
          btnDecisionR.onclick = () => doDecision(rtp.id, 'rechazado');
          tdAction.appendChild(btnDecisionR);
        }
      }
      else if (currentActorRole === 'beneficiary') {
        // Podríamos mostrar info, en principio no hay acción
      }

      row.appendChild(tdAction);
      tableBody.appendChild(row);
    });
  }

  // Funciones que ejecutan las acciones sin necesidad de un formulario manual
  function doValidateBeneficiary(rtpId) {
    const data = { actor_id: currentActorId };
    fetch(`http://127.0.0.1:5000/rtp/${rtpId}/validate-beneficiary`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    })
    .then(r=>r.json())
    .then(resp=>{
      console.log('ValidarBenefic resp:', resp);
    })
    .catch(err=>console.error(err));
  }
  function doRoute(rtpId) {
    const data = { actor_id: currentActorId };
    fetch(`http://127.0.0.1:5000/rtp/${rtpId}/route`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    })
    .then(r=>r.json())
    .then(resp=>{
      console.log('Route resp:', resp);
    })
    .catch(err=>console.error(err));
  }
  function doValidatePayer(rtpId) {
    const data = { actor_id: currentActorId };
    fetch(`http://127.0.0.1:5000/rtp/${rtpId}/validate-payer`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    })
    .then(r=>r.json())
    .then(resp=>{
      console.log('ValidatePayer resp:', resp);
    })
    .catch(err=>console.error(err));
  }
  function doDecision(rtpId, decisionValue) {
    const data = {
      actor_id: currentActorId,
      decision: decisionValue
    };
    fetch(`http://127.0.0.1:5000/rtp/${rtpId}/decision`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    })
    .then(r=>r.json())
    .then(resp=>{
      console.log('Decision resp:', resp);
    })
    .catch(err=>console.error(err));
  }

  // --- Socket listeners: en vez de notificación temporal, almacenamos en la lista ---

  // Para psp_beneficiary cuando se crea un RTP
  socket.on('rtp_created', function(data) {
    if (currentActorRole === 'psp_beneficiary') {
      addNotificationToList(data);
    }
  });

  // Para psp_payer cuando se enruta el RTP
  socket.on('rtp_routed', function(data) {
    if (currentActorRole === 'psp_payer') {
      addNotificationToList(data);
    }
  });

  // Para payer cuando el PSP payer valida
  socket.on('rtp_validated_payer', function(data) {
    if (currentActorRole === 'payer') {
      addNotificationToList(data);
    }
  });

  // Para beneficiary cuando el pagador decide
  socket.on('rtp_decision', function(data) {
    if (currentActorRole === 'beneficiary') {
      addNotificationToList(data);
    }
  });
}


# END FILE CONTENTS


# File: MemoriaTFG/src/agradecimientos.tex

\phantomsection
\addcontentsline{toc}{section}{Agradecimientos}

\thispagestyle{empty}       % sin cabecera ni número de página

\vspace*{\fill}             % empuja el bloque hacia el centro vertical
\begin{center}
\chapter*{Agradecimientos}

Agradezco, en primer lugar, la orientación y el seguimiento de mi tutor,  
cuya experiencia ha sido decisiva para completar este trabajo.

Extiendo mi gratitud a mi familia por su respaldo constante y a mis amigos  
por el apoyo práctico y la paciencia mostrada durante el desarrollo del proyecto.

Su ayuda conjunta ha permitido que este trabajo llegue a buen término.
\end{center}
\vspace*{\fill}             % completa el centrado vertical


# END FILE CONTENTS


# File: backend/config.py

import os

basedir = os.path.abspath(os.path.dirname(__file__))

class Config:
    SQLALCHEMY_DATABASE_URI = 'sqlite:///' + os.path.join(basedir, 'rtp.db')
    SQLALCHEMY_TRACK_MODIFICATIONS = False


# END FILE CONTENTS


# File: MemoriaTFG/main.tex

\documentclass{book}
\usepackage{ragged2e}

\usepackage{graphicx} % Required for inserting images
\usepackage[spanish, english]{babel}
\usepackage[hidelinks]{hyperref}
%----------------------------------------
% BIBLATEX + BIBER
\usepackage[backend=biber,style=alphabetic,sorting=nyt,language=spanish]{biblatex}
\addbibresource{bibliografia.bib}
%----------------------------------------

\usepackage{makecell}
\usepackage[numbered,framed]{listings}
\usepackage{color} % red, green, blue, yellow, cyan, magenta, black, white
\usepackage{enumitem}
\usepackage{lmodern}
\usepackage{microtype} 
\usepackage{array}
\usepackage{float}
\usepackage{tabularx}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{footnote}          % <— nuevo
\usepackage{siunitx}
\usepackage{inputenc}
\usepackage{threeparttable}
\usepackage{tikz}       % Diagrama en capas (cubo)
\usepackage{footmisc}   % Mejor gestión de notas a pie de página (opcional)
\usepackage{adjustbox}
\definecolor{mylilas}{RGB}{170,55,241}
\definecolor{backcolour}{rgb}{0.92,0.95,0.95}

\usepackage[printonlyused]{acronym}

\usepackage{longtable}
\usepackage{geometry}
\usepackage{lipsum}

\usepackage{listings}
\usepackage{xcolor}
\lstdefinestyle{custom}{
    backgroundcolor=\color{black!5},           % Fondo más sutil (gris muy claro)
    basicstyle=\ttfamily\footnotesize,         % Fuente monoespaciada más pequeña y profesional
    keywordstyle=\color{blue!70!black},        % Palabras clave en azul oscuro
    stringstyle=\color{orange!80!black},       % Cadenas en naranja suave
    commentstyle=\color{gray!50},              % Comentarios en gris claro
    numberstyle=\tiny\color{gray!40},          % Números de línea discretos
    numbers=left,                              % Números a la izquierda
    numbersep=10pt,                            % Espaciado entre números y código
    breaklines=true,                           % Romper líneas largas
    breakatwhitespace=true,                    % Romper solo en espacios
    frame=tb,                                  % Marco solo arriba y abajo (más elegante)
    framesep=5pt,                              % Espaciado interno del marco
    captionpos=b,                              % Título debajo
    showstringspaces=false,                    % No mostrar espacios en cadenas
    tabsize=4,                                 % Tamaño de tabulación
    escapeinside={(*@}{@*)},                   % Permitir escapar a LaTeX dentro del código
    morekeywords={app, def, return, send, register_blueprint, SocketIO} % Palabras clave adicionales
}


\newcolumntype{L}[1]{%
  >{\setlength\parindent{1em}% sangría primera línea
    \raggedright\arraybackslash}%
  p{#1}%
}

\AtBeginDocument{\justifying}
\begin{document}

\frontmatter


% Configurando la numeración arábiga desde el inicio
\pagenumbering{arabic}

% Creando la portada
\begin{titlepage}
    \centering
    {\includegraphics[width=0.9\textwidth]{Imagenes/Universidad-de-Valladolid.png}}\par
    {\bfseries\Large Escuela Técnica Superior de Ingenieros de Telecomunicación\par}
    \vspace{0.5cm}
    {\bfseries\itshape\Large Trabajo de Fin de Grado \par}
    \vspace{0.5cm}
    {\scshape Grado en Ingeniería de Tecnologías de Telecomunicación \par}
    \vspace{0.5cm}
    {\bfseries\scshape\Large \textit{Request To Pay} frente a la domiciliación bancaria: propuesta de mejora e implementación de un prototipo \par}
    \vspace{1.5cm}
    { Autor: \\}
    { Alonso Sandoval Martínez }\\
    \vspace{0.5cm}
    { Tutor:\\}
    { Federico Simmross Wattenberg }\\
    \vspace{1.5cm} {Valladolid, junio 2025 \par}
\end{titlepage}

% Configurando el idioma
\selectlanguage{spanish}  

% Añadiendo los agradecimientos desde un archivo externo
\newpage
\input{src/agradecimientos.tex}

% Añadiendo el resumen en español
\newpage
\input{src/resumen.tex}

% Añadiendo el índice justo después de la portada
\newpage
\tableofcontents

\newpage
\phantomsection % Añade un destino para el hipervínculo
\chapter*{Lista de acrónimos}
\label{sec:Lista de acrónimos}
\addcontentsline{toc}{section}{Lista de acrónimos} % Añade al índice con el destino correcto
\begin{acronym}[SRTP]
\begin{enumerate}
  \item API – Application Programming Interface
  \item CDN – Content Delivery Network
  \item CSS3 – Cascading Style Sheets 3
  \item EBA – Euro Banking Association
  \item EDS – Electronic Data Submission
  \item EDS-Dir – EPC Directory Service
  \item EPC – European Payments Council
  \item ERPB – Euro Retail Payments Board
  \item ES6 – ECMAScript 6
  \item HTML5 – HyperText Markup Language 5
  \item HTTP – Hypertext Transfer Protocol
  \item IBAN – International Bank Account Number
  \item ISO20022 – International Organization for Standardization 20022
  \item JSON – JavaScript Object Notation
  \item NFC – Near Field Communication
  \item ORM – Object-Relational Mapping
  \item POS – Point of Sale
  \item PSD2 – Payment Services Directive 2
  \item PSP – Payment Service Provider
  \item QR – Quick Response
  \item RTP – Request-to-Pay
  \item SCA – Strong Customer Authentication
  \item SCT – SEPA Credit Transfer
  \item SCT Inst – SEPA Instant Credit Transfer
  \item SEPA – Single Euro Payments Area
  \item SDD – SEPA Direct Debit
  \item SRTP – SEPA Request-to-Pay
  \item TCP – Transmission Control Protocol
  \item TFG – Trabajo de Fin de Grado
  \item TIPS – TARGET Instant Payment Settlement
  \item TPV – Terminal Punto de Venta
  \item WSGI – Web Server Gateway Interface
\end{enumerate}
\end{acronym}

% Volviendo al español para el resto del documento
\selectlanguage{spanish} 

\mainmatter

% Comenzando el cuerpo principal (numeración ya es arábiga)
\newpage



\input{src/introduccion.tex}
\newpage



\input{src/estado_arte.tex}
\newpage


\input{src/diseño.tex}
\newpage



% 3. Diseño e Implementación
\input{src/implementacion.tex}
%\newpage
\newpage



\input{src/validacion.tex}
\newpage



\newpage
\input{src/conclusiones.tex}
\newpage
% Añadiendo los apéndices
\clearpage




\newpage

\backmatter

\input{src/codigos.tex}
% Añadiendo el índice de figuras
\newpage
\renewcommand{\listfigurename}{Índice de Figuras}
\listoffigures
\addcontentsline{toc}{section}{Índice de Figuras}

% Añadiendo el índice de tablas
\newpage
\renewcommand{\listtablename}{Índice de Tablas}
\listoftables
\addcontentsline{toc}{section}{Índice de Tablas}

% Añadiendo el índice de códigos
\newpage
\renewcommand*{\lstlistlistingname}{Índice de Listados}
\renewcommand*{\lstlistingname}{Código}
\lstlistoflistings
\addcontentsline{toc}{section}{Índice de Listados}

% Añadiendo las referencias
\clearpage
\nocite{*}
\printbibliography[title={Bibliografía}]


\end{document}

# END FILE CONTENTS


# File: frontend/RTP.html

<!-- RTP.html: Contenido de la sección Request to Pay -->
<div id="rtpContent">
    <h3>Request to Pay</h3>
    <p>Dependiendo del rol (beneficiary, psp_beneficiary, psp_payer, payer) verás acciones diferentes.</p>
    
    <!-- Beneficiary actions -->
    <div class="card mb-4 invisible-section" id="beneficiaryActions">
      <div class="card-header bg-success text-white">Beneficiary: Crear RTP</div>
      <div class="card-body">
        <!-- ÚNICAMENTE IBAN Y MONTO -->
        <form id="createRTPForm" class="row g-3 mb-3">
          <div class="col-md-6">
            <label for="ibanField" class="form-label">IBAN</label>
            <input type="text" id="ibanField" class="form-control" required>
          </div>
          <div class="col-md-6">
            <label for="amountField" class="form-label">Monto</label>
            <input type="number" step="0.01" id="amountField" class="form-control" required>
          </div>
          <div class="col-md-12 d-flex justify-content-end">
            <button type="submit" class="btn btn-success">Crear RTP</button>
          </div>
        </form>
        <div id="createRTPResponse" class="alert alert-secondary invisible-section"></div>
        <!-- Contenedor para notificaciones dirigidas al Beneficiary -->
        <div id="beneficiaryNotification" class="alert alert-info invisible-section mt-3"></div>
      </div>
    </div>
    
    <!-- PSP Beneficiary actions -->
    <div class="card mb-4 invisible-section" id="pspBeneficiaryActions">
      <div class="card-header bg-warning text-dark">PSP Beneficiary: Validar / Enrutar</div>
      <div class="card-body">
        <form id="validateBeneficiaryForm" class="row g-3 mb-3">
          <div class="col-md-3">
            <label for="rtpIdValidateBene" class="form-label">ID del RTP</label>
            <input type="number" id="rtpIdValidateBene" class="form-control" required>
          </div>
          <div class="col-md-3 d-flex align-items-end">
            <button type="submit" class="btn btn-warning text-white">Validar RTP</button>
          </div>
        </form>
        <div id="validateBeneficiaryResponse" class="alert alert-secondary invisible-section"></div>
        <form id="routeForm" class="row g-3">
          <div class="col-md-3">
            <label for="rtpIdRoute" class="form-label">ID del RTP</label>
            <input type="number" id="rtpIdRoute" class="form-control" required>
          </div>
          <div class="col-md-3 d-flex align-items-end">
            <button type="submit" class="btn btn-warning text-white">Enrutar RTP</button>
          </div>
        </form>
        <div id="routeResponse" class="alert alert-secondary invisible-section"></div>
        <!-- Contenedor para notificaciones de PSP Beneficiary (ya existía) -->
        <div id="rtpNotification" class="alert alert-info invisible-section mt-3"></div>
      </div>
    </div>
    
    <!-- PSP Payer actions -->
    <div class="card mb-4 invisible-section" id="pspPayerActions">
      <div class="card-header bg-info text-white">PSP Payer: Validar</div>
      <div class="card-body">
        <form id="validatePayerForm" class="row g-3">
          <div class="col-md-4">
            <label for="rtpIdValidatePayer" class="form-label">ID del RTP</label>
            <input type="number" id="rtpIdValidatePayer" class="form-control" required>
          </div>
          <div class="col-md-4 d-flex align-items-end">
            <button type="submit" class="btn btn-info text-white">Validar RTP</button>
          </div>
        </form>
        <div id="validatePayerResponse" class="alert alert-secondary invisible-section"></div>
        <!-- Contenedor para notificaciones de PSP Payer -->
        <div id="pspPayerNotification" class="alert alert-info invisible-section mt-3"></div>
      </div>
    </div>
    
    <!-- Payer actions -->
    <div class="card mb-4 invisible-section" id="payerActions">
      <div class="card-header bg-danger text-white">Payer: Decidir</div>
      <div class="card-body">
        <form id="decisionForm" class="row g-3">
          <div class="col-md-4">
            <label for="rtpIdDecision" class="form-label">ID del RTP</label>
            <input type="number" id="rtpIdDecision" class="form-control" required>
          </div>
          <div class="col-md-4">
            <label for="decision" class="form-label">Decisión</label>
            <select id="decision" class="form-select">
              <option value="aceptado">aceptado</option>
              <option value="rechazado">rechazado</option>
            </select>
          </div>
          <div class="col-md-4 d-flex align-items-end">
            <button type="submit" class="btn btn-danger">Enviar Decisión</button>
          </div>
        </form>
        <div id="decisionResponse" class="alert alert-secondary invisible-section"></div>
        <!-- Contenedor para notificaciones de Payer -->
        <div id="payerNotification" class="alert alert-info invisible-section mt-3"></div>
      </div>
    </div>
  
      <!-- Ahora ponemos primero NOTIFICACIONES RECIBIDAS -->
    <div class="card mb-4" id="notificationsCard">
      <div class="card-header bg-secondary text-white">
        Notificaciones Recibidas
      </div>
      <div class="card-body">
        <!-- Tabla donde listaremos todas las notificaciones -->
        <table class="table table-bordered" id="notificationsTable">
          <thead>
            <tr>
              <th>ID</th>
              <th>Monto</th>
              <th>Estado (status)</th>
              <th>Acción</th>
            </tr>
          </thead>
          <tbody>
            <!-- Se llenará dinámicamente con JavaScript (RTP.js) -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- Logs -->
    <div class="card mb-4">
      <div class="card-header bg-secondary text-white">Logs</div>
      <div class="card-body">
        <button id="showLogs" class="btn btn-secondary">Mostrar Logs</button>
        <div id="logsResponse" class="mt-3"></div>
      </div>
    </div>
</div>


# END FILE CONTENTS


# File: MemoriaTFG/main.aux

\relax 
\providecommand\hyper@newdestlabel[2]{}
\@nameuse{bbl@beforestart}
\catcode `"\active 
\catcode `<\active 
\catcode `>\active 
\@nameuse{es@quoting}
\providecommand\HyperFirstAtBeginDocument{\AtBeginDocument}
\HyperFirstAtBeginDocument{\ifx\hyper@anchor\@undefined
\global\let\oldcontentsline\contentsline
\gdef\contentsline#1#2#3#4{\oldcontentsline{#1}{#2}{#3}}
\global\let\oldnewlabel\newlabel
\gdef\newlabel#1#2{\newlabelxx{#1}#2}
\gdef\newlabelxx#1#2#3#4#5#6{\oldnewlabel{#1}{{#2}{#3}}}
\AtEndDocument{\ifx\hyper@anchor\@undefined
\let\contentsline\oldcontentsline
\let\newlabel\oldnewlabel
\fi}
\fi}
\global\let\hyper@last\relax 
\gdef\HyperFirstAtBeginDocument#1{#1}
\providecommand\HyField@AuxAddToFields[1]{}
\providecommand\HyField@AuxAddToCoFields[2]{}
\abx@aux@refcontext{nyt/global//global/global}
\AC@reset@newl@bel
\providecommand \oddpage@label [2]{}
\@writefile{toc}{\boolfalse {citerequest}\boolfalse {citetracker}\boolfalse {pagetracker}\boolfalse {backtracker}\relax }
\@writefile{lof}{\boolfalse {citerequest}\boolfalse {citetracker}\boolfalse {pagetracker}\boolfalse {backtracker}\relax }
\@writefile{lot}{\boolfalse {citerequest}\boolfalse {citetracker}\boolfalse {pagetracker}\boolfalse {backtracker}\relax }
\babel@aux{english}{}
\babel@aux{spanish}{}
\@writefile{toc}{\contentsline {section}{Agradecimientos}{2}{section*.1}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{Resumen}{4}{section*.3}\protected@file@percent }
\babel@aux{spanish}{}
\abx@aux@cite{ecb_sepa}
\abx@aux@segm{0}{0}{ecb_sepa}
\babel@aux{english}{}
\abx@aux@cite{ecb_sepa}
\abx@aux@segm{0}{0}{ecb_sepa}
\newlabel{sec:Lista de acrónimos}{{}{11}{Lista de acrónimos}{chapter*.8}{}}
\@writefile{toc}{\contentsline {section}{Lista de acrónimos}{11}{chapter*.8}\protected@file@percent }
\babel@aux{spanish}{}
\abx@aux@cite{ecb_sepa}
\abx@aux@segm{0}{0}{ecb_sepa}
\abx@aux@cite{epc_sdd_2025}
\abx@aux@segm{0}{0}{epc_sdd_2025}
\@writefile{toc}{\contentsline {chapter}{\numberline {1}Introducción}{1}{chapter.1}\protected@file@percent }
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\newlabel{sec:Introduccion}{{1}{1}{Introducción}{chapter.1}{}}
\@writefile{toc}{\contentsline {section}{\numberline {1.1}Motivación}{1}{section.1.1}\protected@file@percent }
\newlabel{subsec:Motivacion}{{1.1}{1}{Motivación}{section.1.1}{}}
\abx@aux@cite{epc016}
\abx@aux@segm{0}{0}{epc016}
\@writefile{toc}{\contentsline {subsection}{\numberline {1.1.1}Ineficiencias operativas detectadas}{2}{subsection.1.1.1}\protected@file@percent }
\newlabel{subsec:ineficiencias}{{1.1.1}{2}{Ineficiencias operativas detectadas}{subsection.1.1.1}{}}
\abx@aux@cite{EC_2018_RTS_SCA}
\abx@aux@segm{0}{0}{EC_2018_RTS_SCA}
\abx@aux@cite{epc_sctinst_2025}
\abx@aux@segm{0}{0}{epc_sctinst_2025}
\abx@aux@cite{iso20022_55005}
\abx@aux@segm{0}{0}{iso20022_55005}
\@writefile{toc}{\contentsline {paragraph}{En conclusión.}{4}{section*.9}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {1.1.2}Oportunidad de un esquema RTP}{4}{subsection.1.1.2}\protected@file@percent }
\newlabel{subsec:oportunidadRTP}{{1.1.2}{4}{Oportunidad de un esquema RTP}{subsection.1.1.2}{}}
\abx@aux@cite{epc014}
\abx@aux@segm{0}{0}{epc014}
\@writefile{lot}{\contentsline {table}{\numberline {1.1}{\ignorespaces Comparativa entre SDD y SRTP con SCT Inst}}{5}{table.1.1}\protected@file@percent }
\newlabel{tab:comparativa-sdd-srtp}{{1.1}{5}{Comparativa entre SDD y SRTP con SCT Inst}{table.1.1}{}}
\@writefile{toc}{\contentsline {section}{\numberline {1.2}Objetivos fundamentales}{5}{section.1.2}\protected@file@percent }
\newlabel{subsec:Objetivos}{{1.2}{5}{Objetivos fundamentales}{section.1.2}{}}
\abx@aux@cite{EPC_official}
\abx@aux@segm{0}{0}{EPC_official}
\@writefile{toc}{\contentsline {section}{\numberline {1.3}Fases y Métodos}{6}{section.1.3}\protected@file@percent }
\newlabel{subsec:FasesMetodos}{{1.3}{6}{Fases y Métodos}{section.1.3}{}}
\abx@aux@cite{eu_260_2012}
\abx@aux@segm{0}{0}{eu_260_2012}
\abx@aux@cite{epc125_2023}
\abx@aux@segm{0}{0}{epc125_2023}
\abx@aux@cite{EU_IBAN_2001}
\abx@aux@segm{0}{0}{EU_IBAN_2001}
\abx@aux@cite{EBA_RT1}
\abx@aux@segm{0}{0}{EBA_RT1}
\@writefile{toc}{\contentsline {chapter}{\numberline {2}Antecedentes y estado del arte}{7}{chapter.2}\protected@file@percent }
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\newlabel{sec:estado-arte}{{2}{7}{Antecedentes y estado del arte}{chapter.2}{}}
\@writefile{toc}{\contentsline {section}{\numberline {2.1}Evolución de los medios de pago hacia SEPA}{7}{section.2.1}\protected@file@percent }
\newlabel{subsec:evolucion-sepa}{{2.1}{7}{Evolución de los medios de pago hacia SEPA}{section.2.1}{}}
\abx@aux@cite{ECB_ERPB}
\abx@aux@segm{0}{0}{ECB_ERPB}
\abx@aux@cite{fourcorner_wiki}
\abx@aux@segm{0}{0}{fourcorner_wiki}
\abx@aux@cite{ecp014}
\abx@aux@segm{0}{0}{ecp014}
\abx@aux@cite{epc098_2021}
\abx@aux@segm{0}{0}{epc098_2021}
\@writefile{toc}{\contentsline {section}{\numberline {2.2}El papel del EPC en la estandarización y el surgimiento de Request-to-Pay}{8}{section.2.2}\protected@file@percent }
\newlabel{subsec:epc-rtp}{{2.2}{8}{El papel del EPC en la estandarización y el surgimiento de Request-to-Pay}{section.2.2}{}}
\@writefile{toc}{\contentsline {section}{\numberline {2.3}Funcionamiento técnico de SEPA Request-to-Pay (SRTP)}{8}{section.2.3}\protected@file@percent }
\newlabel{subsec:funcionamiento-srtp}{{2.3}{8}{Funcionamiento técnico de SEPA Request-to-Pay (SRTP)}{section.2.3}{}}
\@writefile{toc}{\contentsline {paragraph}{Modelo de cuatro esquinas.}{8}{section*.10}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {2.1}{\ignorespaces Modelo de 4 esquinas}}{9}{figure.2.1}\protected@file@percent }
\newlabel{fig:4corner}{{2.1}{9}{Modelo de 4 esquinas}{figure.2.1}{}}
\@writefile{lot}{\contentsline {table}{\numberline {2.1}{\ignorespaces Pasos del flujo del esquema SEPA Request-to-Pay (SRTP) y su descripción}}{9}{table.2.1}\protected@file@percent }
\newlabel{tab:srtp-steps-a}{{2.1}{9}{Pasos del flujo del esquema SEPA Request-to-Pay (SRTP) y su descripción}{table.2.1}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {2.2}{\ignorespaces Diagrama de flujo de intercambio RTP}}{11}{figure.2.2}\protected@file@percent }
\newlabel{fig:Flujo}{{2.2}{11}{Diagrama de flujo de intercambio RTP}{figure.2.2}{}}
\@writefile{lot}{\contentsline {table}{\numberline {2.2}{Pasos del esquema SRTP}}{12}{table.2.2}\protected@file@percent }
\newlabel{tab:srtp-steps-b}{{2.2}{12}{Pasos del esquema SRTP}{table.2.2}{}}
\gdef \LT@i {\LT@entry 
    {1}{106.15825pt}\LT@entry 
    {1}{361.83305pt}}
\@writefile{toc}{\contentsline {paragraph}{Casos de uso representativos.}{14}{section*.11}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {2.4}RTP dentro del ecosistema de pagos: arquitectura en capas}{17}{section.2.4}\protected@file@percent }
\newlabel{subsec:cubo-pagos}{{2.4}{17}{RTP dentro del ecosistema de pagos: arquitectura en capas}{section.2.4}{}}
\abx@aux@cite{ECB_TIPS}
\abx@aux@segm{0}{0}{ECB_TIPS}
\@writefile{lof}{\contentsline {figure}{\numberline {2.3}{\ignorespaces Esquema por capas}}{19}{figure.2.3}\protected@file@percent }
\newlabel{fig:Esquema por capas}{{2.3}{19}{Esquema por capas}{figure.2.3}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {2.4}{\ignorespaces LayerComp}}{21}{figure.2.4}\protected@file@percent }
\newlabel{fig:Esquema por capas comparación}{{2.4}{21}{LayerComp}{figure.2.4}{}}
\@writefile{toc}{\contentsline {chapter}{\numberline {3}Diseño}{23}{chapter.3}\protected@file@percent }
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\newlabel{sec:diseno}{{3}{23}{Diseño}{chapter.3}{}}
\@writefile{toc}{\contentsline {section}{\numberline {3.1}Objetivos técnicos}{23}{section.3.1}\protected@file@percent }
\newlabel{subsec:diseno_objetivos}{{3.1}{23}{Objetivos técnicos}{section.3.1}{}}
\@writefile{toc}{\contentsline {section}{\numberline {3.2}Actores y alcance}{25}{section.3.2}\protected@file@percent }
\newlabel{subsec:diseno_actores}{{3.2}{25}{Actores y alcance}{section.3.2}{}}
\abx@aux@cite{epc014}
\abx@aux@segm{0}{0}{epc014}
\@writefile{toc}{\contentsline {paragraph}{Alcance de la emulación.}{26}{section*.13}\protected@file@percent }
\gdef \LT@ii {\LT@entry 
    {1}{57.30077pt}\LT@entry 
    {1}{354.005pt}}
\@writefile{toc}{\contentsline {section}{\numberline {3.3}Requisitos}{27}{section.3.3}\protected@file@percent }
\newlabel{subsec:diseno_requisitos}{{3.3}{27}{Requisitos}{section.3.3}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.3.1}Requisitos funcionales (RF)}{27}{subsection.3.3.1}\protected@file@percent }
\@writefile{lot}{\contentsline {table}{\numberline {3.1}{Requisitos funcionales}}{27}{table.3.1}\protected@file@percent }
\newlabel{tab:RF}{{3.1}{27}{Requisitos funcionales}{table.3.1}{}}
\gdef \LT@iii {\LT@entry 
    {1}{57.30077pt}\LT@entry 
    {1}{354.005pt}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.3.2}Requisitos no funcionales (RNF)}{28}{subsection.3.3.2}\protected@file@percent }
\@writefile{lot}{\contentsline {table}{\numberline {3.2}{Requisitos no funcionales}}{28}{table.3.2}\protected@file@percent }
\newlabel{tab:RNF}{{3.2}{28}{Requisitos no funcionales}{table.3.2}{}}
\@writefile{toc}{\contentsline {section}{\numberline {3.4}Casos de uso}{28}{section.3.4}\protected@file@percent }
\newlabel{subsec:diseno_casos_uso}{{3.4}{28}{Casos de uso}{section.3.4}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.4.1}CU-01 Crear solicitud RTP}{28}{subsection.3.4.1}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {3.4.2}CU-02: Decidir solicitud RTP}{29}{subsection.3.4.2}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {3.5}Modelo de datos}{29}{section.3.5}\protected@file@percent }
\newlabel{subsec:diseno_datos}{{3.5}{29}{Modelo de datos}{section.3.5}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {3.1}{\ignorespaces Diagrama de secuencia para CU‑01 (crear solicitud RTP).}}{30}{figure.3.1}\protected@file@percent }
\newlabel{fig:seq_cu01}{{3.1}{30}{Diagrama de secuencia para CU‑01 (crear solicitud RTP)}{figure.3.1}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {3.2}{\ignorespaces Diagrama de secuencia para CU‑02 (decisión final RTP).}}{31}{figure.3.2}\protected@file@percent }
\newlabel{fig:seq_cu02}{{3.2}{31}{Diagrama de secuencia para CU‑02 (decisión final RTP)}{figure.3.2}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {3.3}{\ignorespaces Modelo entidad-relación del prototipo.}}{32}{figure.3.3}\protected@file@percent }
\newlabel{fig:er_model}{{3.3}{32}{Modelo entidad-relación del prototipo}{figure.3.3}{}}
\@writefile{toc}{\contentsline {section}{\numberline {3.6}Arquitectura lógica}{33}{section.3.6}\protected@file@percent }
\newlabel{subsec:diseno_arquitectura}{{3.6}{33}{Arquitectura lógica}{section.3.6}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.6.1}Componentes principales}{33}{subsection.3.6.1}\protected@file@percent }
\newlabel{subsec:componentes_principales}{{3.6.1}{33}{Componentes principales}{subsection.3.6.1}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {3.4}{\ignorespaces Arquitectura lógica y flujo de dependencias del prototipo.}}{34}{figure.3.4}\protected@file@percent }
\newlabel{fig:componentes}{{3.4}{34}{Arquitectura lógica y flujo de dependencias del prototipo}{figure.3.4}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.6.2}Flujo de interacción lógico}{34}{subsection.3.6.2}\protected@file@percent }
\newlabel{subsec:flujo_interaccion}{{3.6.2}{34}{Flujo de interacción lógico}{subsection.3.6.2}{}}
\@writefile{toc}{\contentsline {section}{\numberline {3.7}Emulación del flujo RTP}{34}{section.3.7}\protected@file@percent }
\newlabel{subsec:emulacion_flujo_rtp}{{3.7}{34}{Emulación del flujo RTP}{section.3.7}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {3.5}{\ignorespaces Máquina de estados del objeto RTP.}}{35}{figure.3.5}\protected@file@percent }
\newlabel{fig:state_machine_rtp}{{3.5}{35}{Máquina de estados del objeto RTP}{figure.3.5}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.7.1}Máquina de estados del objeto RTP}{35}{subsection.3.7.1}\protected@file@percent }
\newlabel{subsec:rtp_state_machine}{{3.7.1}{35}{Máquina de estados del objeto RTP}{subsection.3.7.1}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.7.2}Transiciones y reglas de negocio}{35}{subsection.3.7.2}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {3.7.3}Condiciones excepcionales y \emph  {timeouts}}{36}{subsection.3.7.3}\protected@file@percent }
\@writefile{toc}{\contentsline {chapter}{\numberline {4}Implementación}{37}{chapter.4}\protected@file@percent }
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\newlabel{sec:implementacion}{{4}{37}{Implementación}{chapter.4}{}}
\@writefile{toc}{\contentsline {section}{\numberline {4.1}Visión general de la arquitectura y organización del código}{37}{section.4.1}\protected@file@percent }
\newlabel{sec:impl-vision}{{4.1}{37}{Visión general de la arquitectura y organización del código}{section.4.1}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {4.1.1}Componentes del servidor}{37}{subsection.4.1.1}\protected@file@percent }
\newlabel{subsec:componentes-del.serv}{{4.1.1}{37}{Componentes del servidor}{subsection.4.1.1}{}}
\@writefile{toc}{\contentsline {paragraph}{Cliente}{38}{section*.14}\protected@file@percent }
\@writefile{toc}{\contentsline {paragraph}{Interacción entre componentes}{38}{section*.15}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {4.1.2}Estructura de directorios}{38}{subsection.4.1.2}\protected@file@percent }
\newlabel{sec:impl-vision-tree}{{4.1.2}{38}{Estructura de directorios}{subsection.4.1.2}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {4.1}{\ignorespaces Estructura en árbol del directorio}}{40}{figure.4.1}\protected@file@percent }
\newlabel{fig:treeB}{{4.1}{40}{Estructura en árbol del directorio}{figure.4.1}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {4.1.3}Satisfacción de requisitos}{40}{subsection.4.1.3}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {4.2}Persistencia y modelos ORM}{43}{section.4.2}\protected@file@percent }
\newlabel{subsec:orm}{{4.2}{43}{Persistencia y modelos ORM}{section.4.2}{}}
\@writefile{toc}{\contentsline {section}{\numberline {4.3}Servicios de dominio}{45}{section.4.3}\protected@file@percent }
\newlabel{subsec:servicios_dominio}{{4.3}{45}{Servicios de dominio}{section.4.3}{}}
\@writefile{toc}{\contentsline {section}{\numberline {4.4}API REST y WebSocket}{46}{section.4.4}\protected@file@percent }
\newlabel{subsec:api_ws}{{4.4}{46}{API REST y WebSocket}{section.4.4}{}}
\@writefile{toc}{\contentsline {section}{\numberline {4.5}Blueprints y su propósito}{46}{section.4.5}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {4.6}Endpoints REST}{46}{section.4.6}\protected@file@percent }
\@writefile{lot}{\contentsline {table}{\numberline {4.1}{\ignorespaces Endpoints REST del sistema SRTP}}{47}{table.4.1}\protected@file@percent }
\newlabel{tab:endpoints}{{4.1}{47}{Endpoints REST del sistema SRTP}{table.4.1}{}}
\@writefile{toc}{\contentsline {section}{\numberline {4.7}Frontend y notificaciones}{47}{section.4.7}\protected@file@percent }
\newlabel{subsec:frontend}{{4.7}{47}{Frontend y notificaciones}{section.4.7}{}}
\@writefile{toc}{\contentsline {section}{\numberline {4.8}Despliegue y configuración}{49}{section.4.8}\protected@file@percent }
\newlabel{subsec:despliegue}{{4.8}{49}{Despliegue y configuración}{section.4.8}{}}
\@writefile{toc}{\contentsline {subsection}{\numberline {4.8.1}Ejecución del sistema}{50}{subsection.4.8.1}\protected@file@percent }
\@writefile{toc}{\contentsline {subsection}{\numberline {4.8.2}Conclusión}{50}{subsection.4.8.2}\protected@file@percent }
\@writefile{toc}{\contentsline {chapter}{\numberline {5}Validacion}{51}{chapter.5}\protected@file@percent }
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\newlabel{sec:validacion}{{5}{51}{Validacion}{chapter.5}{}}
\@writefile{toc}{\contentsline {section}{\numberline {5.1}Entorno de pruebas}{51}{section.5.1}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {5.2}Metodología}{51}{section.5.2}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {5.3}Flujo \textit  {happy path}}{52}{section.5.3}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {5.4}Escenarios de error}{52}{section.5.4}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{\numberline {5.5}Conclusiones}{53}{section.5.5}\protected@file@percent }
\@writefile{lof}{\contentsline {figure}{\numberline {5.1}{\ignorespaces Variable \texttt  {baseURL} en Postman}}{53}{figure.5.1}\protected@file@percent }
\newlabel{fig:baseURL}{{5.1}{53}{Variable \texttt {baseURL} en Postman}{figure.5.1}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.2}{\ignorespaces crearActor}}{53}{figure.5.2}\protected@file@percent }
\newlabel{fig:crearActor}{{5.2}{53}{crearActor}{figure.5.2}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.3}{\ignorespaces crearActorResponse}}{54}{figure.5.3}\protected@file@percent }
\newlabel{fig:crearActorResponse}{{5.3}{54}{crearActorResponse}{figure.5.3}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.4}{\ignorespaces MiAPITFG}}{54}{figure.5.4}\protected@file@percent }
\newlabel{fig:MiAPITFG}{{5.4}{54}{MiAPITFG}{figure.5.4}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.5}{\ignorespaces RunResults}}{54}{figure.5.5}\protected@file@percent }
\newlabel{fig:RunResults}{{5.5}{54}{RunResults}{figure.5.5}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.6}{\ignorespaces crearRTP}}{55}{figure.5.6}\protected@file@percent }
\newlabel{fig:crearRTP}{{5.6}{55}{crearRTP}{figure.5.6}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.7}{\ignorespaces crearRTPResponse}}{55}{figure.5.7}\protected@file@percent }
\newlabel{fig:crearRTPResponse}{{5.7}{55}{crearRTPResponse}{figure.5.7}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.8}{\ignorespaces validarBenef}}{55}{figure.5.8}\protected@file@percent }
\newlabel{fig:validarBenef}{{5.8}{55}{validarBenef}{figure.5.8}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.9}{\ignorespaces validarBenefResponse}}{56}{figure.5.9}\protected@file@percent }
\newlabel{fig:validarBenefResponse}{{5.9}{56}{validarBenefResponse}{figure.5.9}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.10}{\ignorespaces enrutarBenef}}{56}{figure.5.10}\protected@file@percent }
\newlabel{fig:enrutarBenef}{{5.10}{56}{enrutarBenef}{figure.5.10}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.11}{\ignorespaces enrutarBenefResponse}}{56}{figure.5.11}\protected@file@percent }
\newlabel{fig:enrutarBenefResponse}{{5.11}{56}{enrutarBenefResponse}{figure.5.11}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.12}{\ignorespaces validarPayer}}{56}{figure.5.12}\protected@file@percent }
\newlabel{fig:validarPayer}{{5.12}{56}{validarPayer}{figure.5.12}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.13}{\ignorespaces validarPayerResponse}}{57}{figure.5.13}\protected@file@percent }
\newlabel{fig:validarPayerResponse}{{5.13}{57}{validarPayerResponse}{figure.5.13}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.14}{\ignorespaces decision}}{57}{figure.5.14}\protected@file@percent }
\newlabel{fig:decision}{{5.14}{57}{decision}{figure.5.14}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.15}{\ignorespaces decisionResponse}}{57}{figure.5.15}\protected@file@percent }
\newlabel{fig:decisionResponse}{{5.15}{57}{decisionResponse}{figure.5.15}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.16}{\ignorespaces error1}}{58}{figure.5.16}\protected@file@percent }
\newlabel{fig:error1}{{5.16}{58}{error1}{figure.5.16}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.17}{\ignorespaces error2\_1}}{58}{figure.5.17}\protected@file@percent }
\newlabel{fig:error2_1}{{5.17}{58}{error2\_1}{figure.5.17}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.18}{\ignorespaces error2\_2}}{59}{figure.5.18}\protected@file@percent }
\newlabel{fig:error2_2}{{5.18}{59}{error2\_2}{figure.5.18}{}}
\@writefile{lof}{\contentsline {figure}{\numberline {5.19}{\ignorespaces error3}}{59}{figure.5.19}\protected@file@percent }
\newlabel{fig:error3}{{5.19}{59}{error3}{figure.5.19}{}}
\@writefile{toc}{\contentsline {chapter}{\numberline {6}Conclusiones}{61}{chapter.6}\protected@file@percent }
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\newlabel{sec:Conclusiones}{{6}{61}{Conclusiones}{chapter.6}{}}
\@writefile{toc}{\contentsline {chapter}{\numberline {7}Líneas futuras}{63}{chapter.7}\protected@file@percent }
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\newlabel{sec:Potencial}{{7}{63}{Líneas futuras}{chapter.7}{}}
\newlabel{lst:1}{{7.1}{65}{RF-01 Crear Solicitud RTP services.py}{lstlisting.7.1}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.1}RF-01 Crear Solicitud RTP services.py}{65}{lstlisting.7.1}\protected@file@percent }
\newlabel{lst:2}{{7.2}{65}{RF-01 Crear Solicitud RTP routes.py}{lstlisting.7.2}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.2}RF-01 Crear Solicitud RTP routes.py}{65}{lstlisting.7.2}\protected@file@percent }
\newlabel{lst:3}{{7.3}{66}{RF-01 Crear Solicitud RTP RTP.js}{lstlisting.7.3}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.3}RF-01 Crear Solicitud RTP RTP.js}{66}{lstlisting.7.3}\protected@file@percent }
\newlabel{lst:4}{{7.4}{66}{RF-02 Validar y enrutar RTP services.py}{lstlisting.7.4}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.4}RF-02 Validar y enrutar RTP services.py}{66}{lstlisting.7.4}\protected@file@percent }
\newlabel{lst:5}{{7.5}{67}{RF-02 Validar y enrutar RTP routes.py}{lstlisting.7.5}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.5}RF-02 Validar y enrutar RTP routes.py}{67}{lstlisting.7.5}\protected@file@percent }
\newlabel{lst:6}{{7.6}{67}{RF-02 Validar y enrutar RTP utils.py}{lstlisting.7.6}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.6}RF-02 Validar y enrutar RTP utils.py}{67}{lstlisting.7.6}\protected@file@percent }
\newlabel{lst:7}{{7.7}{68}{RF-02 Validar y enrutar RTP RTP.js}{lstlisting.7.7}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.7}RF-02 Validar y enrutar RTP RTP.js}{68}{lstlisting.7.7}\protected@file@percent }
\newlabel{lst:8}{{7.8}{69}{RF-03 Validación pagador services.py}{lstlisting.7.8}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.8}RF-03 Validación pagador services.py}{69}{lstlisting.7.8}\protected@file@percent }
\newlabel{lst:9}{{7.9}{69}{RF-03 Validación pagador routes.py}{lstlisting.7.9}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.9}RF-03 Validación pagador routes.py}{69}{lstlisting.7.9}\protected@file@percent }
\newlabel{lst:10}{{7.10}{70}{RF-03 Validación pagador RTP.js}{lstlisting.7.10}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.10}RF-03 Validación pagador RTP.js}{70}{lstlisting.7.10}\protected@file@percent }
\newlabel{lst:11}{{7.11}{70}{RF-04 Decisión final services.py}{lstlisting.7.11}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.11}RF-04 Decisión final services.py}{70}{lstlisting.7.11}\protected@file@percent }
\newlabel{lst:12}{{7.12}{71}{RF-04 Decisión final routes.py}{lstlisting.7.12}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.12}RF-04 Decisión final routes.py}{71}{lstlisting.7.12}\protected@file@percent }
\newlabel{lst:13}{{7.13}{71}{RF-04 Decisión final RTP.js}{lstlisting.7.13}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.13}RF-04 Decisión final RTP.js}{71}{lstlisting.7.13}\protected@file@percent }
\newlabel{lst:14}{{7.14}{71}{RF-05 Notificación ext\_socketio.py}{lstlisting.7.14}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.14}RF-05 Notificación ext\_socketio.py}{71}{lstlisting.7.14}\protected@file@percent }
\newlabel{lst:15}{{7.15}{72}{RF-05 Notificación services.py}{lstlisting.7.15}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.15}RF-05 Notificación services.py}{72}{lstlisting.7.15}\protected@file@percent }
\newlabel{lst:16}{{7.16}{72}{RF-05 Notificación RTP.js}{lstlisting.7.16}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.16}RF-05 Notificación RTP.js}{72}{lstlisting.7.16}\protected@file@percent }
\newlabel{lst:17}{{7.17}{72}{RNF-02 Seguridad y trazabilidad utils.py}{lstlisting.7.17}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.17}RNF-02 Seguridad y trazabilidad utils.py}{72}{lstlisting.7.17}\protected@file@percent }
\newlabel{lst:18}{{7.18}{73}{RNF-02 Seguridad y trazabilidad models.py}{lstlisting.7.18}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.18}RNF-02 Seguridad y trazabilidad models.py}{73}{lstlisting.7.18}\protected@file@percent }
\newlabel{lst:19}{{7.19}{73}{RNF-03 Portabilidad config.py}{lstlisting.7.19}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.19}RNF-03 Portabilidad config.py}{73}{lstlisting.7.19}\protected@file@percent }
\newlabel{lst:20}{{7.20}{73}{RNF-03 Portabilidad requirements.txt}{lstlisting.7.20}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.20}RNF-03 Portabilidad requirements.txt}{73}{lstlisting.7.20}\protected@file@percent }
\newlabel{lst:21}{{7.21}{73}{RNF-03 Portabilidad app.py}{lstlisting.7.21}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.21}RNF-03 Portabilidad app.py}{73}{lstlisting.7.21}\protected@file@percent }
\newlabel{lst:22}{{7.22}{74}{clase Actor}{lstlisting.7.22}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.22}clase Actor}{74}{lstlisting.7.22}\protected@file@percent }
\newlabel{lst:23}{{7.23}{75}{clase RTP}{lstlisting.7.23}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.23}clase RTP}{75}{lstlisting.7.23}\protected@file@percent }
\newlabel{lst:24}{{7.24}{75}{clase Log}{lstlisting.7.24}{}}
\@writefile{lol}{\contentsline {lstlisting}{\numberline {7.24}clase Log}{75}{lstlisting.7.24}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{Índice de Figuras}{77}{chapter*.28}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{Índice de Tablas}{79}{chapter*.29}\protected@file@percent }
\@writefile{toc}{\contentsline {section}{Índice de Listados}{81}{chapter*.30}\protected@file@percent }
\abx@aux@refcontextdefaultsdone
\abx@aux@defaultrefcontext{0}{ECB_TIPS}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{ECB_ERPB}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{ecb_sepa}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{EBA_RT1}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{EU_IBAN_2001}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{fourcorner_wiki}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{epc098_2021}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{epc137}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{epc164}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{epc125_2023}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{epc_sdd_2025}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{epc_sctinst_2025}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{EPC_official}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{epc016}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{epc014}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{EC_2018_RTS_SCA}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{eu_260_2012}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{sdd_chargebacks_adyen}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{reg260_2012}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{sdd_study_steinbeis}{nyt/global//global/global}
\abx@aux@defaultrefcontext{0}{iso20022_55005}{nyt/global//global/global}


# END FILE CONTENTS


# File: frontend/index.html

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Banco - Prototipo RTP</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Great+Vibes&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary" id="mainNavbar" style="display:none;">
  <div class="container-fluid">
    <a class="navbar-brand" onclick="mostrarSeccion('homeDashboard', true)">
      Mi Banco Online
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link" onclick="mostrarSeccion('seccionCuentas')">
            <i class="fas fa-wallet"></i> Cuentas
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" onclick="mostrarSeccion('seccionTarjetas')">
            <i class="fas fa-credit-card"></i> Tarjetas
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" onclick="mostrarSeccion('seccionPerfil')">
            <i class="fas fa-user"></i> Perfil
          </a>
        </li>
        <li class="nav-item">
          <!-- El enlace al RTP sigue igual, pues al llamar a mostrarSeccion('seccionRTP') se cargará el contenido vía RTP.js -->
          <a class="nav-link" onclick="mostrarSeccion('seccionRTP')">
            <i class="fas fa-hand-holding-usd"></i> Request to Pay
          </a>
        </li>
      </ul>
      <span class="navbar-text" id="navbarUserInfo"></span>
    </div>
  </div>
</nav>

<!-- CONTENEDOR PRINCIPAL -->
<div class="container my-4">
  <!-- SECCIÓN DE LOGIN (inicial) -->
  <div id="loginSection" class="fadeIn">
    <h1 class="text-center mb-4">Bienvenido a Mi Banco Online</h1>
    <div class="row justify-content-center">
      <div class="col-md-6">
        <div class="card">
          <div class="card-header bg-primary text-white">Inicio de Sesión</div>
          <div class="card-body">
            <form id="loginForm" class="row g-3">
              <div class="col-12">
                <label for="username" class="form-label">Usuario</label>
                <input type="text" class="form-control" id="username" required placeholder="p.ej. Mercadona">
              </div>
              <div class="col-12">
                <label for="password" class="form-label">Contraseña</label>
                <input type="password" class="form-control" id="password" required>
              </div>
              <div class="col-12 d-flex justify-content-end">
                <button type="submit" class="btn btn-primary">Entrar</button>
              </div>
            </form>
            <div id="loginError" class="alert alert-danger mt-2 invisible-section"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SECCIÓN PRINCIPAL DESPUÉS DEL LOGIN -->
  <div id="bankContent" class="invisible-section fadeIn">
    <!-- HOME DASHBOARD -->
    <div id="homeDashboard" class="invisible-section fadeIn dash-bg">
      <div class="row p-4 align-items-center">
        <div class="col-md-5 d-flex flex-column align-items-center user-info-container">
          <img id="homePhoto" class="profile-photo mb-3" src="" alt="Foto de perfil" style="display:none;">
          <h4 class="user-name" id="homeNameDisplay">empty</h4>
          <div class="iban-card mt-2">
            <p class="iban-text" id="homeIbanDisplay">empty</p>
          </div>
          <!-- Mensaje especial si es payer -->
          <p id="payerExtraMsg" class="mt-3 text-warning fw-bold invisible-section"></p>
        </div>
        <div class="col-md-7 text-center balance-container">
          <div class="balance-circle mx-auto">
            <h1 id="homeBalanceDisplay" class="mb-0">empty</h1>
          </div>
        </div>
      </div>
    </div>

    <hr class="my-4">

    <!-- SECCIONES FICTICIAS -->
    <div id="seccionCuentas" class="invisible-section">
      <div class="card mb-4">
        <div class="card-header bg-secondary text-white">Mis Cuentas</div>
        <div class="card-body">
          <p>Aquí iría la información de cuentas bancarias...</p>
        </div>
      </div>
    </div>

    <div id="seccionTarjetas" class="invisible-section">
      <div class="card mb-4">
        <div class="card-header bg-secondary text-white">Mis Tarjetas</div>
        <div class="card-body">
          <p>Aquí se mostraría la info de tarjetas...</p>
        </div>
      </div>
    </div>
    
    <!-- SECCIÓN PERFIL -->
    <div id="seccionPerfil" class="invisible-section fadeIn">
      <div class="card mb-4">
        <div class="card-header bg-secondary text-white">Mi Perfil</div>
        <div class="card-body">
          <div class="mb-3" id="profileView">
            <img id="profilePhoto" src="" alt="Foto" width="100" style="display:none;">
            <p><strong>IBAN: </strong><span id="profileIban"></span></p>
            <p><strong>Saldo: </strong><span id="profileBalance"></span></p>
          </div>
          <form id="profileEditForm" class="row g-3">
            <div class="col-md-4">
              <label for="editPhoto" class="form-label">URL Foto</label>
              <input type="text" class="form-control" id="editPhoto">
            </div>
            <div class="col-md-4">
              <label for="editIban" class="form-label">IBAN</label>
              <input type="text" class="form-control" id="editIban">
            </div>
            <div class="col-md-4">
              <label for="editBalance" class="form-label">Saldo</label>
              <input type="number" step="0.01" class="form-control" id="editBalance">
            </div>
            <div class="col-md-12 d-flex justify-content-end">
              <button type="submit" class="btn btn-primary">Actualizar Perfil</button>
            </div>
          </form>
          <div id="profileMsg" class="alert alert-secondary invisible-section mt-2"></div>
        </div>
      </div>
    </div>
    
    <!-- PLACEHOLDER para la SECCIÓN REQUEST TO PAY (RTP) -->
    <!-- Ahora el contenido se cargará dinámicamente desde RTP.html a través de RTP.js -->
    <div id="seccionRTP" class="invisible-section"></div>

    <!-- Menú inferior con iconos y texto visible + animación hover -->
    <div id="bottomMenuSquares" class="d-flex justify-content-around mt-4" style="display:none;">
      <div class="card text-center menu-item" style="width: 22%; cursor:pointer;" onclick="mostrarSeccion('seccionCuentas')">
        <div class="card-body menu-square-text"><i class="fas fa-wallet"></i> Cuentas</div>
      </div>
      <div class="card text-center menu-item" style="width: 22%; cursor:pointer;" onclick="mostrarSeccion('seccionTarjetas')">
        <div class="card-body menu-square-text"><i class="fas fa-credit-card"></i> Tarjetas</div>
      </div>
      <div class="card text-center menu-item" style="width: 22%; cursor:pointer;" onclick="mostrarSeccion('seccionPerfil')">
        <div class="card-body menu-square-text"><i class="fas fa-user"></i> Perfil</div>
      </div>
      <div class="card text-center menu-item" style="width: 22%; cursor:pointer;" onclick="mostrarSeccion('seccionRTP')">
        <div class="card-body menu-square-text"><i class="fas fa-hand-holding-usd"></i> Request to Pay</div>
      </div>
    </div>
  </div> <!-- Fin del contenedor principal -->
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Incluir Socket.IO -->
<script src="https://cdn.socket.io/4.5.1/socket.io.min.js"></script>
<script src="app.js"></script>
<!-- Incluir el nuevo fichero RTP.js para gestionar el RTP -->
<script src="RTP.js"></script>
</body>
</html>


# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/DiagComp.svg:Zone.Identifier



# END FILE CONTENTS


# File: MemoriaTFG/src/validacion.tex

\chapter{Validacion}
\label{sec:validacion}



% Explicando el propósito y la estrategia general de la validación
El objetivo de esta fase es demostrar, mediante evidencias reproducibles, que el prototipo desarrollado cumple con los requisitos funcionales \textbf{RF-01} a \textbf{RF-06} y los no funcionales \textbf{RNF-01} a \textbf{RNF-03}, definidos en el Capítulo 3, así como con las reglas establecidas en el \textit{SRTP Scheme Rulebook v4.0}. Para lograr esto, se diseñó una estrategia de validación escalonada que combina pruebas manuales exploratorias, una batería de pruebas automatizadas ejecutadas con Postman, y la inspección de \textit{logs} hashados que garantizan la trazabilidad del ciclo de vida de cada solicitud RTP. En esta sección se describe en detalle la metodología empleada, el entorno de pruebas, los escenarios cubiertos y los resultados obtenidos.

% Detallando el entorno de pruebas
\section{Entorno de pruebas}

El entorno de pruebas se configuró utilizando las siguientes herramientas y configuraciones:

\begin{itemize}
  \item \textbf{Herramientas}: Se utilizó Postman v10 para la construcción y envío de peticiones HTTP, SQLite 3 como base de datos, y la utilidad integrada de \textit{Flask-SocketIO} para la inspección de eventos en tiempo real.
  
  \item \textbf{Variable de entorno \texttt{baseURL}}: Antes de crear la colección de pruebas, se definió la variable \texttt{baseURL} con la URL base del servidor (véase Fig.~\ref{fig:baseURL}). Esto permite evitar la repetición de la URL completa en cada petición y facilita el cambio entre entornos (por ejemplo, de desarrollo a integración continua) con una sola modificación.
  
  \item \textbf{Datos semilla}: Al iniciar la aplicación, el archivo \texttt{app.py} crea automáticamente cuatro actores predefinidos. Estos actores cuentan con saldos, relaciones y roles preestablecidos, lo que permite ejecutar los flujos de prueba sin necesidad de pasos adicionales de alta de usuarios.
\end{itemize}

% Describiendo la metodología de pruebas
\section{Metodología}

La metodología de validación se estructuró en tres etapas principales:

\begin{enumerate}
  \item \textbf{Pruebas exploratorias}: En las primeras iteraciones del desarrollo, cuando el prototipo solo exponía la API REST, se empleó un ciclo manual de \textit{definir petición → enviar → analizar respuesta → refactorizar código} para depurar la lógica de negocio. Durante esta etapa, se mantuvieron \textit{endpoints} internos, como \texttt{/actor} (véase Fig.~\ref{fig:crearActor}), que, aunque ya no están expuestos en la interfaz web, siguen disponibles para escenarios de administración.
  
  \item \textbf{Colección Postman}: Una vez estabilizada la API, se preparó la colección \textit{MiAPITFG} (véase Fig.~\ref{fig:MiAPITFG}), que orquesta las llamadas clave del flujo RTP y verifica los códigos de estado HTTP, los cuerpos de respuesta JSON y la correcta transición de estados de la entidad \texttt{RTP}. Cada vez que se modifica el código, esta colección se ejecuta localmente.
  
  \item \textbf{Cobertura y trazabilidad}: Todas las pruebas están enlazadas con los requisitos y la función \texttt{cambiar\_estado\_rtp} registra un hash de los datos críticos cada vez que se produce un cambio de estado en una solicitud RTP, garantizando así la integridad y trazabilidad de los resultados de las pruebas.
\end{enumerate}

% Presentando el flujo nominal (happy path)
\section{Flujo \textit{happy path}}

El flujo nominal, también conocido como \textit{happy path}, fue validado mediante la colección Postman, siguiendo los pasos descritos a continuación. Las capturas asociadas a cada paso se enumeran entre paréntesis.

\begin{enumerate}
  \item \textbf{Creación del RTP} (\texttt{/rtp}, Figs.~\ref{fig:crearRTP}–\ref{fig:crearRTPResponse}): El beneficiario envía una solicitud de cobro a un pagador identificado por su IBAN.
  
  \item \textbf{Validación y enrutado en el PSP del Beneficiario} (Figs.~\ref{fig:validarBenef}–\ref{fig:enrutarBenefResponse}): Se verifica la sintaxis de la solicitud (IBAN válido, importe positivo, etc.) y, si todo es correcto, se enruta la solicitud al PSP del pagador.
  
  \item \textbf{Validación en el PSP del Pagador} (Figs.~\ref{fig:validarPayer}–\ref{fig:validarPayerResponse}): El PSP del pagador comprueba el saldo disponible y aplica reglas simplificadas de KYC/AML.
  
  \item \textbf{Decisión del Pagador} (Figs.~\ref{fig:decision}–\ref{fig:decisionResponse}): El pagador acepta o rechaza la solicitud. La decisión se propaga en menos de 10 segundos mediante WebSocket, cumpliendo con el requisito funcional \textbf{RF-05}.
\end{enumerate}

En cada una de estas fases, se comprobaron los siguientes aspectos:

\begin{itemize}
  \item El código de estado HTTP es el adecuado (por ejemplo, 201 para creación, 200 para éxito, 400 para error).
  \item La consistencia del estado de la solicitud RTP en la base de datos y la emisión correcta del evento \texttt{rtp\_<estado>} en la sala correspondiente de WebSocket.
\end{itemize}

% Analizando los escenarios de error
\section{Escenarios de error}

Para verificar la resiliencia del sistema frente a situaciones adversas, se diseñaron y probaron tres escenarios de error comunes, todos ellos incorporados a la colección Postman para garantizar la regresión continua:

\begin{description}
  \item[IBAN inválido o no registrado]: La función \texttt{validar\_iban()} rechaza la solicitud con un código de estado \texttt{400 Bad Request}. Este caso se muestra en la captura Fig.~\ref{fig:error1}.
  
  \item[Saldo insuficiente]: El PSP del pagador detecta que el saldo es insuficiente y emite un \textbf{rechazo}. La colección confirma que el estado final de la solicitud RTP es \texttt{rejected}. Véase Figs.~\ref{fig:error2_1}–\ref{fig:error2_2}.
  
  \item[Actores inexistentes]: Si alguno de los actores requeridos no está presente en la base de datos, el servicio responde con \texttt{404 Not Found} y el flujo se detiene inmediatamente (Fig.~\ref{fig:error3}).
\end{description}

% Resumiendo las conclusiones de la validación
\section{Conclusiones}

La estrategia de validación adoptada ha demostrado que:

\begin{itemize}
  \item Los tres escenarios de error confirman la robustez del sistema frente a datos maliciosos o inconsistentes, alineándose con el requisito no funcional \textbf{RNF-02}.
  \item La integración continua impide que nuevas funcionalidades degraden la experiencia del usuario o comprometan la seguridad del sistema.
\end{itemize}

En consecuencia, el prototipo satisface las metas de validación establecidas al inicio del proyecto y proporciona una base sólida para futuras extensiones, como la integración con bancos reales o la realización de pruebas de carga, tal como se propone en el capítulo \ref{sec:Potencial}.



\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/baseURL.png}
  \caption{Variable \texttt{baseURL} en Postman}
  \label{fig:baseURL}
\end{figure}


\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/crearActor.png}
  \caption{crearActor}
  \label{fig:crearActor}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/crearActorResponse.png}
  \caption{crearActorResponse}
  \label{fig:crearActorResponse}
\end{figure}


\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/MiAPITFG.png}
  \caption{MiAPITFG}
  \label{fig:MiAPITFG}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/RunResults.png}
  \caption{RunResults}
  \label{fig:RunResults}
\end{figure}



    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/crearRTP.png}
    \caption{crearRTP}
    \label{fig:crearRTP}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/crearRTPResponse.png}
    \caption{crearRTPResponse}
    \label{fig:crearRTPResponse}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/validarBenef.png}
    \caption{validarBenef}
    \label{fig:validarBenef}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/validarBenefResponse.png}
    \caption{validarBenefResponse}
    \label{fig:validarBenefResponse}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/enrutarBenef.png}
    \caption{enrutarBenef}
    \label{fig:enrutarBenef}
    \end{figure}


    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/enrutarBenefResponse.png}
    \caption{enrutarBenefResponse}
    \label{fig:enrutarBenefResponse}
    \end{figure}



    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/validarPayer.png}
    \caption{validarPayer}
    \label{fig:validarPayer}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/validarPayerResponse.png}
    \caption{validarPayerResponse}
    \label{fig:validarPayerResponse}
    \end{figure}



    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/decision.png}
    \caption{decision}
    \label{fig:decision}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/decisionResponse.png}
    \caption{decisionResponse}
    \label{fig:decisionResponse}
    \end{figure}



    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/error1.png}
    \caption{error1}
    \label{fig:error1}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/error2_1.png}
    \caption{error2\_1}
    \label{fig:error2_1}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/error2_2.png}
    \caption{error2\_2}
    \label{fig:error2_2}
    \end{figure}


    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/error3.png}
    \caption{error3}
    \label{fig:error3}
    \end{figure}


# END FILE CONTENTS


# File: MemoriaTFG/bibliografia.bib

@misc{epc014,
  author = {European Payments Council},
  title = {{SRTP Scheme Rulebook v4.0}},
  year = {2025},
  url = {https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2024-11/EPC014-20%20v4.0%20SEPA%20RTP%20Scheme%20Rulebook.pdf}
}

@misc{epc137,
  author = {European Payments Council},
  title = {{EPC137 - SRTP Implementation Guidelines}},
  year = {2023},
  url = {https://www.europeanpaymentscouncil.eu/document-library/implementation-guidelines/sepa-request-pay-implementation-guidelines-version-30}
}

@misc{epc164,
  author = {European Payments Council},
  title = {{EPC164 - API Security Framework}},
  year = {2023},
  url = {https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2024-10/EPC164-22%20v2.0%20API%20Security%20Framework.pdf}
}

@misc{ecb_sepa,
  author       = {European Central Bank},
  title        = {{Single Euro Payments Area (SEPA) – Overview}},
  year         = {2023},
  url          = {https://www.ecb.europa.eu/paym/integration/retail/sepa/html/index.en.html},
  howpublished = {Online},
}

@misc{reg260_2012,
  author       = {European Parliament and Council},
  title        = {{Regulation (EU) No 260/2012 on credit transfers and direct debits}},
  year         = {2012},
  url          = {https://eur-lex.europa.eu/eli/reg/2012/260/oj},
  howpublished = {Online},
}

@misc{epc_sdd_2025,
  author       = {European Payments Council},
  title        = {{2025 SEPA Direct Debit Core Rulebook v1.0}},
  year         = {2024},
  url          = {https://www.europeanpaymentscouncil.eu/document-library/rulebooks/2025-sepa-direct-debit-core-rulebook-version-10},
  howpublished = {PDF},
}

@misc{epc_sctinst_2025,
  author       = {European Payments Council},
  title        = {{2025 SEPA Instant Credit Transfer Rulebook v1.0}},
  year         = {2024},
  url          = {https://www.europeanpaymentscouncil.eu/document-library/rulebooks/2025-sepa-instant-credit-transfer-rulebook-version-10},
  howpublished = {PDF},
}

@misc{sdd_chargebacks_adyen,
  author       = {Adyen N.V.},
  title        = {{SEPA chargebacks – guidelines}},
  year         = {2024},
  url          = {https://docs.adyen.com/risk-management/chargeback-guidelines/sepa-chargebacks/},
  howpublished = {Online},
}

@misc{sdd_study_steinbeis,
  author       = {Research Center for Financial Services, Steinbeis University Berlin},
  title        = {{SEPA Direct Debit – a success story for the European payment market}},
  year         = {2010},
  url          = {https://www.steinbeis-research.de/pdf/Study_SEPA_Direct_Debit.pdf},
  howpublished = {PDF},
}

@misc{epc016,
  author       = {European Payments Council},
  title        = {{SEPA Direct Debit Core Scheme Rulebook v1.0}},
  year         = {2025},
  url          = {https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2024-11/EPC016-06%202025%20SDD%20Core%20Rulebook%20version%201.0.pdf},
  howpublished = {PDF},
}

@misc{EC_2018_RTS_SCA,
  author       = {{European Commission}},
  title        = {{Commission Delegated Regulation (EU) 2018/389 of 27 November 2017 supplementing Directive (EU) 2015/2366 with regard to regulatory technical standards for strong customer authentication and common and secure open standards of communication}},
  year         = {2018},
  url          = {https://eur-lex.europa.eu/legal-content/EN/TXT/PDF/?uri=CELEX:32018R0389},
  howpublished = {Online},
}

@misc{iso20022_55005,
  author       = {International Organization for Standardization},
  title        = {{ISO 20022 Financial services – Universal financial industry message scheme}},
  year         = {2013},
  url          = {https://www.iso.org/standard/55005.html},
  howpublished = {Online},
}

@misc{EPC_official,
  author       = {European Payments Council},
  title        = {{European Payments Council (EPC) – Official Website}},
  year         = {2025},
  url          = {https://www.europeanpaymentscouncil.eu/},
  howpublished = {Online},
  note         = {Consultado el 23-06-2025}
}

@misc{epc125_2023,
  author       = {European Payments Council},
  title        = {{SEPA Credit Transfer Scheme Rulebook v1.1}},
  year         = {2023},
  url          = {https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2023-11/EPC125-05%202023%20SCT%20Rulebook%20version%201.1_1.pdf},
  howpublished = {PDF},
  note         = {Consultado el 23-06-2025}
}
% Para citar al presentar el esquema SCT en 2.1. :contentReference[oaicite:0]{index=0}

@misc{EBA_RT1,
  author       = {EBA Clearing},
  title        = {{RT1 – Pan-European Real-Time Gross Settlement System}},
  year         = {2017},
  url          = {https://www.ebaclearing.eu/services-instant-payments/rt1/},
  howpublished = {Online},
  note         = {Consultado el 23-06-2025}
}
% Para citar al describir SCT Inst / infraestructura RT1 en 2.1. :contentReference[oaicite:1]{index=1}

@misc{ECB_TIPS,
  author       = {European Central Bank},
  title        = {{TARGET Instant Payment Settlement (TIPS)}},
  year         = {2018},
  url          = {https://www.ecb.europa.eu/paym/target/tips/html/index.en.html},
  howpublished = {Online},
  note         = {Consultado el 23-06-2025}
}
% Para citar al hablar de la capa de liquidación instantánea en 2.1 :contentReference[oaicite:2]{index=2}

@misc{EU_IBAN_2001,
  author       = {European Commission},
  title        = {{Commission Recommendation 2001/609/EC on the use of the IBAN}},
  year         = {2001},
  url          = {https://eur-lex.europa.eu/eli/reco/2001/609/oj},
  howpublished = {Online},
  note         = {Consultado el 23-06-2025}
}
% Para citar al explicar la armonización IBAN en 2.1 :contentReference[oaicite:3]{index=3}

@misc{ECB_ERPB,
  author       = {European Central Bank},
  title        = {{Euro Retail Payments Board (ERPB) – SEPA Request-to-Pay status update}},
  year         = {2020},
  url          = {https://www.ecb.europa.eu/paym/groups/erpb/shared/pdf/14th-ERPB-meeting/Status_update_on_the_SEPA_request-to-pay_scheme.pdf},
  howpublished = {PDF},
  note         = {Consultado el 23-06-2025}
}
% Para citar la génesis del SRTP tras la recomendación del ERPB en 2.2 :contentReference[oaicite:4]{index=4}

@misc{epc098_2021,
  author       = {European Payments Council},
  title        = {{EDS – EPC Directory Service Rulebook v1.0}},
  year         = {2021},
  url          = {https://www.europeanpaymentscouncil.eu/document-library/rulebooks/epc098-21-eds-directory-service-rulebook-version-10},
  howpublished = {PDF},
  note         = {Consultado el 23-06-2025}
}
% Para citar al describir OSM/EDS en 2.3 :contentReference[oaicite:5]{index=5}

@misc{fourcorner_wiki,
  author       = {Wikipedia contributors},
  title        = {{Four Corners Model for Payment Security}},
  year         = {2025},
  url          = {https://en.wikipedia.org/wiki/Four_Corners_Model_for_Payment_Security},
  howpublished = {Online},
  note         = {Consultado el 23-06-2025}
}
% Para citar el “4-corner model” en 2.3 

@misc{eu_260_2012,
  author       = {{European Parliament and Council}},
  title        = {{Regulation (EU) No 260/2012 of 14 March 2012 on the establishment of technical and business requirements for credit transfers and direct debits in euros}},
  year         = {2012},
  url          = {https://eur-lex.europa.eu/eli/reg/2012/260/oj},
  howpublished = {Online},
  note         = {Consultado el 23-06-2025}
}


# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/CU02.svg

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="461px" preserveAspectRatio="none" style="width:806px;height:461px;background:#FFFFFF;" version="1.1" viewBox="0 0 806 461" width="806px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="206.7344" style="stroke:#000000;stroke-width:1.5;" width="597.271" x="149.8652" y="156.5625"/><g><title>Pagador</title><rect fill="#000000" fill-opacity="0.00000" height="299" width="8" x="32.8477" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="36" x2="36" y1="81.2969" y2="380.2969"/></g><g><title>PSP Pagador</title><rect fill="#000000" fill-opacity="0.00000" height="299" width="8" x="206.8237" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="209.8652" x2="209.8652" y1="81.2969" y2="380.2969"/></g><g><title>Sistema</title><rect fill="#000000" fill-opacity="0.00000" height="299" width="8" x="411.1797" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="414.9849" x2="414.9849" y1="81.2969" y2="380.2969"/></g><g><title>PSP Beneficiario</title><rect fill="#000000" fill-opacity="0.00000" height="299" width="8" x="547.9331" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="551.3726" x2="551.3726" y1="81.2969" y2="380.2969"/></g><g><title>Beneficiario</title><rect fill="#000000" fill-opacity="0.00000" height="299" width="8" x="684.6865" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="688.2368" x2="688.2368" y1="81.2969" y2="380.2969"/></g><g><title>Payer</title><rect fill="#000000" fill-opacity="0.00000" height="299" width="8" x="769.9741" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="773.1362" x2="773.1362" y1="81.2969" y2="380.2969"/></g><g class="participant participant-head" data-participant="Pagador"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.6953" x="5" y="77.9951">Pagador</text><ellipse cx="36.8477" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M36.8477,21.5 L36.8477,48.5 M23.8477,29.5 L49.8477,29.5 M36.8477,48.5 L23.8477,63.5 M36.8477,48.5 L49.8477,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Pagador"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.6953" x="5" y="392.292">Pagador</text><ellipse cx="36.8477" cy="404.0938" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M36.8477,412.0938 L36.8477,439.0938 M23.8477,420.0938 L49.8477,420.0938 M36.8477,439.0938 L23.8477,454.0938 M36.8477,439.0938 L49.8477,454.0938" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="PSPP"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.917" x="159.8652" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.917" x="166.8652" y="69.9951">PSP Pagador</text></g><g class="participant participant-tail" data-participant="PSPP"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.917" x="159.8652" y="379.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.917" x="166.8652" y="399.292">PSP Pagador</text></g><g class="participant participant-head" data-participant="Sistema"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70.3896" x="379.9849" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56.3896" x="386.9849" y="69.9951">Sistema</text></g><g class="participant participant-tail" data-participant="Sistema"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70.3896" x="379.9849" y="379.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56.3896" x="386.9849" y="399.292">Sistema</text></g><g class="participant participant-head" data-participant="PSPB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.1211" x="488.3726" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.1211" x="495.3726" y="69.9951">PSP Beneficiario</text></g><g class="participant participant-tail" data-participant="PSPB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.1211" x="488.3726" y="379.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.1211" x="495.3726" y="399.292">PSP Beneficiario</text></g><g class="participant participant-head" data-participant="Beneficiario"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.8994" x="640.2368" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.8994" x="647.2368" y="69.9951">Beneficiario</text></g><g class="participant participant-tail" data-participant="Beneficiario"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.8994" x="640.2368" y="379.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.8994" x="647.2368" y="399.292">Beneficiario</text></g><g class="participant participant-head" data-participant="Payer"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53.6758" x="747.1362" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.6758" x="754.1362" y="69.9951">Payer</text></g><g class="participant participant-tail" data-participant="Payer"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53.6758" x="747.1362" y="379.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.6758" x="754.1362" y="399.292">Payer</text></g><g class="message" data-participant-1="PSPP" data-participant-2="Pagador"><polygon fill="#181818" points="47.8477,108.4297,37.8477,112.4297,47.8477,116.4297,43.8477,112.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="41.8477" x2="209.8237" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.9761" x="53.8477" y="107.3638">Presentar solicitud RTP</text></g><g class="message" data-participant-1="Payer" data-participant-2="PSPP"><polygon fill="#181818" points="221.8237,137.5625,211.8237,141.5625,221.8237,145.5625,217.8237,141.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="215.8237" x2="772.9741" y1="141.5625" y2="141.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.751" x="227.8237" y="136.4966">Decisi&#243;n (acceptar/rechazar)</text></g><path d="M149.8652,156.5625 L214.3081,156.5625 L214.3081,163.6953 L204.3081,173.6953 L149.8652,173.6953 L149.8652,156.5625" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="206.7344" style="stroke:#000000;stroke-width:1.5;" width="597.271" x="149.8652" y="156.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="164.8652" y="169.6294">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="123.7285" x="229.3081" y="168.7729">[Decisi&#243;n aceptada]</text><g class="message" data-participant-1="PSPP" data-participant-2="Sistema"><polygon fill="#181818" points="403.1797,190.8281,413.1797,194.8281,403.1797,198.8281,407.1797,194.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="210.8237" x2="409.1797" y1="194.8281" y2="194.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.1396" x="217.8237" y="189.7622">Registrar decisi&#243;n</text></g><g class="message" data-participant-1="Sistema" data-participant-2="PSPB"><polygon fill="#181818" points="539.9331,219.9609,549.9331,223.9609,539.9331,227.9609,543.9331,223.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="415.1797" x2="545.9331" y1="223.9609" y2="223.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.7534" x="422.1797" y="218.895">Notificar decisi&#243;n</text></g><g class="message" data-participant-1="PSPB" data-participant-2="Beneficiario"><polygon fill="#181818" points="676.6865,249.0938,686.6865,253.0938,676.6865,257.0938,680.6865,253.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="551.9331" x2="682.6865" y1="253.0938" y2="253.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.7534" x="558.9331" y="248.0278">Notificar decisi&#243;n</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="149.8652" x2="747.1362" y1="262.0938" y2="262.0938"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="115.124" x="154.8652" y="272.3042">[Tiempo excedido]</text><g class="message" data-participant-1="PSPP" data-participant-2="Sistema"><polygon fill="#181818" points="403.1797,293.0313,413.1797,297.0313,403.1797,301.0313,407.1797,297.0313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="210.8237" x2="409.1797" y1="297.0313" y2="297.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.356" x="217.8237" y="291.9653">Rechazar autom&#225;ticamente</text></g><g class="message" data-participant-1="Sistema" data-participant-2="PSPB"><polygon fill="#181818" points="539.9331,322.1641,549.9331,326.1641,539.9331,330.1641,543.9331,326.1641" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="415.1797" x2="545.9331" y1="326.1641" y2="326.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.6396" x="422.1797" y="321.0981">Notificar rechazo</text></g><g class="message" data-participant-1="PSPB" data-participant-2="Beneficiario"><polygon fill="#181818" points="676.6865,351.2969,686.6865,355.2969,676.6865,359.2969,680.6865,355.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="551.9331" x2="682.6865" y1="355.2969" y2="355.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.6396" x="558.9331" y="350.231">Notificar rechazo</text></g><!--SRC=[ZP0nRiCm34LtdOB8r0v5TmyTZCo5aEG2XCGc16p9e1WWoMrwXXuX5oljM823j6WrIUBx_9_4e5d0unvZ5ZUWA0SUC2ci_DRNmWgmWBtz7R7bejJZewgbH1_sWyAvIjixR4auDtQ6bxVgre0NAfGK1Khk3DDZXCtEEuzdaeaqHGDh2bpu-fNW2KEWmGIlGk605vHdXvqk29pg4HtOgORp10riQ6zNCSDO5HCu0xDbsy1xLhRW3-1O7QdbO3_Jr1M27LC_PA1JeCWn_nRgDWhWKND__RJjOMzheR-YtNQG_nMiifJYDm00]--></g></svg>

# END FILE CONTENTS


# File: frontend/styles.css

/* styles.css */

/* Importar fuentes */
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Great+Vibes&display=swap');

/* Fondo y tipografía general */
body {
    margin: 0;
    font-family: 'Montserrat', sans-serif;
    background: linear-gradient(135deg, #2b5876 0%, #4e4376 100%);
    color: #fff; /* color general blanco */
    position: relative;
}

/* Aseguramos color de texto oscuro en card-body, formularios, etc. */
.card-body, .card-body * {
    color: #333 !important;
}

/* Ajuste para inputs y selects, para texto visible en fondos claros */
input, select, textarea {
    color: #333 !important;
}

/* Secciones invisibles y animación */
.invisible-section {
    display: none;
}
.fadeIn {
    animation: fadeIn 0.5s;
}
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Navbar */
.navbar-brand {
    font-weight: bold;
    font-size: 1.3rem;
}
.nav-link {
    cursor: pointer;
    color: #fff !important;
}
.nav-link i {
    margin-right: 8px;
}

/* Dashboard principal */
.dash-bg {
    background: url('https://www.transparenttextures.com/patterns/45-degree-fabric.png'), 
                linear-gradient(135deg, #2b5876 0%, #4e4376 100%);
    padding: 20px;
    border-radius: 15px;
    position: relative;
    min-height: 400px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

/* Circle */
.balance-circle {
    width: 250px;
    height: 250px;
    border-radius: 50%;
    background: radial-gradient(circle at center, #fff 0%, #f0f0f0 100%);
    border: 5px solid #d4af37;
    box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.3s;
    margin-top: 30px;
    margin-bottom: 30px;
    overflow: hidden; /* Evita el overflow si se pasa */
}
.balance-circle:hover {
    transform: scale(1.05);
}
.balance-circle h1 {
    font-size: 2.5rem;
    color: #333;
    margin: 0;
    font-family: 'Montserrat', sans-serif;
    font-weight: 700;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    white-space: nowrap; 
    overflow: visible; 
    text-overflow: clip; 
}

/* Foto y contenedor del usuario */
.profile-photo {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid #d4af37;
    box-shadow: 0 0 15px rgba(212, 175, 55, 0.5);
}
.user-info-container {
    text-align: center;
}

/* Nombre e IBAN */
.user-name {
    font-family: 'Great Vibes', cursive;
    font-size: 2rem;
    color: #d4af37;
    text-shadow: 2px 2px 5px rgba(0,0,0,0.3);
}
.iban-card {
    background: linear-gradient(135deg, #d4af37, #f0e68c);
    padding: 10px 20px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    transition: transform 0.3s;
    display: inline-block;
}
.iban-card:hover {
    transform: translateY(-5px);
}
.iban-text {
    font-family: 'Montserrat', sans-serif;
    font-size: 1.1rem;
    color: #333;
    margin: 0;
}

/* Headers de las cards */
.card-header {
    font-weight: bold;
}

/* Menú inferior con texto visible + animación hover */
#bottomMenuSquares .card-body.menu-square-text {
    background-color: #f8f8f8;
    color: #333;
    font-weight: 600;
}
.menu-item {
    transition: transform 0.2s ease-in-out;
}
.menu-item:hover {
    transform: scale(1.05);
}

/* Alertas */
.alert {
    white-space: pre-wrap; /* Para mostrar JSON con saltos de línea */
}


# END FILE CONTENTS


# File: MemoriaTFG/src/resumen.tex

\phantomsection
\addcontentsline{toc}{section}{Resumen}

\thispagestyle{empty}
\selectlanguage{spanish}

\chapter*{Resumen}
En España, la domiciliación bancaria, regulada bajo el esquema \textit{SEPA\cite{ecb_sepa} Direct Debit} (SDD), es el método predominante para los cobros recurrentes. Este sistema permite a los acreedores realizar cargos automáticos en las cuentas de los deudores con una autorización previa. Sin embargo, presenta varias limitaciones que dificultan su adaptación a la economía digital actual.

Frente a estas limitaciones, surge el esquema \textit{SEPA} Request-to-Pay} (SRTP) como una alternativa moderna. El SRTP permite a los beneficiarios enviar solicitudes de pago digitales a los pagadores, quienes pueden aceptarlas, rechazarlas o aplazarlas en tiempo real, utilizando la infraestructura de pagos instantáneos \textit{SEPA (SCT Inst)}.

Este Trabajo de Fin de Grado tiene como objetivo explicar y demostrar el funcionamiento del SRTP como solución a las carencias del SDD. Para ello, se propone el diseño e implementación de un prototipo que simula el ciclo completo de una petición de pago: creación, presentación, decisión, ejecución y cierre. El prototipo se basa en una API desarrollada con un servidor web Flask, que gestiona las interacciones entre los actores del ecosistema SRTP (beneficiarios, pagadores y proveedores de servicios de pago) mediante una arquitectura orientada a eventos y una interfaz web en tiempo real.

\newpage

\selectlanguage{english}
\chapter*{Abstract}
In Spain, bank direct debit, regulated under the \textit{SEPA Direct Debit} (SDD) scheme~\cite{ecb_sepa}, is the predominant method for the collection of recurring payments. This arrangement allows creditors to initiate automatic debits from debtors' accounts once prior authorisation has been granted. Nevertheless, it exhibits several limitations that hinder its adaptation to the current digital economy.

To overcome these limitations, the \textit{SEPA Request-to-Pay} (SRTP) scheme has emerged as a modern alternative. SRTP enables beneficiaries to send digital payment requests to payers, who can accept, reject or defer them in real time by using the \textit{SEPA Instant Credit Transfer} (SCT Inst) infrastructure.

This bachelor thesis aims to explain and demonstrate how SRTP remedies the shortcomings of SDD. With this purpose, it proposes the design and implementation of a prototype that simulates the entire life cycle of a payment request: creation, presentation, decision, execution and closure. The prototype is based on an API implemented with a Flask web server, which manages the interactions among the actors within the SRTP ecosystem (beneficiaries, payers and payment service providers) by means of an event driven architecture and a real time web interface.


# END FILE CONTENTS


# File: frontend/app.js

/* app.js */

let currentActorId = null;
let currentActorRole = null;

// Inicializar la conexión Socket.IO
const socket = io.connect('http://127.0.0.1:5000');

/** LOGIN */
document.getElementById('loginForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const username = document.getElementById('username').value;
  const password = document.getElementById('password').value;

  fetch('http://127.0.0.1:5000/login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ username, password })
  })
  .then(res => res.json())
  .then(data => {
    if (data.error) {
      document.getElementById('loginError').classList.remove('invisible-section');
      document.getElementById('loginError').innerText = data.error;
      return;
    }
    currentActorId = data.actor_id;
    currentActorRole = data.role;

    // Emitir 'join' para unirse a la sala correspondiente
    socket.emit('join', { actor_id: currentActorId });

    // Oculta la sección de login y muestra el contenido
    document.getElementById('loginSection').style.display = 'none';
    document.getElementById('bankContent').classList.remove('invisible-section');
    document.getElementById('mainNavbar').style.display = 'block';

    // Mostrar info en la navbar
    document.getElementById('navbarUserInfo').innerText = data.name + " (" + data.role + ")";
    
    // Cargar la vista principal
    mostrarSeccion('homeDashboard', true);
  })
  .catch(err => console.error(err));
});

/** Función para mostrar secciones */
function mostrarSeccion(sectionId, reloadHome=false) {
  const secciones = ['homeDashboard', 'seccionCuentas', 'seccionTarjetas', 'seccionPerfil', 'seccionRTP'];
  secciones.forEach(s => {
    document.getElementById(s).classList.add('invisible-section');
  });

  document.getElementById(sectionId).classList.remove('invisible-section');
  
  if (sectionId === 'homeDashboard' && reloadHome) {
    cargarHomeDashboard();
  }
  if (sectionId === 'seccionPerfil') {
    cargarPerfil();
  }
  // Agregamos la llamada cuando se muestra la sección RTP
  if (sectionId === 'seccionRTP') {
    mostrarPanelRTPporRol();
  }
  
  // Control del menú inferior
  const bottomMenu = document.getElementById('bottomMenuSquares');
  if (sectionId === 'homeDashboard') {
    const navbarCollapse = document.getElementById('navbarNav');
    if (navbarCollapse.classList.contains('show')) {
      bottomMenu.style.display = 'none';
    } else {
      bottomMenu.style.display = 'flex';
    }
  } else {
    bottomMenu.style.display = 'none';
  }
}

/** cargarHomeDashboard */
function cargarHomeDashboard() {
  fetch(`http://127.0.0.1:5000/profile/${currentActorId}`)
  .then(r => r.json())
  .then(data => {
    if (data.error) {
      console.error("Error al cargar homeDashboard:", data.error);
      return;
    }
    // Formatear el balance
    let balance = data.balance != null ? data.balance : 0;
    let balanceTxt = formatMoney(balance);
    document.getElementById('homeBalanceDisplay').innerText = balanceTxt;

    // IBAN
    let ibanTxt = data.iban ? formatIBAN(data.iban) : 'empty';
    document.getElementById('homeIbanDisplay').innerText = ibanTxt;

    // Nombre
    let nameTxt = data.name ? data.name : 'empty';
    document.getElementById('homeNameDisplay').innerText = nameTxt;

    // Foto
    const homePhoto = document.getElementById('homePhoto');
    if (data.photo_url) {
      homePhoto.src = data.photo_url;
      homePhoto.style.display = 'inline';
    } else {
      homePhoto.style.display = 'none';
    }

    // Ajustar fuente del balance (para números muy grandes)
    adjustFontSize('homeBalanceDisplay', 'balance-circle');

    // Si es payer, mostrar mensaje extra
    const payerMsg = document.getElementById('payerExtraMsg');
    if (currentActorRole === 'payer') {
      payerMsg.classList.remove('invisible-section');
      payerMsg.textContent = "¡Hola! Como payer, aquí puedes gestionar tus solicitudes de pago.";
    } else {
      payerMsg.classList.add('invisible-section');
    }
  })
  .catch(err => console.error(err));
}

/** Formatear dinero con puntos y coma */
function formatMoney(value) {
  let parts = value.toFixed(2).split('.');
  let integerPart = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, '.');
  let decimalPart = parts[1];
  return integerPart + ',' + decimalPart + ' €';
}

/** Formatear IBAN */
function formatIBAN(iban) {
  return iban.replace(/\s+/g, '').replace(/(.{4})/g, '$1 ').trim();
}

/** Ajustar tamaño de fuente dinamicamente para que no se salga del círculo */
function adjustFontSize(elementId, containerId) {
  const element = document.getElementById(elementId);
  const container = document.getElementById(containerId);
  let fontSize = 2.5;
  element.style.fontSize = fontSize + 'rem';
  
  while (
    (element.scrollWidth > container.clientWidth || element.scrollHeight > container.clientHeight) 
    && fontSize > 0.4
  ) {
    fontSize -= 0.1;
    element.style.fontSize = fontSize + 'rem';
  }
}

/** cargarPerfil */
function cargarPerfil() {
  fetch(`http://127.0.0.1:5000/profile/${currentActorId}`)
  .then(r => r.json())
  .then(data => {
    if (data.error) {
      console.error("Error al cargar perfil:", data.error);
      return;
    }
    const photo = document.getElementById('profilePhoto');
    if (data.photo_url) {
      photo.src = data.photo_url;
      photo.style.display = 'inline';
    } else {
      photo.style.display = 'none';
    }
    document.getElementById('profileIban').innerText = data.iban || '(sin IBAN)';
    document.getElementById('profileBalance').innerText = data.balance != null ? data.balance : 0;
    document.getElementById('editPhoto').value = data.photo_url || '';
    document.getElementById('editIban').value = data.iban || '';
    document.getElementById('editBalance').value = data.balance != null ? data.balance : 0;
  })
  .catch(err => console.error(err));
}

/** Actualizar perfil */
document.getElementById('profileEditForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const newPhoto = document.getElementById('editPhoto').value;
  const newIban = document.getElementById('editIban').value;
  const newBal = parseFloat(document.getElementById('editBalance').value);

  const data = {
    actor_id: currentActorId,
    photo_url: newPhoto,
    iban: newIban,
    balance: newBal
  };

  fetch('http://127.0.0.1:5000/profile', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  })
  .then(r => r.json())
  .then(resp => {
    const msgDiv = document.getElementById('profileMsg');
    msgDiv.classList.remove('invisible-section');
    if (resp.error) {
      msgDiv.innerText = resp.error;
    } else {
      msgDiv.innerText = "Perfil actualizado correctamente";
      cargarPerfil();
    }
  })
  .catch(err => console.error(err));
});

/* Controlar visibilidad del menú inferior al expandir/contraer navbar */
document.addEventListener('shown.bs.collapse', function(e) {
  if(e.target.id === "navbarNav") {
    const bottomMenu = document.getElementById('bottomMenuSquares');
    if (!document.getElementById('homeDashboard').classList.contains('invisible-section')) {
      bottomMenu.style.display = 'none';
    }
  }
});
document.addEventListener('hidden.bs.collapse', function(e) {
  if(e.target.id === "navbarNav") {
    const bottomMenu = document.getElementById('bottomMenuSquares');
    if (!document.getElementById('homeDashboard').classList.contains('invisible-section')) {
      bottomMenu.style.display = 'flex';
    }
  }
});


# END FILE CONTENTS


# File: backend/services.py

from models import db, RTP, Actor
from utils import cambiar_estado_rtp, rechazar_rtp, validar_iban
from ext_socketio import socketio, emit


def crear_rtp_service(data):
    beneficiary_id = data.get('actor_id')
    payer_iban = data.get('payer_iban')
    amount = data.get('amount')

    # 1) Beneficiario
    beneficiary = Actor.query.get(beneficiary_id)
    if not beneficiary or beneficiary.role != 'beneficiary':
        return {"error": "El actor no es beneficiario o no existe"}

    # 2) PSP del Beneficiario
    if not beneficiary.psp_id:
        return {"error": "El beneficiario no tiene PSP asociado"}
    psp_benef_id = beneficiary.psp_id

    # 3) Hallar el pagador por su IBAN
    payer = Actor.query.filter_by(iban=payer_iban, role='payer').first()
    if not payer:
        return {"error": "No se encontró un pagador con ese IBAN"}

    # 4) PSP del pagador
    if not payer.psp_id:
        return {"error": "El pagador no tiene PSP asociado"}
    psp_payer_id = payer.psp_id

    # Crear el RTP
    nuevo_rtp = RTP(
        iban=payer_iban,
        amount=amount,
        beneficiary_id=beneficiary.id,
        psp_beneficiary_id=psp_benef_id,
        psp_payer_id=psp_payer_id,
        payer_id=payer.id
    )
    db.session.add(nuevo_rtp)
    db.session.commit()

    socketio.emit('rtp_created', nuevo_rtp.to_dict(), room=f'psp_beneficiary_{psp_benef_id}')

    return {
        "message": "RTP creado correctamente",
        "id": nuevo_rtp.id,
        #"beneficiary_id": beneficiary.id,
        #"psp_beneficiary_id": psp_benef_id,
        #"payer_id": payer.id,
        #"psp_payer_id": psp_payer_id
    }

def validar_beneficiario_service(rtp_id):
    rtp_obj = RTP.query.get(rtp_id)
    if not rtp_obj:
        return {"error": "RTP no encontrado"}
    result = cambiar_estado_rtp(db, rtp_obj, "validado-beneficiario")

    socketio.emit('rtp_validated_beneficiary', rtp_obj.to_dict(), room=f'psp_beneficiary_{rtp_obj.psp_beneficiary_id}')

    return result


def enrutar_rtp_service(rtp_id):
    rtp_obj = RTP.query.get(rtp_id)
    if not rtp_obj:
        return {"error": "RTP no encontrado"}
    result = cambiar_estado_rtp(db, rtp_obj, "enrutado")

    socketio.emit('rtp_routed', rtp_obj.to_dict(), room=f'psp_payer_{rtp_obj.psp_payer_id}')

    return result

def validar_payer_service(rtp_id):
    """
    Validación por el PSP del pagador.
    1) Si el payer no tiene saldo suficiente, forzamos 'rechazado' (o 'cancelado')
    2) Si sí tiene saldo, seguimos con 'validado_payer'
    """
    rtp_obj = RTP.query.get(rtp_id)
    if not rtp_obj:
        return {"error": "RTP no encontrado"}

    # Busco el Actor que sea el payer:
    from models import Actor
    payer_actor = Actor.query.get(rtp_obj.payer_id)
    if not payer_actor:
        return {"error": "El payer asignado a este RTP no existe"}

    # Verifico fondos
    if payer_actor.balance < rtp_obj.amount:
        # Forzamos el rechazo
        return rechazar_rtp(db, rtp_obj, "Saldo insuficiente (PSP forzó cancelación)")

    # Si hay saldo suficiente, marcamos 'validado_payer'
    result = cambiar_estado_rtp(db, rtp_obj, "validado_payer")

    socketio.emit('rtp_validated_payer', rtp_obj.to_dict(), room=f'payer_{rtp_obj.payer_id}')

    return result


def decision_payer_service(rtp_id, data):
    """
    Cuando el pagador da su decisión final ('aceptado' o 'rechazado')
    1) Si 'aceptado', restamos el dinero de su cuenta.
    """
    rtp_obj = RTP.query.get(rtp_id)
    if not rtp_obj:
        return {"error": "RTP no encontrado"}
    
    decision = data.get('decision')
    if decision not in ["aceptado", "rechazado"]:
        return {"error": "Decisión no válida"}

    # Si es 'aceptado', restamos el dinero
    if decision == "aceptado":
        from models import Actor
        payer_actor = Actor.query.get(rtp_obj.payer_id)
        if not payer_actor:
            return {"error": "El payer asignado no existe"}

        if payer_actor.balance < rtp_obj.amount:
            return rechazar_rtp(db, rtp_obj, "Saldo insuficiente en el último momento")

        payer_actor.balance -= rtp_obj.amount
        db.session.commit()

    result = cambiar_estado_rtp(db, rtp_obj, decision)
    
    # Notificar al beneficiario que ya se tomó la decisión en el RTP
    socketio.emit('rtp_decision', rtp_obj.to_dict(), room=f'beneficiary_{rtp_obj.beneficiary_id}')
    
    return result



# END FILE CONTENTS


# File: MemoriaTFG/main.bcf

<?xml version="1.0" encoding="UTF-8"?>
<bcf:controlfile version="3.7" bltxversion="3.14" xmlns:bcf="https://sourceforge.net/projects/biblatex">
  <!-- BIBER OPTIONS -->
  <bcf:options component="biber" type="global">
    <bcf:option type="singlevalued">
      <bcf:key>output_encoding</bcf:key>
      <bcf:value>utf8</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>input_encoding</bcf:key>
      <bcf:value>utf8</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>debug</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>mincrossrefs</bcf:key>
      <bcf:value>2</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>minxrefs</bcf:key>
      <bcf:value>2</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>sortcase</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>sortupper</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
  </bcf:options>
  <!-- BIBLATEX OPTIONS -->
  <!-- GLOBAL -->
  <bcf:options component="biblatex" type="global">
    <bcf:option type="singlevalued">
      <bcf:key>alphaothers</bcf:key>
      <bcf:value>+</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>labelalpha</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="multivalued">
      <bcf:key>labelnamespec</bcf:key>
      <bcf:value order="1">shortauthor</bcf:value>
      <bcf:value order="2">author</bcf:value>
      <bcf:value order="3">shorteditor</bcf:value>
      <bcf:value order="4">editor</bcf:value>
      <bcf:value order="5">translator</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>labeltitle</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="multivalued">
      <bcf:key>labeltitlespec</bcf:key>
      <bcf:value order="1">shorttitle</bcf:value>
      <bcf:value order="2">title</bcf:value>
      <bcf:value order="3">maintitle</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>labeltitleyear</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>labeldateparts</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="multivalued">
      <bcf:key>labeldatespec</bcf:key>
      <bcf:value order="1" type="field">date</bcf:value>
      <bcf:value order="2" type="field">year</bcf:value>
      <bcf:value order="3" type="field">eventdate</bcf:value>
      <bcf:value order="4" type="field">origdate</bcf:value>
      <bcf:value order="5" type="field">urldate</bcf:value>
      <bcf:value order="6" type="string">nodate</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>julian</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>gregorianstart</bcf:key>
      <bcf:value>1582-10-15</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>maxalphanames</bcf:key>
      <bcf:value>3</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>maxbibnames</bcf:key>
      <bcf:value>3</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>maxcitenames</bcf:key>
      <bcf:value>3</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>maxsortnames</bcf:key>
      <bcf:value>3</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>maxitems</bcf:key>
      <bcf:value>3</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>minalphanames</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>minbibnames</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>mincitenames</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>minsortnames</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>minitems</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>nohashothers</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>noroman</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>nosortothers</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>singletitle</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>skipbib</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>skipbiblist</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>skiplab</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>sortalphaothers</bcf:key>
      <bcf:value>+</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>sortlocale</bcf:key>
      <bcf:value>english</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>sortingtemplatename</bcf:key>
      <bcf:value>nyt</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>sortsets</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>uniquelist</bcf:key>
      <bcf:value>false</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>uniquename</bcf:key>
      <bcf:value>false</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>uniqueprimaryauthor</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>uniquetitle</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>uniquebaretitle</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>uniquework</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useprefix</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useafterword</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useannotator</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useauthor</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>usebookauthor</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>usecommentator</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useeditor</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useeditora</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useeditorb</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useeditorc</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useforeword</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useholder</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useintroduction</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>usenamea</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>usenameb</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>usenamec</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>usetranslator</bcf:key>
      <bcf:value>0</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useshortauthor</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
    <bcf:option type="singlevalued">
      <bcf:key>useshorteditor</bcf:key>
      <bcf:value>1</bcf:value>
    </bcf:option>
  </bcf:options>
  <!-- BIBLATEX OPTION SCOPE -->
  <bcf:optionscope type="GLOBAL">
    <bcf:option datatype="xml">datamodel</bcf:option>
    <bcf:option datatype="xml">labelalphanametemplate</bcf:option>
    <bcf:option datatype="xml">labelalphatemplate</bcf:option>
    <bcf:option datatype="xml">inheritance</bcf:option>
    <bcf:option datatype="xml">translit</bcf:option>
    <bcf:option datatype="xml">uniquenametemplate</bcf:option>
    <bcf:option datatype="xml">sortingnamekeytemplate</bcf:option>
    <bcf:option datatype="xml">sortingtemplate</bcf:option>
    <bcf:option datatype="xml">extradatespec</bcf:option>
    <bcf:option datatype="xml">labelnamespec</bcf:option>
    <bcf:option datatype="xml">labeltitlespec</bcf:option>
    <bcf:option datatype="xml">labeldatespec</bcf:option>
    <bcf:option datatype="string">controlversion</bcf:option>
    <bcf:option datatype="string">alphaothers</bcf:option>
    <bcf:option datatype="string">sortalphaothers</bcf:option>
    <bcf:option datatype="string">presort</bcf:option>
    <bcf:option datatype="string">texencoding</bcf:option>
    <bcf:option datatype="string">bibencoding</bcf:option>
    <bcf:option datatype="string">sortingtemplatename</bcf:option>
    <bcf:option datatype="string">sortlocale</bcf:option>
    <bcf:option datatype="string">language</bcf:option>
    <bcf:option datatype="string">autolang</bcf:option>
    <bcf:option datatype="string">indexing</bcf:option>
    <bcf:option datatype="string">hyperref</bcf:option>
    <bcf:option datatype="string">backrefsetstyle</bcf:option>
    <bcf:option datatype="string">block</bcf:option>
    <bcf:option datatype="string">pagetracker</bcf:option>
    <bcf:option datatype="string">citecounter</bcf:option>
    <bcf:option datatype="string">citetracker</bcf:option>
    <bcf:option datatype="string">ibidtracker</bcf:option>
    <bcf:option datatype="string">idemtracker</bcf:option>
    <bcf:option datatype="string">opcittracker</bcf:option>
    <bcf:option datatype="string">loccittracker</bcf:option>
    <bcf:option datatype="string">labeldate</bcf:option>
    <bcf:option datatype="string">labeltime</bcf:option>
    <bcf:option datatype="string">dateera</bcf:option>
    <bcf:option datatype="string">date</bcf:option>
    <bcf:option datatype="string">time</bcf:option>
    <bcf:option datatype="string">eventdate</bcf:option>
    <bcf:option datatype="string">eventtime</bcf:option>
    <bcf:option datatype="string">origdate</bcf:option>
    <bcf:option datatype="string">origtime</bcf:option>
    <bcf:option datatype="string">urldate</bcf:option>
    <bcf:option datatype="string">urltime</bcf:option>
    <bcf:option datatype="string">alldatesusetime</bcf:option>
    <bcf:option datatype="string">alldates</bcf:option>
    <bcf:option datatype="string">alltimes</bcf:option>
    <bcf:option datatype="string">gregorianstart</bcf:option>
    <bcf:option datatype="string">autocite</bcf:option>
    <bcf:option datatype="string">notetype</bcf:option>
    <bcf:option datatype="string">uniquelist</bcf:option>
    <bcf:option datatype="string">uniquename</bcf:option>
    <bcf:option datatype="string">refsection</bcf:option>
    <bcf:option datatype="string">refsegment</bcf:option>
    <bcf:option datatype="string">citereset</bcf:option>
    <bcf:option datatype="string">sortlos</bcf:option>
    <bcf:option datatype="string">babel</bcf:option>
    <bcf:option datatype="string">datelabel</bcf:option>
    <bcf:option datatype="string">backrefstyle</bcf:option>
    <bcf:option datatype="string">arxiv</bcf:option>
    <bcf:option datatype="boolean">familyinits</bcf:option>
    <bcf:option datatype="boolean">giveninits</bcf:option>
    <bcf:option datatype="boolean">prefixinits</bcf:option>
    <bcf:option datatype="boolean">suffixinits</bcf:option>
    <bcf:option datatype="boolean">useafterword</bcf:option>
    <bcf:option datatype="boolean">useannotator</bcf:option>
    <bcf:option datatype="boolean">useauthor</bcf:option>
    <bcf:option datatype="boolean">usebookauthor</bcf:option>
    <bcf:option datatype="boolean">usecommentator</bcf:option>
    <bcf:option datatype="boolean">useeditor</bcf:option>
    <bcf:option datatype="boolean">useeditora</bcf:option>
    <bcf:option datatype="boolean">useeditorb</bcf:option>
    <bcf:option datatype="boolean">useeditorc</bcf:option>
    <bcf:option datatype="boolean">useforeword</bcf:option>
    <bcf:option datatype="boolean">useholder</bcf:option>
    <bcf:option datatype="boolean">useintroduction</bcf:option>
    <bcf:option datatype="boolean">usenamea</bcf:option>
    <bcf:option datatype="boolean">usenameb</bcf:option>
    <bcf:option datatype="boolean">usenamec</bcf:option>
    <bcf:option datatype="boolean">usetranslator</bcf:option>
    <bcf:option datatype="boolean">useshortauthor</bcf:option>
    <bcf:option datatype="boolean">useshorteditor</bcf:option>
    <bcf:option datatype="boolean">debug</bcf:option>
    <bcf:option datatype="boolean">loadfiles</bcf:option>
    <bcf:option datatype="boolean">safeinputenc</bcf:option>
    <bcf:option datatype="boolean">sortcase</bcf:option>
    <bcf:option datatype="boolean">sortupper</bcf:option>
    <bcf:option datatype="boolean">terseinits</bcf:option>
    <bcf:option datatype="boolean">abbreviate</bcf:option>
    <bcf:option datatype="boolean">dateabbrev</bcf:option>
    <bcf:option datatype="boolean">clearlang</bcf:option>
    <bcf:option datatype="boolean">sortcites</bcf:option>
    <bcf:option datatype="boolean">sortsets</bcf:option>
    <bcf:option datatype="boolean">backref</bcf:option>
    <bcf:option datatype="boolean">parentracker</bcf:option>
    <bcf:option datatype="boolean">labeldateusetime</bcf:option>
    <bcf:option datatype="boolean">datecirca</bcf:option>
    <bcf:option datatype="boolean">dateuncertain</bcf:option>
    <bcf:option datatype="boolean">dateusetime</bcf:option>
    <bcf:option datatype="boolean">eventdateusetime</bcf:option>
    <bcf:option datatype="boolean">origdateusetime</bcf:option>
    <bcf:option datatype="boolean">urldateusetime</bcf:option>
    <bcf:option datatype="boolean">julian</bcf:option>
    <bcf:option datatype="boolean">datezeros</bcf:option>
    <bcf:option datatype="boolean">timezeros</bcf:option>
    <bcf:option datatype="boolean">timezones</bcf:option>
    <bcf:option datatype="boolean">seconds</bcf:option>
    <bcf:option datatype="boolean">autopunct</bcf:option>
    <bcf:option datatype="boolean">punctfont</bcf:option>
    <bcf:option datatype="boolean">labelnumber</bcf:option>
    <bcf:option datatype="boolean">labelalpha</bcf:option>
    <bcf:option datatype="boolean">labeltitle</bcf:option>
    <bcf:option datatype="boolean">labeltitleyear</bcf:option>
    <bcf:option datatype="boolean">labeldateparts</bcf:option>
    <bcf:option datatype="boolean">nohashothers</bcf:option>
    <bcf:option datatype="boolean">nosortothers</bcf:option>
    <bcf:option datatype="boolean">noroman</bcf:option>
    <bcf:option datatype="boolean">singletitle</bcf:option>
    <bcf:option datatype="boolean">uniquetitle</bcf:option>
    <bcf:option datatype="boolean">uniquebaretitle</bcf:option>
    <bcf:option datatype="boolean">uniquework</bcf:option>
    <bcf:option datatype="boolean">uniqueprimaryauthor</bcf:option>
    <bcf:option datatype="boolean">defernumbers</bcf:option>
    <bcf:option datatype="boolean">locallabelwidth</bcf:option>
    <bcf:option datatype="boolean">bibwarn</bcf:option>
    <bcf:option datatype="boolean">useprefix</bcf:option>
    <bcf:option datatype="boolean">skipbib</bcf:option>
    <bcf:option datatype="boolean">skipbiblist</bcf:option>
    <bcf:option datatype="boolean">skiplab</bcf:option>
    <bcf:option datatype="boolean">dataonly</bcf:option>
    <bcf:option datatype="boolean">defernums</bcf:option>
    <bcf:option datatype="boolean">firstinits</bcf:option>
    <bcf:option datatype="boolean">sortfirstinits</bcf:option>
    <bcf:option datatype="boolean">sortgiveninits</bcf:option>
    <bcf:option datatype="boolean">labelyear</bcf:option>
    <bcf:option datatype="boolean">isbn</bcf:option>
    <bcf:option datatype="boolean">url</bcf:option>
    <bcf:option datatype="boolean">doi</bcf:option>
    <bcf:option datatype="boolean">eprint</bcf:option>
    <bcf:option datatype="boolean">related</bcf:option>
    <bcf:option datatype="boolean">subentry</bcf:option>
    <bcf:option datatype="integer">mincrossrefs</bcf:option>
    <bcf:option datatype="integer">minxrefs</bcf:option>
    <bcf:option datatype="integer">maxnames</bcf:option>
    <bcf:option datatype="integer">minnames</bcf:option>
    <bcf:option datatype="integer">maxbibnames</bcf:option>
    <bcf:option datatype="integer">minbibnames</bcf:option>
    <bcf:option datatype="integer">maxcitenames</bcf:option>
    <bcf:option datatype="integer">mincitenames</bcf:option>
    <bcf:option datatype="integer">maxsortnames</bcf:option>
    <bcf:option datatype="integer">minsortnames</bcf:option>
    <bcf:option datatype="integer">maxitems</bcf:option>
    <bcf:option datatype="integer">minitems</bcf:option>
    <bcf:option datatype="integer">maxalphanames</bcf:option>
    <bcf:option datatype="integer">minalphanames</bcf:option>
    <bcf:option datatype="integer">maxparens</bcf:option>
    <bcf:option datatype="integer">dateeraauto</bcf:option>
  </bcf:optionscope>
  <bcf:optionscope type="ENTRYTYPE">
    <bcf:option datatype="string">alphaothers</bcf:option>
    <bcf:option datatype="string">sortalphaothers</bcf:option>
    <bcf:option datatype="string">presort</bcf:option>
    <bcf:option datatype="string">indexing</bcf:option>
    <bcf:option datatype="string">citetracker</bcf:option>
    <bcf:option datatype="string">ibidtracker</bcf:option>
    <bcf:option datatype="string">idemtracker</bcf:option>
    <bcf:option datatype="string">opcittracker</bcf:option>
    <bcf:option datatype="string">loccittracker</bcf:option>
    <bcf:option datatype="string">uniquelist</bcf:option>
    <bcf:option datatype="string">uniquename</bcf:option>
    <bcf:option datatype="boolean">familyinits</bcf:option>
    <bcf:option datatype="boolean">giveninits</bcf:option>
    <bcf:option datatype="boolean">prefixinits</bcf:option>
    <bcf:option datatype="boolean">suffixinits</bcf:option>
    <bcf:option datatype="boolean">useafterword</bcf:option>
    <bcf:option datatype="boolean">useannotator</bcf:option>
    <bcf:option datatype="boolean">useauthor</bcf:option>
    <bcf:option datatype="boolean">usebookauthor</bcf:option>
    <bcf:option datatype="boolean">usecommentator</bcf:option>
    <bcf:option datatype="boolean">useeditor</bcf:option>
    <bcf:option datatype="boolean">useeditora</bcf:option>
    <bcf:option datatype="boolean">useeditorb</bcf:option>
    <bcf:option datatype="boolean">useeditorc</bcf:option>
    <bcf:option datatype="boolean">useforeword</bcf:option>
    <bcf:option datatype="boolean">useholder</bcf:option>
    <bcf:option datatype="boolean">useintroduction</bcf:option>
    <bcf:option datatype="boolean">usenamea</bcf:option>
    <bcf:option datatype="boolean">usenameb</bcf:option>
    <bcf:option datatype="boolean">usenamec</bcf:option>
    <bcf:option datatype="boolean">usetranslator</bcf:option>
    <bcf:option datatype="boolean">useshortauthor</bcf:option>
    <bcf:option datatype="boolean">useshorteditor</bcf:option>
    <bcf:option datatype="boolean">terseinits</bcf:option>
    <bcf:option datatype="boolean">abbreviate</bcf:option>
    <bcf:option datatype="boolean">dateabbrev</bcf:option>
    <bcf:option datatype="boolean">clearlang</bcf:option>
    <bcf:option datatype="boolean">labelnumber</bcf:option>
    <bcf:option datatype="boolean">labelalpha</bcf:option>
    <bcf:option datatype="boolean">labeltitle</bcf:option>
    <bcf:option datatype="boolean">labeltitleyear</bcf:option>
    <bcf:option datatype="boolean">labeldateparts</bcf:option>
    <bcf:option datatype="boolean">nohashothers</bcf:option>
    <bcf:option datatype="boolean">nosortothers</bcf:option>
    <bcf:option datatype="boolean">noroman</bcf:option>
    <bcf:option datatype="boolean">singletitle</bcf:option>
    <bcf:option datatype="boolean">uniquetitle</bcf:option>
    <bcf:option datatype="boolean">uniquebaretitle</bcf:option>
    <bcf:option datatype="boolean">uniquework</bcf:option>
    <bcf:option datatype="boolean">uniqueprimaryauthor</bcf:option>
    <bcf:option datatype="boolean">useprefix</bcf:option>
    <bcf:option datatype="boolean">skipbib</bcf:option>
    <bcf:option datatype="boolean">skipbiblist</bcf:option>
    <bcf:option datatype="boolean">skiplab</bcf:option>
    <bcf:option datatype="boolean">dataonly</bcf:option>
    <bcf:option datatype="boolean">skiplos</bcf:option>
    <bcf:option datatype="boolean">labelyear</bcf:option>
    <bcf:option datatype="boolean">isbn</bcf:option>
    <bcf:option datatype="boolean">url</bcf:option>
    <bcf:option datatype="boolean">doi</bcf:option>
    <bcf:option datatype="boolean">eprint</bcf:option>
    <bcf:option datatype="boolean">related</bcf:option>
    <bcf:option datatype="boolean">subentry</bcf:option>
    <bcf:option datatype="xml">labelalphatemplate</bcf:option>
    <bcf:option datatype="xml">translit</bcf:option>
    <bcf:option datatype="xml">sortexclusion</bcf:option>
    <bcf:option datatype="xml">sortinclusion</bcf:option>
    <bcf:option datatype="xml">labelnamespec</bcf:option>
    <bcf:option datatype="xml">labeltitlespec</bcf:option>
    <bcf:option datatype="xml">labeldatespec</bcf:option>
    <bcf:option datatype="integer">maxnames</bcf:option>
    <bcf:option datatype="integer">minnames</bcf:option>
    <bcf:option datatype="integer">maxbibnames</bcf:option>
    <bcf:option datatype="integer">minbibnames</bcf:option>
    <bcf:option datatype="integer">maxcitenames</bcf:option>
    <bcf:option datatype="integer">mincitenames</bcf:option>
    <bcf:option datatype="integer">maxsortnames</bcf:option>
    <bcf:option datatype="integer">minsortnames</bcf:option>
    <bcf:option datatype="integer">maxitems</bcf:option>
    <bcf:option datatype="integer">minitems</bcf:option>
    <bcf:option datatype="integer">maxalphanames</bcf:option>
    <bcf:option datatype="integer">minalphanames</bcf:option>
  </bcf:optionscope>
  <bcf:optionscope type="ENTRY">
    <bcf:option datatype="string">noinherit</bcf:option>
    <bcf:option datatype="string" backendin="sortingnamekeytemplatename,uniquenametemplatename,labelalphanametemplatename">nametemplates</bcf:option>
    <bcf:option datatype="string" backendout="1">labelalphanametemplatename</bcf:option>
    <bcf:option datatype="string" backendout="1">uniquenametemplatename</bcf:option>
    <bcf:option datatype="string" backendout="1">sortingnamekeytemplatename</bcf:option>
    <bcf:option datatype="string">presort</bcf:option>
    <bcf:option datatype="string" backendout="1">indexing</bcf:option>
    <bcf:option datatype="string" backendout="1">citetracker</bcf:option>
    <bcf:option datatype="string" backendout="1">ibidtracker</bcf:option>
    <bcf:option datatype="string" backendout="1">idemtracker</bcf:option>
    <bcf:option datatype="string" backendout="1">opcittracker</bcf:option>
    <bcf:option datatype="string" backendout="1">loccittracker</bcf:option>
    <bcf:option datatype="string">uniquelist</bcf:option>
    <bcf:option datatype="string">uniquename</bcf:option>
    <bcf:option datatype="boolean" backendout="1">familyinits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">giveninits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">prefixinits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">suffixinits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useafterword</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useannotator</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useauthor</bcf:option>
    <bcf:option datatype="boolean" backendout="1">usebookauthor</bcf:option>
    <bcf:option datatype="boolean" backendout="1">usecommentator</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useeditor</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useeditora</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useeditorb</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useeditorc</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useforeword</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useholder</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useintroduction</bcf:option>
    <bcf:option datatype="boolean" backendout="1">usenamea</bcf:option>
    <bcf:option datatype="boolean" backendout="1">usenameb</bcf:option>
    <bcf:option datatype="boolean" backendout="1">usenamec</bcf:option>
    <bcf:option datatype="boolean" backendout="1">usetranslator</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useshortauthor</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useshorteditor</bcf:option>
    <bcf:option datatype="boolean" backendout="1">terseinits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">abbreviate</bcf:option>
    <bcf:option datatype="boolean" backendout="1">dateabbrev</bcf:option>
    <bcf:option datatype="boolean" backendout="1">clearlang</bcf:option>
    <bcf:option datatype="boolean" backendout="1">labelnumber</bcf:option>
    <bcf:option datatype="boolean" backendout="1">labelalpha</bcf:option>
    <bcf:option datatype="boolean" backendout="1">labeltitle</bcf:option>
    <bcf:option datatype="boolean" backendout="1">labeltitleyear</bcf:option>
    <bcf:option datatype="boolean" backendout="1">labeldateparts</bcf:option>
    <bcf:option datatype="boolean">nohashothers</bcf:option>
    <bcf:option datatype="boolean">nosortothers</bcf:option>
    <bcf:option datatype="boolean">noroman</bcf:option>
    <bcf:option datatype="boolean">singletitle</bcf:option>
    <bcf:option datatype="boolean">uniquetitle</bcf:option>
    <bcf:option datatype="boolean">uniquebaretitle</bcf:option>
    <bcf:option datatype="boolean">uniquework</bcf:option>
    <bcf:option datatype="boolean">uniqueprimaryauthor</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useprefix</bcf:option>
    <bcf:option datatype="boolean" backendout="1">skipbib</bcf:option>
    <bcf:option datatype="boolean" backendout="1">skipbiblist</bcf:option>
    <bcf:option datatype="boolean" backendout="1">skiplab</bcf:option>
    <bcf:option datatype="boolean" backendin="uniquename=false,uniquelist=false,skipbib=true,skipbiblist=true,skiplab=true">dataonly</bcf:option>
    <bcf:option datatype="boolean" backendout="1">skiplos</bcf:option>
    <bcf:option datatype="boolean" backendout="1">isbn</bcf:option>
    <bcf:option datatype="boolean" backendout="1">url</bcf:option>
    <bcf:option datatype="boolean" backendout="1">doi</bcf:option>
    <bcf:option datatype="boolean" backendout="1">eprint</bcf:option>
    <bcf:option datatype="boolean" backendout="1">related</bcf:option>
    <bcf:option datatype="boolean" backendout="1">subentry</bcf:option>
    <bcf:option datatype="integer" backendin="maxcitenames,maxbibnames,maxsortnames">maxnames</bcf:option>
    <bcf:option datatype="integer" backendin="mincitenames,minbibnames,minsortnames">minnames</bcf:option>
    <bcf:option datatype="integer" backendout="1">maxbibnames</bcf:option>
    <bcf:option datatype="integer" backendout="1">minbibnames</bcf:option>
    <bcf:option datatype="integer" backendout="1">maxcitenames</bcf:option>
    <bcf:option datatype="integer" backendout="1">mincitenames</bcf:option>
    <bcf:option datatype="integer" backendout="1">maxsortnames</bcf:option>
    <bcf:option datatype="integer" backendout="1">minsortnames</bcf:option>
    <bcf:option datatype="integer" backendout="1">maxitems</bcf:option>
    <bcf:option datatype="integer" backendout="1">minitems</bcf:option>
    <bcf:option datatype="integer" backendout="1">maxalphanames</bcf:option>
    <bcf:option datatype="integer" backendout="1">minalphanames</bcf:option>
  </bcf:optionscope>
  <bcf:optionscope type="NAMELIST">
    <bcf:option datatype="string" backendin="sortingnamekeytemplatename,uniquenametemplatename,labelalphanametemplatename">nametemplates</bcf:option>
    <bcf:option datatype="string" backendout="1">labelalphanametemplatename</bcf:option>
    <bcf:option datatype="string" backendout="1">uniquenametemplatename</bcf:option>
    <bcf:option datatype="string" backendout="1">sortingnamekeytemplatename</bcf:option>
    <bcf:option datatype="string">uniquelist</bcf:option>
    <bcf:option datatype="string">uniquename</bcf:option>
    <bcf:option datatype="boolean" backendout="1">familyinits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">giveninits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">prefixinits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">suffixinits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">terseinits</bcf:option>
    <bcf:option datatype="boolean">nohashothers</bcf:option>
    <bcf:option datatype="boolean">nosortothers</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useprefix</bcf:option>
  </bcf:optionscope>
  <bcf:optionscope type="NAME">
    <bcf:option datatype="string" backendin="sortingnamekeytemplatename,uniquenametemplatename,labelalphanametemplatename">nametemplates</bcf:option>
    <bcf:option datatype="string" backendout="1">labelalphanametemplatename</bcf:option>
    <bcf:option datatype="string" backendout="1">uniquenametemplatename</bcf:option>
    <bcf:option datatype="string" backendout="1">sortingnamekeytemplatename</bcf:option>
    <bcf:option datatype="string">uniquename</bcf:option>
    <bcf:option datatype="boolean" backendout="1">familyinits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">giveninits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">prefixinits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">suffixinits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">terseinits</bcf:option>
    <bcf:option datatype="boolean" backendout="1">useprefix</bcf:option>
  </bcf:optionscope>
  <!-- DATAFIELDSETS -->
  <bcf:datafieldset name="setnames">
    <bcf:member datatype="name" fieldtype="list"/>
  </bcf:datafieldset>
  <bcf:datafieldset name="settitles">
    <bcf:member field="title"/>
    <bcf:member field="booktitle"/>
    <bcf:member field="eventtitle"/>
    <bcf:member field="issuetitle"/>
    <bcf:member field="journaltitle"/>
    <bcf:member field="maintitle"/>
    <bcf:member field="origtitle"/>
  </bcf:datafieldset>
  <!-- SOURCEMAP -->
  <bcf:sourcemap>
    <bcf:maps datatype="bibtex" level="driver">
      <bcf:map>
        <bcf:map_step map_field_set="day" map_null="1"/>
      </bcf:map>
      <bcf:map>
        <bcf:map_step map_type_source="conference" map_type_target="inproceedings"/>
        <bcf:map_step map_type_source="electronic" map_type_target="online"/>
        <bcf:map_step map_type_source="www" map_type_target="online"/>
      </bcf:map>
      <bcf:map>
        <bcf:map_step map_type_source="mastersthesis" map_type_target="thesis" map_final="1"/>
        <bcf:map_step map_field_set="type" map_field_value="mathesis"/>
      </bcf:map>
      <bcf:map>
        <bcf:map_step map_type_source="phdthesis" map_type_target="thesis" map_final="1"/>
        <bcf:map_step map_field_set="type" map_field_value="phdthesis"/>
      </bcf:map>
      <bcf:map>
        <bcf:map_step map_type_source="techreport" map_type_target="report" map_final="1"/>
        <bcf:map_step map_field_set="type" map_field_value="techreport"/>
      </bcf:map>
      <bcf:map>
        <bcf:map_step map_field_source="hyphenation" map_field_target="langid"/>
        <bcf:map_step map_field_source="address" map_field_target="location"/>
        <bcf:map_step map_field_source="school" map_field_target="institution"/>
        <bcf:map_step map_field_source="annote" map_field_target="annotation"/>
        <bcf:map_step map_field_source="archiveprefix" map_field_target="eprinttype"/>
        <bcf:map_step map_field_source="journal" map_field_target="journaltitle"/>
        <bcf:map_step map_field_source="primaryclass" map_field_target="eprintclass"/>
        <bcf:map_step map_field_source="key" map_field_target="sortkey"/>
        <bcf:map_step map_field_source="pdf" map_field_target="file"/>
      </bcf:map>
    </bcf:maps>
  </bcf:sourcemap>
  <!-- LABELALPHA NAME TEMPLATE -->
  <bcf:labelalphanametemplate name="global">
    <bcf:namepart order="1" use="1" pre="1" substring_width="1" substring_compound="1">prefix</bcf:namepart>
    <bcf:namepart order="2">family</bcf:namepart>
  </bcf:labelalphanametemplate>
  <!-- LABELALPHA TEMPLATE -->
  <bcf:labelalphatemplate type="global">
    <bcf:labelelement order="1">
      <bcf:labelpart final="1">shorthand</bcf:labelpart>
      <bcf:labelpart>label</bcf:labelpart>
      <bcf:labelpart substring_width="3" substring_side="left" ifnames="1">labelname</bcf:labelpart>
      <bcf:labelpart substring_width="1" substring_side="left">labelname</bcf:labelpart>
    </bcf:labelelement>
    <bcf:labelelement order="2">
      <bcf:labelpart substring_width="2" substring_side="right">year</bcf:labelpart>
    </bcf:labelelement>
  </bcf:labelalphatemplate>
  <!-- EXTRADATE -->
  <bcf:extradatespec>
    <bcf:scope>
      <bcf:field order="1">labelyear</bcf:field>
      <bcf:field order="2">year</bcf:field>
    </bcf:scope>
  </bcf:extradatespec>
  <!-- INHERITANCE -->
  <bcf:inheritance>
    <bcf:defaults inherit_all="true" override_target="false">
    </bcf:defaults>
    <bcf:inherit>
      <bcf:type_pair source="mvbook" target="inbook"/>
      <bcf:type_pair source="mvbook" target="bookinbook"/>
      <bcf:type_pair source="mvbook" target="suppbook"/>
      <bcf:type_pair source="book" target="inbook"/>
      <bcf:type_pair source="book" target="bookinbook"/>
      <bcf:type_pair source="book" target="suppbook"/>
      <bcf:field source="author" target="author"/>
      <bcf:field source="author" target="bookauthor"/>
    </bcf:inherit>
    <bcf:inherit>
      <bcf:type_pair source="mvbook" target="book"/>
      <bcf:type_pair source="mvbook" target="inbook"/>
      <bcf:type_pair source="mvbook" target="bookinbook"/>
      <bcf:type_pair source="mvbook" target="suppbook"/>
      <bcf:field source="title" target="maintitle"/>
      <bcf:field source="subtitle" target="mainsubtitle"/>
      <bcf:field source="titleaddon" target="maintitleaddon"/>
      <bcf:field source="shorttitle" skip="true"/>
      <bcf:field source="sorttitle" skip="true"/>
      <bcf:field source="indextitle" skip="true"/>
      <bcf:field source="indexsorttitle" skip="true"/>
    </bcf:inherit>
    <bcf:inherit>
      <bcf:type_pair source="mvcollection" target="collection"/>
      <bcf:type_pair source="mvcollection" target="reference"/>
      <bcf:type_pair source="mvcollection" target="incollection"/>
      <bcf:type_pair source="mvcollection" target="inreference"/>
      <bcf:type_pair source="mvcollection" target="suppcollection"/>
      <bcf:type_pair source="mvreference" target="collection"/>
      <bcf:type_pair source="mvreference" target="reference"/>
      <bcf:type_pair source="mvreference" target="incollection"/>
      <bcf:type_pair source="mvreference" target="inreference"/>
      <bcf:type_pair source="mvreference" target="suppcollection"/>
      <bcf:field source="title" target="maintitle"/>
      <bcf:field source="subtitle" target="mainsubtitle"/>
      <bcf:field source="titleaddon" target="maintitleaddon"/>
      <bcf:field source="shorttitle" skip="true"/>
      <bcf:field source="sorttitle" skip="true"/>
      <bcf:field source="indextitle" skip="true"/>
      <bcf:field source="indexsorttitle" skip="true"/>
    </bcf:inherit>
    <bcf:inherit>
      <bcf:type_pair source="mvproceedings" target="proceedings"/>
      <bcf:type_pair source="mvproceedings" target="inproceedings"/>
      <bcf:field source="title" target="maintitle"/>
      <bcf:field source="subtitle" target="mainsubtitle"/>
      <bcf:field source="titleaddon" target="maintitleaddon"/>
      <bcf:field source="shorttitle" skip="true"/>
      <bcf:field source="sorttitle" skip="true"/>
      <bcf:field source="indextitle" skip="true"/>
      <bcf:field source="indexsorttitle" skip="true"/>
    </bcf:inherit>
    <bcf:inherit>
      <bcf:type_pair source="book" target="inbook"/>
      <bcf:type_pair source="book" target="bookinbook"/>
      <bcf:type_pair source="book" target="suppbook"/>
      <bcf:field source="title" target="booktitle"/>
      <bcf:field source="subtitle" target="booksubtitle"/>
      <bcf:field source="titleaddon" target="booktitleaddon"/>
      <bcf:field source="shorttitle" skip="true"/>
      <bcf:field source="sorttitle" skip="true"/>
      <bcf:field source="indextitle" skip="true"/>
      <bcf:field source="indexsorttitle" skip="true"/>
    </bcf:inherit>
    <bcf:inherit>
      <bcf:type_pair source="collection" target="incollection"/>
      <bcf:type_pair source="collection" target="inreference"/>
      <bcf:type_pair source="collection" target="suppcollection"/>
      <bcf:type_pair source="reference" target="incollection"/>
      <bcf:type_pair source="reference" target="inreference"/>
      <bcf:type_pair source="reference" target="suppcollection"/>
      <bcf:field source="title" target="booktitle"/>
      <bcf:field source="subtitle" target="booksubtitle"/>
      <bcf:field source="titleaddon" target="booktitleaddon"/>
      <bcf:field source="shorttitle" skip="true"/>
      <bcf:field source="sorttitle" skip="true"/>
      <bcf:field source="indextitle" skip="true"/>
      <bcf:field source="indexsorttitle" skip="true"/>
    </bcf:inherit>
    <bcf:inherit>
      <bcf:type_pair source="proceedings" target="inproceedings"/>
      <bcf:field source="title" target="booktitle"/>
      <bcf:field source="subtitle" target="booksubtitle"/>
      <bcf:field source="titleaddon" target="booktitleaddon"/>
      <bcf:field source="shorttitle" skip="true"/>
      <bcf:field source="sorttitle" skip="true"/>
      <bcf:field source="indextitle" skip="true"/>
      <bcf:field source="indexsorttitle" skip="true"/>
    </bcf:inherit>
    <bcf:inherit>
      <bcf:type_pair source="periodical" target="article"/>
      <bcf:type_pair source="periodical" target="suppperiodical"/>
      <bcf:field source="title" target="journaltitle"/>
      <bcf:field source="subtitle" target="journalsubtitle"/>
      <bcf:field source="shorttitle" skip="true"/>
      <bcf:field source="sorttitle" skip="true"/>
      <bcf:field source="indextitle" skip="true"/>
      <bcf:field source="indexsorttitle" skip="true"/>
    </bcf:inherit>
    <bcf:inherit>
      <bcf:type_pair source="*" target="*"/>
      <bcf:field source="ids" skip="true"/>
      <bcf:field source="crossref" skip="true"/>
      <bcf:field source="xref" skip="true"/>
      <bcf:field source="entryset" skip="true"/>
      <bcf:field source="entrysubtype" skip="true"/>
      <bcf:field source="execute" skip="true"/>
      <bcf:field source="label" skip="true"/>
      <bcf:field source="options" skip="true"/>
      <bcf:field source="presort" skip="true"/>
      <bcf:field source="related" skip="true"/>
      <bcf:field source="relatedoptions" skip="true"/>
      <bcf:field source="relatedstring" skip="true"/>
      <bcf:field source="relatedtype" skip="true"/>
      <bcf:field source="shorthand" skip="true"/>
      <bcf:field source="shorthandintro" skip="true"/>
      <bcf:field source="sortkey" skip="true"/>
    </bcf:inherit>
  </bcf:inheritance>
  <!-- UNIQUENAME TEMPLATES -->
  <bcf:uniquenametemplate name="global">
    <bcf:namepart order="1" use="1" base="1">prefix</bcf:namepart>
    <bcf:namepart order="2" base="1">family</bcf:namepart>
    <bcf:namepart order="3">given</bcf:namepart>
  </bcf:uniquenametemplate>
  <!-- SORTING NAME KEY TEMPLATES -->
  <bcf:sortingnamekeytemplate name="global">
    <bcf:keypart order="1">
      <bcf:part type="namepart" order="1" use="1">prefix</bcf:part>
      <bcf:part type="namepart" order="2">family</bcf:part>
    </bcf:keypart>
    <bcf:keypart order="2">
      <bcf:part type="namepart" order="1">given</bcf:part>
    </bcf:keypart>
    <bcf:keypart order="3">
      <bcf:part type="namepart" order="1">suffix</bcf:part>
    </bcf:keypart>
    <bcf:keypart order="4">
      <bcf:part type="namepart" order="1" use="0">prefix</bcf:part>
    </bcf:keypart>
  </bcf:sortingnamekeytemplate>
  <bcf:presort>mm</bcf:presort>
  <!-- DATA MODEL -->
  <bcf:datamodel>
    <bcf:constants>
      <bcf:constant type="list" name="gender">sf,sm,sn,pf,pm,pn,pp</bcf:constant>
      <bcf:constant type="list" name="nameparts">family,given,prefix,suffix</bcf:constant>
      <bcf:constant type="list" name="optiondatatypes">boolean,integer,string,xml</bcf:constant>
      <bcf:constant type="list" name="multiscriptforms">default,transliteration,transcription,translation</bcf:constant>
    </bcf:constants>
    <bcf:entrytypes>
      <bcf:entrytype>article</bcf:entrytype>
      <bcf:entrytype>artwork</bcf:entrytype>
      <bcf:entrytype>audio</bcf:entrytype>
      <bcf:entrytype>bibnote</bcf:entrytype>
      <bcf:entrytype>book</bcf:entrytype>
      <bcf:entrytype>bookinbook</bcf:entrytype>
      <bcf:entrytype>booklet</bcf:entrytype>
      <bcf:entrytype>collection</bcf:entrytype>
      <bcf:entrytype>commentary</bcf:entrytype>
      <bcf:entrytype>customa</bcf:entrytype>
      <bcf:entrytype>customb</bcf:entrytype>
      <bcf:entrytype>customc</bcf:entrytype>
      <bcf:entrytype>customd</bcf:entrytype>
      <bcf:entrytype>custome</bcf:entrytype>
      <bcf:entrytype>customf</bcf:entrytype>
      <bcf:entrytype>dataset</bcf:entrytype>
      <bcf:entrytype>inbook</bcf:entrytype>
      <bcf:entrytype>incollection</bcf:entrytype>
      <bcf:entrytype>inproceedings</bcf:entrytype>
      <bcf:entrytype>inreference</bcf:entrytype>
      <bcf:entrytype>image</bcf:entrytype>
      <bcf:entrytype>jurisdiction</bcf:entrytype>
      <bcf:entrytype>legal</bcf:entrytype>
      <bcf:entrytype>legislation</bcf:entrytype>
      <bcf:entrytype>letter</bcf:entrytype>
      <bcf:entrytype>manual</bcf:entrytype>
      <bcf:entrytype>misc</bcf:entrytype>
      <bcf:entrytype>movie</bcf:entrytype>
      <bcf:entrytype>music</bcf:entrytype>
      <bcf:entrytype>mvcollection</bcf:entrytype>
      <bcf:entrytype>mvreference</bcf:entrytype>
      <bcf:entrytype>mvproceedings</bcf:entrytype>
      <bcf:entrytype>mvbook</bcf:entrytype>
      <bcf:entrytype>online</bcf:entrytype>
      <bcf:entrytype>patent</bcf:entrytype>
      <bcf:entrytype>performance</bcf:entrytype>
      <bcf:entrytype>periodical</bcf:entrytype>
      <bcf:entrytype>proceedings</bcf:entrytype>
      <bcf:entrytype>reference</bcf:entrytype>
      <bcf:entrytype>report</bcf:entrytype>
      <bcf:entrytype>review</bcf:entrytype>
      <bcf:entrytype>set</bcf:entrytype>
      <bcf:entrytype>software</bcf:entrytype>
      <bcf:entrytype>standard</bcf:entrytype>
      <bcf:entrytype>suppbook</bcf:entrytype>
      <bcf:entrytype>suppcollection</bcf:entrytype>
      <bcf:entrytype>suppperiodical</bcf:entrytype>
      <bcf:entrytype>thesis</bcf:entrytype>
      <bcf:entrytype>unpublished</bcf:entrytype>
      <bcf:entrytype>video</bcf:entrytype>
      <bcf:entrytype skip_output="true">xdata</bcf:entrytype>
    </bcf:entrytypes>
    <bcf:fields>
      <bcf:field fieldtype="field" datatype="integer">sortyear</bcf:field>
      <bcf:field fieldtype="field" datatype="integer">volume</bcf:field>
      <bcf:field fieldtype="field" datatype="integer">volumes</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">abstract</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">addendum</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">annotation</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">booksubtitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">booktitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">booktitleaddon</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">chapter</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">edition</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">eid</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">entrysubtype</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">eprintclass</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">eprinttype</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">eventtitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">eventtitleaddon</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">gender</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">howpublished</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">indexsorttitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">indextitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">isan</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">isbn</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">ismn</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">isrn</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">issn</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">issue</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">issuesubtitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">issuetitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">iswc</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">journalsubtitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">journaltitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">label</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">langid</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">langidopts</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">library</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">mainsubtitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">maintitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">maintitleaddon</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">nameaddon</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">note</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">number</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">origtitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">pagetotal</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">part</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">relatedstring</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">relatedtype</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">reprinttitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">series</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">shorthandintro</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">subtitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">title</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">titleaddon</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">usera</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">userb</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">userc</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">userd</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">usere</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">userf</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">venue</bcf:field>
      <bcf:field fieldtype="field" datatype="literal">version</bcf:field>
      <bcf:field fieldtype="field" datatype="literal" label="true">shorthand</bcf:field>
      <bcf:field fieldtype="field" datatype="literal" label="true">shortjournal</bcf:field>
      <bcf:field fieldtype="field" datatype="literal" label="true">shortseries</bcf:field>
      <bcf:field fieldtype="field" datatype="literal" label="true">shorttitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal" skip_output="true">sorttitle</bcf:field>
      <bcf:field fieldtype="field" datatype="literal" skip_output="true">sortshorthand</bcf:field>
      <bcf:field fieldtype="field" datatype="literal" skip_output="true">sortkey</bcf:field>
      <bcf:field fieldtype="field" datatype="literal" skip_output="true">presort</bcf:field>
      <bcf:field fieldtype="list" datatype="literal">institution</bcf:field>
      <bcf:field fieldtype="list" datatype="literal">lista</bcf:field>
      <bcf:field fieldtype="list" datatype="literal">listb</bcf:field>
      <bcf:field fieldtype="list" datatype="literal">listc</bcf:field>
      <bcf:field fieldtype="list" datatype="literal">listd</bcf:field>
      <bcf:field fieldtype="list" datatype="literal">liste</bcf:field>
      <bcf:field fieldtype="list" datatype="literal">listf</bcf:field>
      <bcf:field fieldtype="list" datatype="literal">location</bcf:field>
      <bcf:field fieldtype="list" datatype="literal">organization</bcf:field>
      <bcf:field fieldtype="list" datatype="literal">origlocation</bcf:field>
      <bcf:field fieldtype="list" datatype="literal">origpublisher</bcf:field>
      <bcf:field fieldtype="list" datatype="literal">publisher</bcf:field>
      <bcf:field fieldtype="list" datatype="name">afterword</bcf:field>
      <bcf:field fieldtype="list" datatype="name">annotator</bcf:field>
      <bcf:field fieldtype="list" datatype="name">author</bcf:field>
      <bcf:field fieldtype="list" datatype="name">bookauthor</bcf:field>
      <bcf:field fieldtype="list" datatype="name">commentator</bcf:field>
      <bcf:field fieldtype="list" datatype="name">editor</bcf:field>
      <bcf:field fieldtype="list" datatype="name">editora</bcf:field>
      <bcf:field fieldtype="list" datatype="name">editorb</bcf:field>
      <bcf:field fieldtype="list" datatype="name">editorc</bcf:field>
      <bcf:field fieldtype="list" datatype="name">foreword</bcf:field>
      <bcf:field fieldtype="list" datatype="name">holder</bcf:field>
      <bcf:field fieldtype="list" datatype="name">introduction</bcf:field>
      <bcf:field fieldtype="list" datatype="name">namea</bcf:field>
      <bcf:field fieldtype="list" datatype="name">nameb</bcf:field>
      <bcf:field fieldtype="list" datatype="name">namec</bcf:field>
      <bcf:field fieldtype="list" datatype="name">translator</bcf:field>
      <bcf:field fieldtype="list" datatype="name" label="true">shortauthor</bcf:field>
      <bcf:field fieldtype="list" datatype="name" label="true">shorteditor</bcf:field>
      <bcf:field fieldtype="list" datatype="name" skip_output="true">sortname</bcf:field>
      <bcf:field fieldtype="field" datatype="key">authortype</bcf:field>
      <bcf:field fieldtype="field" datatype="key">editoratype</bcf:field>
      <bcf:field fieldtype="field" datatype="key">editorbtype</bcf:field>
      <bcf:field fieldtype="field" datatype="key">editorctype</bcf:field>
      <bcf:field fieldtype="field" datatype="key">editortype</bcf:field>
      <bcf:field fieldtype="field" datatype="key">bookpagination</bcf:field>
      <bcf:field fieldtype="field" datatype="key">nameatype</bcf:field>
      <bcf:field fieldtype="field" datatype="key">namebtype</bcf:field>
      <bcf:field fieldtype="field" datatype="key">namectype</bcf:field>
      <bcf:field fieldtype="field" datatype="key">pagination</bcf:field>
      <bcf:field fieldtype="field" datatype="key">pubstate</bcf:field>
      <bcf:field fieldtype="field" datatype="key">type</bcf:field>
      <bcf:field fieldtype="list" datatype="key">language</bcf:field>
      <bcf:field fieldtype="list" datatype="key">origlanguage</bcf:field>
      <bcf:field fieldtype="field" datatype="entrykey">crossref</bcf:field>
      <bcf:field fieldtype="field" datatype="entrykey">xref</bcf:field>
      <bcf:field fieldtype="field" datatype="date" skip_output="true">date</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart" nullok="true">endyear</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart" nullok="true">year</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">month</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">day</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">hour</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">minute</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">second</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">timezone</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">season</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">endmonth</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">endday</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">endhour</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">endminute</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">endsecond</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">endtimezone</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">endseason</bcf:field>
      <bcf:field fieldtype="field" datatype="date" skip_output="true">eventdate</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart" nullok="true">eventendyear</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart" nullok="true">eventyear</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventmonth</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventday</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventhour</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventminute</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventsecond</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventtimezone</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventseason</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventendmonth</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventendday</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventendhour</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventendminute</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventendsecond</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventendtimezone</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">eventendseason</bcf:field>
      <bcf:field fieldtype="field" datatype="date" skip_output="true">origdate</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart" nullok="true">origendyear</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart" nullok="true">origyear</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origmonth</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origday</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">orighour</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origminute</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origsecond</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origtimezone</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origseason</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origendmonth</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origendday</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origendhour</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origendminute</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origendsecond</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origendtimezone</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">origendseason</bcf:field>
      <bcf:field fieldtype="field" datatype="date" skip_output="true">urldate</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart" nullok="true">urlendyear</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart" nullok="true">urlyear</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlmonth</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlday</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlhour</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlminute</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlsecond</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urltimezone</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlseason</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlendmonth</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlendday</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlendhour</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlendminute</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlendsecond</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlendtimezone</bcf:field>
      <bcf:field fieldtype="field" datatype="datepart">urlendseason</bcf:field>
      <bcf:field fieldtype="field" datatype="verbatim">doi</bcf:field>
      <bcf:field fieldtype="field" datatype="verbatim">eprint</bcf:field>
      <bcf:field fieldtype="field" datatype="verbatim">file</bcf:field>
      <bcf:field fieldtype="field" datatype="verbatim">verba</bcf:field>
      <bcf:field fieldtype="field" datatype="verbatim">verbb</bcf:field>
      <bcf:field fieldtype="field" datatype="verbatim">verbc</bcf:field>
      <bcf:field fieldtype="field" datatype="uri">url</bcf:field>
      <bcf:field fieldtype="field" format="xsv" datatype="entrykey" skip_output="true">xdata</bcf:field>
      <bcf:field fieldtype="field" format="xsv" datatype="entrykey" skip_output="true">ids</bcf:field>
      <bcf:field fieldtype="field" format="xsv" datatype="entrykey" skip_output="true">entryset</bcf:field>
      <bcf:field fieldtype="field" format="xsv" datatype="entrykey">related</bcf:field>
      <bcf:field fieldtype="field" format="xsv" datatype="keyword">keywords</bcf:field>
      <bcf:field fieldtype="field" format="xsv" datatype="option" skip_output="true">options</bcf:field>
      <bcf:field fieldtype="field" format="xsv" datatype="option" skip_output="true">relatedoptions</bcf:field>
      <bcf:field fieldtype="field" datatype="range">pages</bcf:field>
      <bcf:field fieldtype="field" datatype="code">execute</bcf:field>
    </bcf:fields>
    <bcf:entryfields>
      <bcf:field>abstract</bcf:field>
      <bcf:field>annotation</bcf:field>
      <bcf:field>authortype</bcf:field>
      <bcf:field>bookpagination</bcf:field>
      <bcf:field>crossref</bcf:field>
      <bcf:field>day</bcf:field>
      <bcf:field>endday</bcf:field>
      <bcf:field>endhour</bcf:field>
      <bcf:field>endminute</bcf:field>
      <bcf:field>endmonth</bcf:field>
      <bcf:field>endseason</bcf:field>
      <bcf:field>endsecond</bcf:field>
      <bcf:field>endtimezone</bcf:field>
      <bcf:field>endyear</bcf:field>
      <bcf:field>entryset</bcf:field>
      <bcf:field>entrysubtype</bcf:field>
      <bcf:field>execute</bcf:field>
      <bcf:field>file</bcf:field>
      <bcf:field>gender</bcf:field>
      <bcf:field>hour</bcf:field>
      <bcf:field>ids</bcf:field>
      <bcf:field>indextitle</bcf:field>
      <bcf:field>indexsorttitle</bcf:field>
      <bcf:field>isan</bcf:field>
      <bcf:field>ismn</bcf:field>
      <bcf:field>iswc</bcf:field>
      <bcf:field>keywords</bcf:field>
      <bcf:field>label</bcf:field>
      <bcf:field>langid</bcf:field>
      <bcf:field>langidopts</bcf:field>
      <bcf:field>library</bcf:field>
      <bcf:field>lista</bcf:field>
      <bcf:field>listb</bcf:field>
      <bcf:field>listc</bcf:field>
      <bcf:field>listd</bcf:field>
      <bcf:field>liste</bcf:field>
      <bcf:field>listf</bcf:field>
      <bcf:field>minute</bcf:field>
      <bcf:field>month</bcf:field>
      <bcf:field>nameaddon</bcf:field>
      <bcf:field>options</bcf:field>
      <bcf:field>origday</bcf:field>
      <bcf:field>origendday</bcf:field>
      <bcf:field>origendhour</bcf:field>
      <bcf:field>origendminute</bcf:field>
      <bcf:field>origendmonth</bcf:field>
      <bcf:field>origendseason</bcf:field>
      <bcf:field>origendsecond</bcf:field>
      <bcf:field>origendtimezone</bcf:field>
      <bcf:field>origendyear</bcf:field>
      <bcf:field>orighour</bcf:field>
      <bcf:field>origminute</bcf:field>
      <bcf:field>origmonth</bcf:field>
      <bcf:field>origseason</bcf:field>
      <bcf:field>origsecond</bcf:field>
      <bcf:field>origtimezone</bcf:field>
      <bcf:field>origyear</bcf:field>
      <bcf:field>origlocation</bcf:field>
      <bcf:field>origpublisher</bcf:field>
      <bcf:field>origtitle</bcf:field>
      <bcf:field>pagination</bcf:field>
      <bcf:field>presort</bcf:field>
      <bcf:field>related</bcf:field>
      <bcf:field>relatedoptions</bcf:field>
      <bcf:field>relatedstring</bcf:field>
      <bcf:field>relatedtype</bcf:field>
      <bcf:field>season</bcf:field>
      <bcf:field>second</bcf:field>
      <bcf:field>shortauthor</bcf:field>
      <bcf:field>shorteditor</bcf:field>
      <bcf:field>shorthand</bcf:field>
      <bcf:field>shorthandintro</bcf:field>
      <bcf:field>shortjournal</bcf:field>
      <bcf:field>shortseries</bcf:field>
      <bcf:field>shorttitle</bcf:field>
      <bcf:field>sortkey</bcf:field>
      <bcf:field>sortname</bcf:field>
      <bcf:field>sortshorthand</bcf:field>
      <bcf:field>sorttitle</bcf:field>
      <bcf:field>sortyear</bcf:field>
      <bcf:field>timezone</bcf:field>
      <bcf:field>url</bcf:field>
      <bcf:field>urlday</bcf:field>
      <bcf:field>urlendday</bcf:field>
      <bcf:field>urlendhour</bcf:field>
      <bcf:field>urlendminute</bcf:field>
      <bcf:field>urlendmonth</bcf:field>
      <bcf:field>urlendsecond</bcf:field>
      <bcf:field>urlendtimezone</bcf:field>
      <bcf:field>urlendyear</bcf:field>
      <bcf:field>urlhour</bcf:field>
      <bcf:field>urlminute</bcf:field>
      <bcf:field>urlmonth</bcf:field>
      <bcf:field>urlsecond</bcf:field>
      <bcf:field>urltimezone</bcf:field>
      <bcf:field>urlyear</bcf:field>
      <bcf:field>usera</bcf:field>
      <bcf:field>userb</bcf:field>
      <bcf:field>userc</bcf:field>
      <bcf:field>userd</bcf:field>
      <bcf:field>usere</bcf:field>
      <bcf:field>userf</bcf:field>
      <bcf:field>verba</bcf:field>
      <bcf:field>verbb</bcf:field>
      <bcf:field>verbc</bcf:field>
      <bcf:field>xdata</bcf:field>
      <bcf:field>xref</bcf:field>
      <bcf:field>year</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>set</bcf:entrytype>
      <bcf:field>entryset</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>article</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>annotator</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>commentator</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editora</bcf:field>
      <bcf:field>editorb</bcf:field>
      <bcf:field>editorc</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>editoratype</bcf:field>
      <bcf:field>editorbtype</bcf:field>
      <bcf:field>editorctype</bcf:field>
      <bcf:field>eid</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>issn</bcf:field>
      <bcf:field>issue</bcf:field>
      <bcf:field>issuetitle</bcf:field>
      <bcf:field>issuesubtitle</bcf:field>
      <bcf:field>journalsubtitle</bcf:field>
      <bcf:field>journaltitle</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>origlanguage</bcf:field>
      <bcf:field>pages</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>translator</bcf:field>
      <bcf:field>version</bcf:field>
      <bcf:field>volume</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>bibnote</bcf:entrytype>
      <bcf:field>note</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>book</bcf:entrytype>
      <bcf:field>author</bcf:field>
      <bcf:field>addendum</bcf:field>
      <bcf:field>afterword</bcf:field>
      <bcf:field>annotator</bcf:field>
      <bcf:field>chapter</bcf:field>
      <bcf:field>commentator</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>edition</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editora</bcf:field>
      <bcf:field>editorb</bcf:field>
      <bcf:field>editorc</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>editoratype</bcf:field>
      <bcf:field>editorbtype</bcf:field>
      <bcf:field>editorctype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>foreword</bcf:field>
      <bcf:field>introduction</bcf:field>
      <bcf:field>isbn</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>maintitle</bcf:field>
      <bcf:field>maintitleaddon</bcf:field>
      <bcf:field>mainsubtitle</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>origlanguage</bcf:field>
      <bcf:field>pages</bcf:field>
      <bcf:field>pagetotal</bcf:field>
      <bcf:field>part</bcf:field>
      <bcf:field>publisher</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>translator</bcf:field>
      <bcf:field>volume</bcf:field>
      <bcf:field>volumes</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>mvbook</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>afterword</bcf:field>
      <bcf:field>annotator</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>commentator</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>edition</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editora</bcf:field>
      <bcf:field>editorb</bcf:field>
      <bcf:field>editorc</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>editoratype</bcf:field>
      <bcf:field>editorbtype</bcf:field>
      <bcf:field>editorctype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>foreword</bcf:field>
      <bcf:field>introduction</bcf:field>
      <bcf:field>isbn</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>origlanguage</bcf:field>
      <bcf:field>pagetotal</bcf:field>
      <bcf:field>publisher</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>translator</bcf:field>
      <bcf:field>volume</bcf:field>
      <bcf:field>volumes</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>inbook</bcf:entrytype>
      <bcf:entrytype>bookinbook</bcf:entrytype>
      <bcf:entrytype>suppbook</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>afterword</bcf:field>
      <bcf:field>annotator</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>booktitle</bcf:field>
      <bcf:field>bookauthor</bcf:field>
      <bcf:field>booksubtitle</bcf:field>
      <bcf:field>booktitleaddon</bcf:field>
      <bcf:field>chapter</bcf:field>
      <bcf:field>commentator</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>edition</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editora</bcf:field>
      <bcf:field>editorb</bcf:field>
      <bcf:field>editorc</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>editoratype</bcf:field>
      <bcf:field>editorbtype</bcf:field>
      <bcf:field>editorctype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>foreword</bcf:field>
      <bcf:field>introduction</bcf:field>
      <bcf:field>isbn</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>mainsubtitle</bcf:field>
      <bcf:field>maintitle</bcf:field>
      <bcf:field>maintitleaddon</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>origlanguage</bcf:field>
      <bcf:field>part</bcf:field>
      <bcf:field>publisher</bcf:field>
      <bcf:field>pages</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>translator</bcf:field>
      <bcf:field>volume</bcf:field>
      <bcf:field>volumes</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>booklet</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>chapter</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>howpublished</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>pages</bcf:field>
      <bcf:field>pagetotal</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>type</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>collection</bcf:entrytype>
      <bcf:entrytype>reference</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>afterword</bcf:field>
      <bcf:field>annotator</bcf:field>
      <bcf:field>chapter</bcf:field>
      <bcf:field>commentator</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>edition</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editora</bcf:field>
      <bcf:field>editorb</bcf:field>
      <bcf:field>editorc</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>editoratype</bcf:field>
      <bcf:field>editorbtype</bcf:field>
      <bcf:field>editorctype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>foreword</bcf:field>
      <bcf:field>introduction</bcf:field>
      <bcf:field>isbn</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>mainsubtitle</bcf:field>
      <bcf:field>maintitle</bcf:field>
      <bcf:field>maintitleaddon</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>origlanguage</bcf:field>
      <bcf:field>pages</bcf:field>
      <bcf:field>pagetotal</bcf:field>
      <bcf:field>part</bcf:field>
      <bcf:field>publisher</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>translator</bcf:field>
      <bcf:field>volume</bcf:field>
      <bcf:field>volumes</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>mvcollection</bcf:entrytype>
      <bcf:entrytype>mvreference</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>afterword</bcf:field>
      <bcf:field>annotator</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>commentator</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>edition</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editora</bcf:field>
      <bcf:field>editorb</bcf:field>
      <bcf:field>editorc</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>editoratype</bcf:field>
      <bcf:field>editorbtype</bcf:field>
      <bcf:field>editorctype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>foreword</bcf:field>
      <bcf:field>introduction</bcf:field>
      <bcf:field>isbn</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>origlanguage</bcf:field>
      <bcf:field>publisher</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>translator</bcf:field>
      <bcf:field>volume</bcf:field>
      <bcf:field>volumes</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>incollection</bcf:entrytype>
      <bcf:entrytype>suppcollection</bcf:entrytype>
      <bcf:entrytype>inreference</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>afterword</bcf:field>
      <bcf:field>annotator</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>booksubtitle</bcf:field>
      <bcf:field>booktitle</bcf:field>
      <bcf:field>booktitleaddon</bcf:field>
      <bcf:field>chapter</bcf:field>
      <bcf:field>commentator</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>edition</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editora</bcf:field>
      <bcf:field>editorb</bcf:field>
      <bcf:field>editorc</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>editoratype</bcf:field>
      <bcf:field>editorbtype</bcf:field>
      <bcf:field>editorctype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>foreword</bcf:field>
      <bcf:field>introduction</bcf:field>
      <bcf:field>isbn</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>mainsubtitle</bcf:field>
      <bcf:field>maintitle</bcf:field>
      <bcf:field>maintitleaddon</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>origlanguage</bcf:field>
      <bcf:field>pages</bcf:field>
      <bcf:field>part</bcf:field>
      <bcf:field>publisher</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>translator</bcf:field>
      <bcf:field>volume</bcf:field>
      <bcf:field>volumes</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>dataset</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>edition</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>organization</bcf:field>
      <bcf:field>publisher</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>type</bcf:field>
      <bcf:field>version</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>manual</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>chapter</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>edition</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>isbn</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>organization</bcf:field>
      <bcf:field>pages</bcf:field>
      <bcf:field>pagetotal</bcf:field>
      <bcf:field>publisher</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>type</bcf:field>
      <bcf:field>version</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>misc</bcf:entrytype>
      <bcf:entrytype>software</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>howpublished</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>organization</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>type</bcf:field>
      <bcf:field>version</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>online</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>organization</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>version</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>patent</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>holder</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>type</bcf:field>
      <bcf:field>version</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>periodical</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editora</bcf:field>
      <bcf:field>editorb</bcf:field>
      <bcf:field>editorc</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>editoratype</bcf:field>
      <bcf:field>editorbtype</bcf:field>
      <bcf:field>editorctype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>issn</bcf:field>
      <bcf:field>issue</bcf:field>
      <bcf:field>issuesubtitle</bcf:field>
      <bcf:field>issuetitle</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>season</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>volume</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>mvproceedings</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>eventday</bcf:field>
      <bcf:field>eventendday</bcf:field>
      <bcf:field>eventendhour</bcf:field>
      <bcf:field>eventendminute</bcf:field>
      <bcf:field>eventendmonth</bcf:field>
      <bcf:field>eventendseason</bcf:field>
      <bcf:field>eventendsecond</bcf:field>
      <bcf:field>eventendtimezone</bcf:field>
      <bcf:field>eventendyear</bcf:field>
      <bcf:field>eventhour</bcf:field>
      <bcf:field>eventminute</bcf:field>
      <bcf:field>eventmonth</bcf:field>
      <bcf:field>eventseason</bcf:field>
      <bcf:field>eventsecond</bcf:field>
      <bcf:field>eventtimezone</bcf:field>
      <bcf:field>eventyear</bcf:field>
      <bcf:field>eventtitle</bcf:field>
      <bcf:field>eventtitleaddon</bcf:field>
      <bcf:field>isbn</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>organization</bcf:field>
      <bcf:field>pagetotal</bcf:field>
      <bcf:field>publisher</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>venue</bcf:field>
      <bcf:field>volumes</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>proceedings</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>chapter</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>eventday</bcf:field>
      <bcf:field>eventendday</bcf:field>
      <bcf:field>eventendhour</bcf:field>
      <bcf:field>eventendminute</bcf:field>
      <bcf:field>eventendmonth</bcf:field>
      <bcf:field>eventendseason</bcf:field>
      <bcf:field>eventendsecond</bcf:field>
      <bcf:field>eventendtimezone</bcf:field>
      <bcf:field>eventendyear</bcf:field>
      <bcf:field>eventhour</bcf:field>
      <bcf:field>eventminute</bcf:field>
      <bcf:field>eventmonth</bcf:field>
      <bcf:field>eventseason</bcf:field>
      <bcf:field>eventsecond</bcf:field>
      <bcf:field>eventtimezone</bcf:field>
      <bcf:field>eventyear</bcf:field>
      <bcf:field>eventtitle</bcf:field>
      <bcf:field>eventtitleaddon</bcf:field>
      <bcf:field>isbn</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>mainsubtitle</bcf:field>
      <bcf:field>maintitle</bcf:field>
      <bcf:field>maintitleaddon</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>organization</bcf:field>
      <bcf:field>pages</bcf:field>
      <bcf:field>pagetotal</bcf:field>
      <bcf:field>part</bcf:field>
      <bcf:field>publisher</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>venue</bcf:field>
      <bcf:field>volume</bcf:field>
      <bcf:field>volumes</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>inproceedings</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>booksubtitle</bcf:field>
      <bcf:field>booktitle</bcf:field>
      <bcf:field>booktitleaddon</bcf:field>
      <bcf:field>chapter</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editortype</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>eventday</bcf:field>
      <bcf:field>eventendday</bcf:field>
      <bcf:field>eventendhour</bcf:field>
      <bcf:field>eventendminute</bcf:field>
      <bcf:field>eventendmonth</bcf:field>
      <bcf:field>eventendseason</bcf:field>
      <bcf:field>eventendsecond</bcf:field>
      <bcf:field>eventendtimezone</bcf:field>
      <bcf:field>eventendyear</bcf:field>
      <bcf:field>eventhour</bcf:field>
      <bcf:field>eventminute</bcf:field>
      <bcf:field>eventmonth</bcf:field>
      <bcf:field>eventseason</bcf:field>
      <bcf:field>eventsecond</bcf:field>
      <bcf:field>eventtimezone</bcf:field>
      <bcf:field>eventyear</bcf:field>
      <bcf:field>eventtitle</bcf:field>
      <bcf:field>eventtitleaddon</bcf:field>
      <bcf:field>isbn</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>mainsubtitle</bcf:field>
      <bcf:field>maintitle</bcf:field>
      <bcf:field>maintitleaddon</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>organization</bcf:field>
      <bcf:field>pages</bcf:field>
      <bcf:field>part</bcf:field>
      <bcf:field>publisher</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>venue</bcf:field>
      <bcf:field>volume</bcf:field>
      <bcf:field>volumes</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>report</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>chapter</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>institution</bcf:field>
      <bcf:field>isrn</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>number</bcf:field>
      <bcf:field>pages</bcf:field>
      <bcf:field>pagetotal</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>type</bcf:field>
      <bcf:field>version</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>thesis</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>chapter</bcf:field>
      <bcf:field>doi</bcf:field>
      <bcf:field>eprint</bcf:field>
      <bcf:field>eprintclass</bcf:field>
      <bcf:field>eprinttype</bcf:field>
      <bcf:field>institution</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>pages</bcf:field>
      <bcf:field>pagetotal</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>type</bcf:field>
    </bcf:entryfields>
    <bcf:entryfields>
      <bcf:entrytype>unpublished</bcf:entrytype>
      <bcf:field>addendum</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>eventday</bcf:field>
      <bcf:field>eventendday</bcf:field>
      <bcf:field>eventendhour</bcf:field>
      <bcf:field>eventendminute</bcf:field>
      <bcf:field>eventendmonth</bcf:field>
      <bcf:field>eventendseason</bcf:field>
      <bcf:field>eventendsecond</bcf:field>
      <bcf:field>eventendtimezone</bcf:field>
      <bcf:field>eventendyear</bcf:field>
      <bcf:field>eventhour</bcf:field>
      <bcf:field>eventminute</bcf:field>
      <bcf:field>eventmonth</bcf:field>
      <bcf:field>eventseason</bcf:field>
      <bcf:field>eventsecond</bcf:field>
      <bcf:field>eventtimezone</bcf:field>
      <bcf:field>eventyear</bcf:field>
      <bcf:field>eventtitle</bcf:field>
      <bcf:field>eventtitleaddon</bcf:field>
      <bcf:field>howpublished</bcf:field>
      <bcf:field>language</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>pubstate</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>type</bcf:field>
      <bcf:field>venue</bcf:field>
    </bcf:entryfields>
    <bcf:multiscriptfields>
      <bcf:field>abstract</bcf:field>
      <bcf:field>addendum</bcf:field>
      <bcf:field>afterword</bcf:field>
      <bcf:field>annotator</bcf:field>
      <bcf:field>author</bcf:field>
      <bcf:field>bookauthor</bcf:field>
      <bcf:field>booksubtitle</bcf:field>
      <bcf:field>booktitle</bcf:field>
      <bcf:field>booktitleaddon</bcf:field>
      <bcf:field>chapter</bcf:field>
      <bcf:field>commentator</bcf:field>
      <bcf:field>editor</bcf:field>
      <bcf:field>editora</bcf:field>
      <bcf:field>editorb</bcf:field>
      <bcf:field>editorc</bcf:field>
      <bcf:field>foreword</bcf:field>
      <bcf:field>holder</bcf:field>
      <bcf:field>institution</bcf:field>
      <bcf:field>introduction</bcf:field>
      <bcf:field>issuesubtitle</bcf:field>
      <bcf:field>issuetitle</bcf:field>
      <bcf:field>journalsubtitle</bcf:field>
      <bcf:field>journaltitle</bcf:field>
      <bcf:field>location</bcf:field>
      <bcf:field>mainsubtitle</bcf:field>
      <bcf:field>maintitle</bcf:field>
      <bcf:field>maintitleaddon</bcf:field>
      <bcf:field>nameaddon</bcf:field>
      <bcf:field>note</bcf:field>
      <bcf:field>organization</bcf:field>
      <bcf:field>origlanguage</bcf:field>
      <bcf:field>origlocation</bcf:field>
      <bcf:field>origpublisher</bcf:field>
      <bcf:field>origtitle</bcf:field>
      <bcf:field>part</bcf:field>
      <bcf:field>publisher</bcf:field>
      <bcf:field>relatedstring</bcf:field>
      <bcf:field>series</bcf:field>
      <bcf:field>shortauthor</bcf:field>
      <bcf:field>shorteditor</bcf:field>
      <bcf:field>shorthand</bcf:field>
      <bcf:field>shortjournal</bcf:field>
      <bcf:field>shortseries</bcf:field>
      <bcf:field>shorttitle</bcf:field>
      <bcf:field>sortname</bcf:field>
      <bcf:field>sortshorthand</bcf:field>
      <bcf:field>sorttitle</bcf:field>
      <bcf:field>subtitle</bcf:field>
      <bcf:field>title</bcf:field>
      <bcf:field>titleaddon</bcf:field>
      <bcf:field>translator</bcf:field>
      <bcf:field>venue</bcf:field>
    </bcf:multiscriptfields>
    <bcf:constraints>
      <bcf:entrytype>article</bcf:entrytype>
      <bcf:entrytype>book</bcf:entrytype>
      <bcf:entrytype>inbook</bcf:entrytype>
      <bcf:entrytype>bookinbook</bcf:entrytype>
      <bcf:entrytype>suppbook</bcf:entrytype>
      <bcf:entrytype>booklet</bcf:entrytype>
      <bcf:entrytype>collection</bcf:entrytype>
      <bcf:entrytype>incollection</bcf:entrytype>
      <bcf:entrytype>suppcollection</bcf:entrytype>
      <bcf:entrytype>manual</bcf:entrytype>
      <bcf:entrytype>misc</bcf:entrytype>
      <bcf:entrytype>mvbook</bcf:entrytype>
      <bcf:entrytype>mvcollection</bcf:entrytype>
      <bcf:entrytype>online</bcf:entrytype>
      <bcf:entrytype>patent</bcf:entrytype>
      <bcf:entrytype>periodical</bcf:entrytype>
      <bcf:entrytype>suppperiodical</bcf:entrytype>
      <bcf:entrytype>proceedings</bcf:entrytype>
      <bcf:entrytype>inproceedings</bcf:entrytype>
      <bcf:entrytype>reference</bcf:entrytype>
      <bcf:entrytype>inreference</bcf:entrytype>
      <bcf:entrytype>report</bcf:entrytype>
      <bcf:entrytype>set</bcf:entrytype>
      <bcf:entrytype>thesis</bcf:entrytype>
      <bcf:entrytype>unpublished</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:fieldxor>
          <bcf:field>date</bcf:field>
          <bcf:field>year</bcf:field>
        </bcf:fieldxor>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>set</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>entryset</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>article</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>author</bcf:field>
        <bcf:field>journaltitle</bcf:field>
        <bcf:field>title</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>book</bcf:entrytype>
      <bcf:entrytype>mvbook</bcf:entrytype>
      <bcf:entrytype>mvcollection</bcf:entrytype>
      <bcf:entrytype>mvreference</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>author</bcf:field>
        <bcf:field>title</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>inbook</bcf:entrytype>
      <bcf:entrytype>bookinbook</bcf:entrytype>
      <bcf:entrytype>suppbook</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>author</bcf:field>
        <bcf:field>title</bcf:field>
        <bcf:field>booktitle</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>booklet</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:fieldor>
          <bcf:field>author</bcf:field>
          <bcf:field>editor</bcf:field>
        </bcf:fieldor>
        <bcf:field>title</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>collection</bcf:entrytype>
      <bcf:entrytype>reference</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>editor</bcf:field>
        <bcf:field>title</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>incollection</bcf:entrytype>
      <bcf:entrytype>suppcollection</bcf:entrytype>
      <bcf:entrytype>inreference</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>author</bcf:field>
        <bcf:field>editor</bcf:field>
        <bcf:field>title</bcf:field>
        <bcf:field>booktitle</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>dataset</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>title</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>manual</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>title</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>misc</bcf:entrytype>
      <bcf:entrytype>software</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>title</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>online</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>title</bcf:field>
        <bcf:fieldor>
          <bcf:field>url</bcf:field>
          <bcf:field>doi</bcf:field>
          <bcf:field>eprint</bcf:field>
        </bcf:fieldor>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>patent</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>author</bcf:field>
        <bcf:field>title</bcf:field>
        <bcf:field>number</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>periodical</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>editor</bcf:field>
        <bcf:field>title</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>proceedings</bcf:entrytype>
      <bcf:entrytype>mvproceedings</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>editor</bcf:field>
        <bcf:field>title</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>inproceedings</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>author</bcf:field>
        <bcf:field>title</bcf:field>
        <bcf:field>booktitle</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>report</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>author</bcf:field>
        <bcf:field>title</bcf:field>
        <bcf:field>type</bcf:field>
        <bcf:field>institution</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>thesis</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>author</bcf:field>
        <bcf:field>title</bcf:field>
        <bcf:field>type</bcf:field>
        <bcf:field>institution</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:entrytype>unpublished</bcf:entrytype>
      <bcf:constraint type="mandatory">
        <bcf:field>author</bcf:field>
        <bcf:field>title</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
    <bcf:constraints>
      <bcf:constraint type="data" datatype="isbn">
        <bcf:field>isbn</bcf:field>
      </bcf:constraint>
      <bcf:constraint type="data" datatype="issn">
        <bcf:field>issn</bcf:field>
      </bcf:constraint>
      <bcf:constraint type="data" datatype="ismn">
        <bcf:field>ismn</bcf:field>
      </bcf:constraint>
      <bcf:constraint type="data" datatype="date">
        <bcf:field>date</bcf:field>
        <bcf:field>eventdate</bcf:field>
        <bcf:field>origdate</bcf:field>
        <bcf:field>urldate</bcf:field>
      </bcf:constraint>
      <bcf:constraint type="data" datatype="pattern" pattern="(?:sf|sm|sn|pf|pm|pn|pp)">
        <bcf:field>gender</bcf:field>
      </bcf:constraint>
    </bcf:constraints>
  </bcf:datamodel>
  <!-- CITATION DATA -->
  <!-- SECTION 0 -->
  <bcf:bibdata section="0">
    <bcf:datasource type="file" datatype="bibtex">bibliografia.bib</bcf:datasource>
  </bcf:bibdata>
  <bcf:section number="0">
    <bcf:citekey order="1">ecb_sepa</bcf:citekey>
    <bcf:citekey order="2">ecb_sepa</bcf:citekey>
    <bcf:citekey order="3">ecb_sepa</bcf:citekey>
    <bcf:citekey order="4">epc_sdd_2025</bcf:citekey>
    <bcf:citekey order="5">epc016</bcf:citekey>
    <bcf:citekey order="6">EC_2018_RTS_SCA</bcf:citekey>
    <bcf:citekey order="7">epc_sctinst_2025</bcf:citekey>
    <bcf:citekey order="8">iso20022_55005</bcf:citekey>
    <bcf:citekey order="9">epc014</bcf:citekey>
    <bcf:citekey order="10">EPC_official</bcf:citekey>
    <bcf:citekey order="11">eu_260_2012</bcf:citekey>
    <bcf:citekey order="12">epc125_2023</bcf:citekey>
    <bcf:citekey order="13">EU_IBAN_2001</bcf:citekey>
    <bcf:citekey order="14">EBA_RT1</bcf:citekey>
    <bcf:citekey order="15">ECB_ERPB</bcf:citekey>
    <bcf:citekey order="16">fourcorner_wiki</bcf:citekey>
    <bcf:citekey order="17">ecp014</bcf:citekey>
    <bcf:citekey order="18">epc098_2021</bcf:citekey>
    <bcf:citekey order="19">ECB_TIPS</bcf:citekey>
    <bcf:citekey order="20">epc014</bcf:citekey>
    <bcf:citekey order="0" nocite="1">*</bcf:citekey>
  </bcf:section>
  <!-- SORTING TEMPLATES -->
  <bcf:sortingtemplate name="nyt">
    <bcf:sort order="1">
      <bcf:sortitem order="1">presort</bcf:sortitem>
    </bcf:sort>
    <bcf:sort order="2" final="1">
      <bcf:sortitem order="1">sortkey</bcf:sortitem>
    </bcf:sort>
    <bcf:sort order="3">
      <bcf:sortitem order="1">sortname</bcf:sortitem>
      <bcf:sortitem order="2">author</bcf:sortitem>
      <bcf:sortitem order="3">editor</bcf:sortitem>
      <bcf:sortitem order="4">translator</bcf:sortitem>
      <bcf:sortitem order="5">sorttitle</bcf:sortitem>
      <bcf:sortitem order="6">title</bcf:sortitem>
    </bcf:sort>
    <bcf:sort order="4">
      <bcf:sortitem order="1">sortyear</bcf:sortitem>
      <bcf:sortitem order="2">year</bcf:sortitem>
    </bcf:sort>
    <bcf:sort order="5">
      <bcf:sortitem order="1">sorttitle</bcf:sortitem>
      <bcf:sortitem order="2">title</bcf:sortitem>
    </bcf:sort>
    <bcf:sort order="6">
      <bcf:sortitem order="1">volume</bcf:sortitem>
      <bcf:sortitem literal="1" order="2">0</bcf:sortitem>
    </bcf:sort>
  </bcf:sortingtemplate>
  <!-- DATALISTS -->
  <bcf:datalist section="0"
                name="nyt/global//global/global"
                type="entry"
                sortingtemplatename="nyt"
                sortingnamekeytemplatename="global"
                labelprefix=""
                uniquenametemplatename="global"
                labelalphanametemplatename="global">
  </bcf:datalist>
</bcf:controlfile>


# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/DIAGRAMAaER.svg

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="CLASS" height="208px" preserveAspectRatio="none" style="width:843px;height:208px;background:#FFFFFF;" version="1.1" viewBox="0 0 843 208" width="843px" zoomAndPan="magnify"><defs/><g><!--class Actor--><g class="entity" data-entity="Actor" data-source-line="4" data-uid="ent0002" id="entity_Actor"><rect fill="#F1F1F1" height="194.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="173.3965" x="7" y="7"/><ellipse cx="70.9058" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M75.0151,29 L67.2964,29 L67.2964,16.6094 L75.0151,16.6094 L75.0151,18.7656 L69.7495,18.7656 L69.7495,21.4375 L74.5151,21.4375 L74.5151,23.5938 L69.7495,23.5938 L69.7495,26.8438 L75.0151,26.8438 L75.0151,29 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.085" x="91.4058" y="27.8467">Actor</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="179.3965" y1="39" y2="39"/><ellipse cx="18" cy="52.6484" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.7188" x="27" y="55.9951">id : integer &#171;PK&#187;</text><ellipse cx="18" cy="68.9453" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.0449" x="27" y="72.292">username : string</text><ellipse cx="18" cy="85.2422" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.5176" x="27" y="88.5889">password : string</text><ellipse cx="18" cy="101.5391" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.5088" x="27" y="104.8857">name : string</text><ellipse cx="18" cy="117.8359" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.6299" x="27" y="121.1826">role : string</text><ellipse cx="18" cy="134.1328" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119.7041" x="27" y="137.4795">photo_url : string</text><ellipse cx="18" cy="150.4297" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.0342" x="27" y="153.7764">iban : string</text><ellipse cx="18" cy="166.7266" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.1875" x="27" y="170.0732">balance : float</text><ellipse cx="18" cy="183.0234" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147.3965" x="27" y="186.3701">psp_id : integer &#171;FK&#187;</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="179.3965" y1="193.6719" y2="193.6719"/></g><!--class RTP--><g class="entity" data-entity="RTP" data-source-line="16" data-uid="ent0003" id="entity_RTP"><rect fill="#F1F1F1" height="178.375" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="226.3408" x="332.4" y="15.15"/><ellipse cx="427.9596" cy="31.15" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M432.0689,37.15 L424.3502,37.15 L424.3502,24.7594 L432.0689,24.7594 L432.0689,26.9156 L426.8033,26.9156 L426.8033,29.5875 L431.5689,29.5875 L431.5689,31.7437 L426.8033,31.7437 L426.8033,34.9937 L432.0689,34.9937 L432.0689,37.15 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.7217" x="448.4596" y="35.9967">RTP</text><line style="stroke:#181818;stroke-width:0.5;" x1="333.4" x2="557.7408" y1="47.15" y2="47.15"/><ellipse cx="343.4" cy="60.7984" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.7188" x="352.4" y="64.1451">id : integer &#171;PK&#187;</text><ellipse cx="343.4" cy="77.0953" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.0342" x="352.4" y="80.442">iban : string</text><ellipse cx="343.4" cy="93.3922" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.0869" x="352.4" y="96.7389">amount : float</text><ellipse cx="343.4" cy="109.6891" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.8242" x="352.4" y="113.0357">status : string</text><ellipse cx="343.4" cy="125.9859" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152.332" x="352.4" y="129.3326">timestamp : datetime</text><ellipse cx="343.4" cy="142.2828" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="200.3408" x="352.4" y="145.6295">beneficiary_id : integer &#171;FK&#187;</text><ellipse cx="343.4" cy="158.5797" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="162.4492" x="352.4" y="161.9264">payer_id : integer &#171;FK&#187;</text><ellipse cx="343.4" cy="174.8766" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109.6279" x="352.4" y="178.2232">concept : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="333.4" x2="557.7408" y1="185.525" y2="185.525"/></g><!--class Log--><g class="entity" data-entity="Log" data-source-line="27" data-uid="ent0004" id="entity_Log"><rect fill="#F1F1F1" height="129.4844" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="178.332" x="657.74" y="39.59"/><ellipse cx="730.03" cy="55.59" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M734.1394,61.59 L726.4207,61.59 L726.4207,49.1994 L734.1394,49.1994 L734.1394,51.3556 L728.8738,51.3556 L728.8738,54.0275 L733.6394,54.0275 L733.6394,56.1837 L728.8738,56.1837 L728.8738,59.4337 L734.1394,59.4337 L734.1394,61.59 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.252" x="750.53" y="60.4367">Log</text><line style="stroke:#181818;stroke-width:0.5;" x1="658.74" x2="835.072" y1="71.59" y2="71.59"/><ellipse cx="668.74" cy="85.2384" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.7188" x="677.74" y="88.5851">id : integer &#171;PK&#187;</text><ellipse cx="668.74" cy="101.5353" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.4609" x="677.74" y="104.882">rtp_id : integer &#171;FK&#187;</text><ellipse cx="668.74" cy="117.8322" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.166" x="677.74" y="121.1789">old_status : string</text><ellipse cx="668.74" cy="134.1291" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.7607" x="677.74" y="137.4757">new_status : string</text><ellipse cx="668.74" cy="150.4259" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152.332" x="677.74" y="153.7726">timestamp : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="658.74" x2="835.072" y1="161.0744" y2="161.0744"/></g><!--link Actor to RTP--><g class="link" data-entity-1="Actor" data-entity-2="RTP" data-source-line="35" data-uid="lnk5" id="link_Actor_RTP"><path codeLine="35" d="M188.73,104.33 C234.36,104.33 264.97,104.33 314.05,104.33" fill="none" id="Actor-RTP" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="184.73" x2="184.73" y1="108.33" y2="100.33"/><line style="stroke:#181818;stroke-width:1;" x1="187.73" x2="187.73" y1="108.33" y2="100.33"/><line style="stroke:#181818;stroke-width:1;" x1="188.73" x2="180.73" y1="104.33" y2="104.33"/><line style="stroke:#181818;stroke-width:1;" x1="324.05" x2="332.05" y1="104.33" y2="98.33"/><line style="stroke:#181818;stroke-width:1;" x1="324.05" x2="332.05" y1="104.33" y2="110.33"/><line style="stroke:#181818;stroke-width:1;" x1="324.05" x2="332.05" y1="104.33" y2="104.33"/><ellipse cx="318.05" cy="104.33" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.8032" x="211.4" y="100.3969">beneficiary_id</text></g><!--link Actor to RTP--><g class="link" data-entity-1="Actor" data-entity-2="RTP" data-source-line="36" data-uid="lnk6" id="link_Actor_RTP"><path codeLine="36" d="M188.4873,126.4057 C198.4773,128.1757 200.69,128.3 210.4,129.33 C251.05,133.68 261.66,132.89 302.4,129.33 C312.13,128.48 304.364,129.7341 314.444,128.3641" fill="none" id="Actor-RTP-1" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="183.8508" x2="185.2465" y1="129.6465" y2="121.7692"/><line style="stroke:#181818;stroke-width:1;" x1="186.8048" x2="188.2005" y1="130.1699" y2="122.2926"/><line style="stroke:#181818;stroke-width:1;" x1="188.4873" x2="180.61" y1="126.4057" y2="125.01"/><line style="stroke:#181818;stroke-width:1;" x1="324.3529" x2="331.472" y1="127.0174" y2="119.9947"/><line style="stroke:#181818;stroke-width:1;" x1="324.3529" x2="333.088" y1="127.0174" y2="131.8853"/><line style="stroke:#181818;stroke-width:1;" x1="324.3529" x2="332.28" y1="127.0174" y2="125.94"/><ellipse cx="318.4075" cy="127.8254" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.6182" x="228.9" y="125.3969">payer_id</text></g><!--link RTP to Log--><g class="link" data-entity-1="RTP" data-entity-2="Log" data-source-line="37" data-uid="lnk7" id="link_RTP_Log"><path codeLine="37" d="M566.88,104.33 C599.4,104.33 608.42,104.33 639.28,104.33" fill="none" id="RTP-Log" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="562.88" x2="562.88" y1="108.33" y2="100.33"/><line style="stroke:#181818;stroke-width:1;" x1="565.88" x2="565.88" y1="108.33" y2="100.33"/><line style="stroke:#181818;stroke-width:1;" x1="566.88" x2="558.88" y1="104.33" y2="104.33"/><line style="stroke:#181818;stroke-width:1;" x1="649.28" x2="657.28" y1="104.33" y2="98.33"/><line style="stroke:#181818;stroke-width:1;" x1="649.28" x2="657.28" y1="104.33" y2="110.33"/><line style="stroke:#181818;stroke-width:1;" x1="649.28" x2="657.28" y1="104.33" y2="104.33"/><ellipse cx="643.28" cy="104.33" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37.0576" x="589.74" y="100.3969">rtp_id</text></g><!--SRC=[ZPB1QiCm38RlUGgT1ts1K0gxxB8TojWzkBQI2Xmho0ebj7ltsKctaZIbE-hNB-l_X3tM2ieWr1mL70bQ9Gv5KM1GqW5UhRB0kG1u0N9G0WN51WMss_txRZVgVKG9fiNKZIeKcb7jJ8md5ZTNxtt2VZbvPEMg5p-NwM32N3aORuBDqxLdezDmxAf5qBSSzFiFwVDh_mJeVfDfkGywMnJLQ1_dDgKMazvsINP6CTTJKWnOaoKZmsgwwM03oiEkvKJQwMtV3UY3coT0ejt3XzcxQeqbuAdwDsCAC_sKosMpuVDuut91lURuPIvoUUradF8Q-GS0]--></g></svg>

# END FILE CONTENTS


# File: MemoriaTFG/src/conclusiones.tex

\chapter{Conclusiones}
\label{sec:Conclusiones}

El desarrollo de este TFG ha representado un esfuerzo significativo que ha culminado en la creación de un prototipo funcional de un servidor HTTP basado en el esquema RTP. El objetivo principal del proyecto —diseñar e implementar un software que simulara las operaciones fundamentales del esquema SEPA RTP utilizando tecnologías actuales y accesibles— se ha alcanzado con éxito. Este trabajo no solo me ha permitido poner en práctica los conocimientos adquiridos durante mi formación en telecomunicaciones y desarrollo de software, sino también explorar un ámbito tan relevante como los sistemas de pago digitales, que desempeñan un papel crucial en la economía global de hoy.

\vspace{0.5cm}

A nivel personal, este TFG ha sido una buena oportunidad para profundizar en el ecosistema SEPA y sus diferentes esquemas de pago. En particular, he podido analizar las limitaciones del SDD y contrastarlas con las ventajas que ofrece RTP. Este aprendizaje no se ha limitado al ámbito teórico: la implementación práctica del prototipo me ha enfrentado a retos técnicos que han fortalecido mis competencias como desarrollador.

\vspace{0.5cm}

El proceso de desarrollo también ha sido una lección sobre la importancia de una metodología bien definida, lo que me permitió avanzar de manera constante, detectar errores a tiempo y ajustar los objetivos según las necesidades del proyecto. Este enfoque estructurado, combinado con una documentación detallada de cada etapa, ha sido clave para mantener el control sobre el proyecto.
\vspace{0.5cm}


El sistema RTP se posiciona como un candidato ideal paraq convertirse en un estándar en la zona SEPA, especialmente a medida que más instituciones financieras y PSP adopten el esquema y lo integren en sus operaciones. En el futuro, es probable que RTP no solo facilite los pagos entre empresas y consumidores, sino que también fomente una mayor interoprabilidad y eficiencia en el mercado financiaro europeo, contribuyendo a una economía más conectada y dinámica.
\vspace{0.5cm}

\newpage
\null
\clearpage
\chapter{Líneas futuras}
\label{sec:Potencial}
En cuanto al prototipo desarollado, aunque satisface plenamente los objetivos establecidos para este TFG, su potencial va mucho más allá de un simple ejercicio acádemico. Durante el proceso identifiqué varias áreas de mejora que podrían transformar este simulador en una herramienta aplicable en escenarios reales. A continuación, detallo algunas de estas oportunidades de evolución:

\begin{enumerate}
    \item \textbf{Escalabilidad del sistema:} La base de datos SQLite, aunque suficiente para un prototipo, tiene limitaciones en térmninos de rendimiento y capacidad. Para soportar un mayor volumen de usuarios y transacciones, sería necesario migrar a un sistema más robusto como PostgreSQL o MySQL, que ofrecen mejor escalabilidad y soporte para entornos de producción.
    \item \textbf{Fortalecimiento de la seguridad:} El prototipo incluye medidas básicas de autenticación, pero un sistema real requeriría estándares más altos, como la encriptación de extremo a extremo, autenticación multifactor y cumplimiento con normativas como PSD2 (Payment Services Directive 2) y GDPR (General Data Protection Regulation). Estas mejoras garantizarían la protección de los datos sensibles y la confianza de los usuarios.
    \item \textbf{Interoperabilidad con sistemas bancarios:} Para que el prototipo trascienda su estado actual, sería esencial integrarlo con las APIs de bancos y PSP reales. Esto permitiría ejecutar transacciones monetarias auténticas y demostrar su utilidad en un contexto práctico, un paso crítico hacia su adopción en el mundo real.
    \item \textbf{Ampliación de funcionalidades:} El sistema podría enriquecerse con características avanzadas, como soporte para pagos recurrentes (ideal para suscripciones o facturas periódicas), compatibilidad con múltiples monedas (facilitando transacciones transfronterizas), herramientas analíticas que ofrezcan estadísticas a los usuarios, y reportes detallados sobre el historial de pagos. Estas adiciones harían que el sistema fuera más versátil y atractivo para distintos tipos de usuarios.
    \item \textbf{Mejora de la experiencia de usario:} Aunque el frontend actual es funcional, podría optimizarse con un diseño más moderno y accesible. Incorporar elementos como notificaciones push, un historial visual de transacciones, opciones de personalización y una interfaz adaptada a dispositivos móviles elevaría la usabilidad y la satisfacción del usuario.
\end{enumerate}

Estas mejoras, aunque son algo ambiciosas, son alcanzables con el tiempo y los recursos adecuados. Implementarlas no solo incrementaría la funcionalidad del prototipo, sino que también lo alinearía con las demandas de un mercado financiero en constante camnbio, donde la innovación y la adaptabilidad son esenciales.
\vspace{0.5cm}

# END FILE CONTENTS


# File: MemoriaTFG/src/implementacion.tex

%--------------------------------------------------------------------
% 4 Implementación – SEPA Request‑to‑Pay Prototype (Clase `article`)
%--------------------------------------------------------------------
\chapter{Implementación}
\label{sec:implementacion}

Este apartado traduce los principios definidos en el Diseño (Secc.~\ref{sec:diseno}) a código ejecutable. Cada subsección muestra la correspondencia entre los artefactos lógicos y su concreción en Python\,/\,JavaScript, de modo que se pueda verificar cómo se satisfacen los requisitos \textbf{RF} y \textbf{RNF} enumerados anteriormente.

%---------------------------------------------------------------
% 4.1 Visión general de la arquitectura y organización del código
%---------------------------------------------------------------
\section{Visión general de la arquitectura y organización del código}
\label{sec:impl-vision}

\noindent
La implementación del prototipo para simular un proveedor del esquema SRTP requiere una arquitectura robusta y una organización del código que garanticen la claridad, la mantenibilidad y la alineación con los requisitos establecidos en los capítulos anteriores. Este apartado ofrece una descripción detallada de la arquitectura general del sistema, explicando cómo se han estructurado sus componentes y cómo estos interactúan para cumplir con los objetivos del proyecto. Asimismo, se presenta la organización del código fuente, incluyendo la estructura de directorios, para ilustrar cómo se ha traducido el diseño conceptual del capítulo 3 en una implementación práctica. Esta sección no solo busca documentar las decisiones técnicas tomadas, sino también demostrar cómo el sistema aborda las limitaciones del SDD identificadas en la sección \ref{subsec:Motivacion}, como la necesidad de procesos más ágiles y en tiempo real.

La arquitectura adoptada se fundamenta en principios de modularidad, escalabilidad y separación de preocupaciones, lo que permite que cada parte del sistema tenga un propósito claro y que las interacciones entre componentes sean eficientes. A continuación, se describen los elementos clave de la arquitectura general, seguidos por una explicación de la organización del código y su estructura de directorios, acompañada de ejemplos concretos que refuerzan la conexión entre el diseño y la implementación.

\subsection{Componentes del servidor}
\label{subsec:componentes-del.serv}
\begin{itemize}
    \item \textbf{Capa de persistencia}: Esta capa se encarga de gestionar los datos del sistema utilizando un enfoque basado en modelos ORM (Object-Relational Mapping). Los modelos definidos aquí, como la entidad \texttt{RTP} que representa una solicitud de pago, están alineados con el diseño de la base de datos descrito en la sección \ref{subsec:diseno_datos}. La persistencia asegura que la información se almacene de forma estructurada y sea accesible para las operaciones del SRTP.
    
    \item \textbf{Capa de servicios de negocio}: Aquí reside la lógica central del prototipo, implementando las transiciones de estado del flujo SRTP (creación, validación, enrutamiento y decisión). Cada servicio está diseñado como un módulo independiente que encapsula las reglas de negocio, garantizando que las operaciones cumplan con los requisitos funcionales y no funcionales establecidos en el capítulo \ref{sec:diseno}.
    
    \item \textbf{Capa de interfaz pública}: Expone las funcionalidades del sistema mediante una API REST y un sistema de comunicación en tiempo real basado en WebSockets. La API REST ofrece endpoints bien definidos para operaciones síncronas, mientras que los WebSockets permiten notificaciones instantáneas a los actores, abordando directamente las ineficiencias de los ciclos de cobro del SDD mencionadas en la sección \ref{subsec:ineficiencias}.
\end{itemize}

\paragraph{Cliente}

El cliente es una aplicación web desarrollada con Vue.js, seleccionada por su capacidad para crear interfaces reactivas y dinámicas. Esta aplicación permite a los usuarios visualizar y gestionar solicitudes RTP, desde la creación por parte del beneficiario hasta la aceptación o rechazo por el pagador. La comunicación con el servidor se realiza a través de la API REST para operaciones como la creación de solicitudes, y mediante WebSockets para actualizaciones en tiempo real, como cambios de estado.

\paragraph{Interacción entre componentes}

La interacción entre el cliente y el servidor es un aspecto crítico del sistema. Por ejemplo, cuando un beneficiario crea una solicitud RTP, el cliente envía una petición a través de un endpoint REST al servidor, que procesa la solicitud en la capa de servicios y la almacena en la capa de persistencia. Una vez procesada, el servidor notifica a los actores relevantes mediante WebSockets, actualizando la interfaz del cliente en tiempo real. Este flujo refleja las decisiones de diseño de la sección \ref{subsec:diseno_requisitos}, donde se priorizó la agilidad y la inmediatez en las operaciones.


%---------------------------------------------------------------
\subsection{Estructura de directorios}
%---------------------------------------------------------------
\label{sec:impl-vision-tree}

La organización del código fuente ha sido diseñada para reflejar la arquitectura en capas del sistema y facilitar tanto el desarrollo como el mantenimiento del prototipo. La estructura de directorios de la figura \ref{fig:treeB} está pensada para que los desarrolladores puedan localizar rápidamente los componentes clave y comprender su propósito dentro del proyecto. A continuación, se detalla la estructura principal :

\vspace{.6em}
\paragraph*{Backend.}
Los ocho módulos Python se bastan para ofrecer una capa de servicios
coherente, auditable y sin dependencias circulares:

\begin{itemize}
  \item \texttt{app.py} actúa como \emph{bootstrap} del marco Flask;
        instancia la aplicación, registra los \emph{blueprints},
        inicializa la base de datos y arranca el \emph{Notification Hub}
        basado en Socket.IO, de modo que HTTP y WebSocket
        comparten proceso y puerto.
  \item \texttt{config.py} encapsula los parámetros de despliegue
        y proporciona
        valores seguros por defecto para ejecutarse
        en entornos de desarrollo sin intervención manual.
  \item \texttt{ext\_socketio.py} mantiene una única instancia global
        de \texttt{SocketIO}; centraliza la creación de salas
        y la emisión de eventos para evitar duplicidades y facilitar
        un eventual cambio de motor de concurrencia.
  \item \texttt{models.py} define las entidades
        \emph{Actor}, \emph{RTP} y \emph{Log} con SQLAlchemy,
        garantizando la integridad referencial y sellando cada transición
        con un hash SHA-256 que permite auditar el histórico.
  \item \texttt{routes.py} expone los cinco endpoints REST
        que materializan la máquina de estados SRTP; cada manejador se
        limita a validar parámetros y delegar la lógica en los servicios.
  \item \texttt{routes\_actors.py} ofrece
        operaciones auxiliares—registro y consulta de actores—que,
        aun no formando parte del flujo SRTP, resultan imprescindibles
        para montar un entorno de pruebas auto-contenido.
  \item \texttt{services.py} orquesta la lógica de dominio:
        comprueba pre-condiciones, transforma el estado,
        persiste los cambios y publica las notificaciones correspondientes;
        de esta forma aísla los detalles del transporte (REST o WebSocket)
        y favorece las pruebas unitarias.
  \item \texttt{utils.py} y \texttt{utils\_roles.py} concentran
        utilidades transversales: la primera agrupa funciones de apoyo
        (p.\,ej.\  \texttt{cambiar\_estado\_rtp} o la validación de IBAN),
        mientras que la segunda implementa el decorador
        \texttt{@role\_required}, responsable de aplicar el control de
        acceso antes de ejecutar cada endpoint.
\end{itemize}

\paragraph*{Frontend.}
Los recursos estáticos se limitan a cinco archivos, suficientes para
construir una SPA ligera pero reactiva:

\begin{itemize}
  \item \texttt{index.html} sirve de punto de entrada.
        Además de la cabecera de navegación, contiene el
        contenedor \texttt{\textless{}div id="root"\textgreater{}} donde los
        módulos JavaScript inyectan las vistas solicitadas.
  \item \texttt{RTP.html} almacena la plantilla que representa el
        \emph{workflow} SRTP; se carga bajo demanda para evitar penalizar
        el \emph{time-to-first-paint}.
  \item \texttt{styles.css} define la paleta corporativa, el
        \emph{grid} de disposición y las transiciones que dotan de
        fluidez a los cambios de estado.
  \item \texttt{app.js} gestiona la autenticación,
        el enrutado de vistas
        y la apertura de la conexión WebSocket, mostrando indicadores de
        estado (conectado, reconectando, \dots) sin recargar la página.
  \item \texttt{RTP.js} implementa toda la lógica de cliente
        relacionada con las solicitudes: construcción de formularios,
        llamadas al API REST y actualización en tiempo real de la tabla
        de notificaciones cuando llegan los eventos \emph{push}.
\end{itemize}

\vspace{.2em}
\paragraph*{Síntesis y trazabilidad.}
Esta disposición jerárquica refleja en el código la arquitectura
conceptual del capítulo \ref{sec:diseno}: la capa de presentación
(\emph{frontend}) permanece aislada de la de negocio
(\emph{backend}); la única superficie de contacto es la API REST
y el canal WebSocket, ambos documentados y versionados.
Gracias a ello, cualquier sustitución—cambiar el
motor de base de datos, desplegar la SPA en un CDN o
servir las peticiones HTTP detrás de un WAF—puede acometerse
sin modificar las capas restantes, cumpliendo así los
RNF de portabilidad y mantenibilidad establecidos
para el prototipo.

\begin{figure}[htbp]
  \centering
  \includegraphics[width=.85\textwidth]{Imagenes/treeB.pdf}
  \caption{Estructura en árbol del directorio}
  \label{fig:treeB}
\end{figure}

Esta estructura promueve la modularidad y el aislamiento de responsabilidades. Por ejemplo, la separación entre \textbf{/models} y \textbf{/services} permite modificar la lógica de negocio sin afectar la persistencia.

%----------------------------------------------------------------
\subsection{Satisfacción de requisitos}
%----------------------------------------------------------------
Este subapartado tiene como objetivo demostrar de manera detallada cómo el prototipo implementado cumple con cada uno de los \textbf{requisitos funcionales (RF)} y \textbf{no funcionales (RNF)} establecidos en el capítulo \ref{sec:diseno}. Para cada requisito, se proporciona una explicación de su propósito dentro del flujo del esquema SRTP, se referencian los fragmentos de código que materializan la solución y se indica la ruta del archivo donde se aloja dicha lógica. Los fragmentos de código se han incluido en el \emph{Índice de listados} al final de la memoria para facilitar su localización y consulta.

La estructura de este apartado sigue el orden de los requisitos tal como fueron definidos, comenzando por los funcionales y continuando con los no funcionales. Cada explicación busca no solo describir la implementación, sino también conectar la solución técnica con las necesidades operativas del SRTP, destacando cómo el prototipo supera las limitaciones identificadas en el SEPA Direct Debit (SDD).

\begin{description}
%---------------------------------------------------------------
\item[RF-01 — Crear solicitud RTP]  
El primer requisito funcional, RF-01, se refiere a la capacidad del Beneficiario para crear una solicitud de pago RTP. Este paso es crucial en el flujo SRTP, ya que inicia el proceso de cobro y establece los parámetros de la transacción, como el IBAN del deudor, el importe y el concepto del pago. En el prototipo, esta funcionalidad se implementa mediante una petición HTTP POST al endpoint \texttt{/rtp}, que es gestionada por el backend para generar y persistir la entidad RTP en la base de datos.

La lógica principal de este requisito se encuentra en el archivo \texttt{services.py}, específicamente en la función encargada de crear la solicitud RTP. El fragmento de código correspondiente, mostrado en el Listado~\ref{lst:1}, realiza varias tareas clave: valida los datos de entrada, genera un hash idempotente para garantizar la unicidad de la solicitud y persiste la entidad en la base de datos con el estado inicial \textit{creado}. Este hash es fundamental para evitar duplicaciones y asegurar la integridad de las solicitudes, abordando así una de las ineficiencias operativas del SDD relacionadas con la gestión manual de mandatos.

El endpoint REST que expone esta funcionalidad al frontend se define en \texttt{routes.py}, y su implementación se presenta en el Listado~\ref{lst:2}. Este handler recibe la petición del cliente, delega la lógica de negocio al servicio correspondiente y devuelve una respuesta adecuada. Desde el lado del cliente, el archivo \texttt{RTP.js} contiene la rutina JavaScript que serializa los datos del formulario y envía la petición POST al backend, como se muestra en el Listado~\ref{lst:3}. Esta interacción entre el frontend y el backend asegura que el Beneficiario pueda crear solicitudes RTP de manera intuitiva y eficiente, cumpliendo con el requisito RF-01.

%---------------------------------------------------------------
\item[RF-02 — Validar y enrutar (PSP Beneficiary)]  
El requisito RF-02 abarca dos acciones críticas realizadas por el PSP del Beneficiario: la validación de la solicitud RTP y su posterior enrutamiento hacia el PSP del Pagador. La validación implica verificar la corrección sintáctica de los datos, como la validez de los IBAN y la coherencia del importe, mientras que el enrutamiento consiste en preparar la solicitud para su envío al siguiente actor en el flujo SRTP.

Para la validación, el prototipo utiliza un algoritmo para comprobar la validez de los IBAN, implementado en la función correspondiente del archivo \texttt{utils.py}, como se detalla en el Listado~\ref{lst:6}. Este paso es esencial para prevenir errores en las transacciones y garantizar la integridad de los datos antes de proceder con el enrutamiento.

Una vez validada la solicitud, los servicios definidos en \texttt{services.py} actualizan el estado de la entidad RTP a \textit{validado\_beneficiario} y posteriormente a \textit{enrutado}, notificando al PSP del Pagador sobre la nueva solicitud. Estos servicios se presentan en el Listado~\ref{lst:4}. Los controladores REST que exponen estas funcionalidades se encuentran en \texttt{routes.py}, específicamente en los endpoints dedicados a la validación y enrutamiento, como se muestra en el Listado~\ref{lst:5}. En el frontend, el archivo \texttt{RTP.js} incluye la lógica para que el PSP del Beneficiario pueda disparar estas acciones a través de la interfaz de usuario, como se ilustra en el Listado~\ref{lst:7}. Esta implementación asegura que el proceso de validación y enrutamiento sea transparente y eficiente, cumpliendo con el requisito RF-02 y mejorando la agilidad operativa en comparación con los ciclos de cobro lentos del SDD.

%---------------------------------------------------------------
\item[RF-03 — Validación KYC / AML (PSP Payer)]  
El requisito RF-03 se centra en la validación que realiza el PSP del Pagador antes de presentar la solicitud RTP al usuario final. Esta validación incluye comprobaciones de legitimidad, como la verificación de fondos suficientes y el cumplimiento de normativas KYC y AML, aunque en este prototipo se simplifica a la verificación de saldo disponible.

La lógica de este requisito se implementa en el archivo \texttt{services.py}, donde se define la función que realiza la validación del pagador. El fragmento de código correspondiente, presentado en el Listado~\ref{lst:8}, consulta el saldo del pagador y determina si la solicitud puede proceder. Si los fondos son insuficientes, la solicitud se marca como rechazada; de lo contrario, se actualiza el estado a \textit{validado\_payer}. El endpoint REST que expone esta funcionalidad se encuentra en \texttt{routes.py}, como se muestra en el Listado~\ref{lst:9}, y es consumido por el cliente a través de la lógica JavaScript en \texttt{RTP.js}, detallada en el Listado~\ref{lst:10}. Esta implementación asegura que solo las solicitudes viables financieramente lleguen al pagador, reduciendo el riesgo de transacciones fallidas y mejorando la experiencia del usuario en comparación con el SDD.

%---------------------------------------------------------------
\item[RF-04 — Decisión del pagador]  
Una vez que la solicitud RTP ha sido validada por el PSP del Pagador, el requisito RF-04 permite al pagador tomar una decisión final: aceptar o rechazar la solicitud. Esta acción es crítica, ya que determina el resultado de la transacción y, en caso de aceptación, desencadena la transferencia de fondos.

En el prototipo, la decisión del pagador se gestiona a través de un formulario en la interfaz de usuario, implementado en \texttt{RTP.js}. El fragmento de código correspondiente, mostrado en el Listado~\ref{lst:13}, envía la decisión del usuario al backend mediante una petición POST al endpoint \texttt{/rtp/\{id\}/decision}. Este endpoint, definido en \texttt{routes.py} y presentado en el Listado~\ref{lst:12}, delega la lógica de negocio al servicio correspondiente en \texttt{services.py}. El servicio de decisión, detallado en el Listado~\ref{lst:11}, procesa la elección del pagador: si se acepta la solicitud y hay fondos suficientes, se descuenta el importe de la cuenta del pagador y se actualiza el estado de la solicitud a \textit{aceptado}. En caso de rechazo o falta de fondos, se marca como \textit{rechazado} y se genera un código de motivo adecuado. Esta implementación asegura que el pagador tenga control total sobre la transacción, cumpliendo con el requisito RF-04 y proporcionando una experiencia más segura y transparente que el SDD.

%---------------------------------------------------------------
\item[RF-05 — Notificación en tiempo real]  
El requisito RF-05 establece la necesidad de notificar a los actores involucrados sobre los cambios de estado de las solicitudes RTP en tiempo real. Esto es fundamental para mantener a todas las partes informadas y permitir una respuesta rápida, especialmente en comparación con los procesos offline del SDD.

Para cumplir con este requisito, el prototipo utiliza WebSockets a través de la biblioteca Flask-SocketIO. El \emph{hub} de notificaciones, configurado en \texttt{ext\_socketio.py} y mostrado en el Listado~\ref{lst:14}, mantiene una \textit{room} para cada actor, permitiendo la emisión de eventos específicos a los usuarios correctos. Por ejemplo, cuando se toma una decisión sobre una solicitud RTP, el servicio en \texttt{services.py} emite un evento \texttt{rtp\_decision} al Beneficiario, como se ilustra en el Listado~\ref{lst:15}. En el frontend, el archivo \texttt{RTP.js} incluye listeners que reaccionan a estos eventos, actualizando la interfaz de usuario sin necesidad de recargar la página, como se detalla en el Listado~\ref{lst:16}. Esta implementación garantiza que las notificaciones sean instantáneas y que el sistema sea reactivo, cumpliendo con el requisito RF-05.

%---------------------------------------------------------------
\item[RF-06 — Cancelación previa a la decisión]  
El requisito RF-06, que permite la cancelación de una solicitud RTP antes de que el pagador tome una decisión, no se ha implementado en esta versión del prototipo. Aunque está planificado para futuras iteraciones, su omisión en la versión actual se debe a que no aporta valor significativo para los objetivos de este TFG. En versiones posteriores, se añadirá un servicio \texttt{cancel\_rtp\_service} y un endpoint \texttt{DELETE /rtp/\{id\}} siguiendo la estructura de los requisitos anteriores.

%---------------------------------------------------------------
\item[RNF-01 — Documentación interna]  
El requisito no funcional RNF-01 exige una documentación interna adecuada del código y del sistema. Este requisito se cumple mediante la presente memoria, que describe detalladamente el diseño y la implementación del prototipo, así como a través de los comentarios incluidos en todos los módulos Python del proyecto. No se requiere un fragmento de código específico para este requisito, ya que la documentación es transversal a todo el desarrollo.

%---------------------------------------------------------------
\item[RNF-02 — Seguridad y trazabilidad]  
El requisito RNF-02 se centra en la seguridad y la trazabilidad de las operaciones dentro del sistema. En el prototipo, la seguridad se delega parcialmente al proxy inverso (Nginx), que gestiona el cifrado TLS. Sin embargo, la trazabilidad se implementa directamente en el backend mediante el cálculo de un hash SHA-256 para cada cambio de estado de las solicitudes RTP. Este hash, generado en la función correspondiente de \texttt{utils.py} y mostrado en el Listado~\ref{lst:17}, asegura la integridad de los registros de transiciones de estado. Cada cambio se persiste en la tabla \texttt{Log} de la base de datos, junto con un sellado temporal, como se define en el modelo ORM de \texttt{models.py} presentado en el Listado~\ref{lst:18}. Esta implementación proporciona una auditoría completa de las operaciones, cumpliendo con el requisito de trazabilidad.

%---------------------------------------------------------------
\item[RNF-03 — Portabilidad (Python 3.12 + SQLite)]  
El requisito RNF-03 exige que el sistema sea portable y fácil de desplegar en diferentes entornos. Para ello, la configuración de la base de datos y otros parámetros se centralizan en el archivo \texttt{config.py}, donde se define la URI de la base de datos SQLite, como se muestra en el Listado~\ref{lst:19}. Además, el archivo \texttt{requirements.txt}, presentado en el Listado~\ref{lst:20}, lista todas las dependencias del proyecto con versiones específicas, garantizando una instalación reproducible. La secuencia de arranque del servidor, incluyendo la creación de la base de datos y la carga de actores predefinidos, se gestiona en \texttt{app.py}, como se ilustra en el Listado~\ref{lst:21}. Esta configuración permite que el prototipo sea fácilmente portable y desplegable en cualquier sistema que soporte Python 3.12 y SQLite, cumpliendo con el requisito RNF-03.

%---------------------------------------------------------------

\end{description}

En resumen, este subapartado ha demostrado cómo cada requisito funcional y no funcional ha sido abordado en el prototipo, ya sea mediante la implementación de lógica específica, configuraciones de despliegue o documentación adecuada. La trazabilidad entre los requisitos y el código asegura que el sistema no solo funcione correctamente, sino que también cumpla con los estándares de calidad y operatividad establecidos en el capítulo \ref{sec:diseno}.

%-------------------------- Fin de § 4.1 --------------------------



\section{Persistencia y modelos ORM}
\label{subsec:orm}

Este apartado detalla la capa de persistencia del prototipo, abordando dos aspectos fundamentales: (i) la \textbf{elección del motor de base de datos} que soporta el sistema y (ii) la \textbf{descripción de los tres modelos de dominio} que se persisten mediante SQLAlchemy. Estas decisiones son esenciales para garantizar la fiabilidad, portabilidad y escalabilidad del sistema, alineándose con los requisitos establecidos en el Capítulo 3.

%................................................................
\paragraph*{Motor de base de datos}

Para el desarrollo y las pruebas del prototipo, se ha seleccionado \textbf{SQLite 3} como motor de base de datos, debido a sus características que lo hacen idóneo para este contexto. Los motivos principales de esta elección se detallan a continuación:

\begin{enumerate}
    \item \textbf{Cero configuración}: SQLite no requiere configuración previa, lo que simplifica su uso en entornos de desarrollo y pruebas. El archivo de la base de datos, \texttt{rtp.db}, se genera automáticamente al iniciar la aplicación y puede eliminarse o recrearse fácilmente, facilitando las pruebas automáticas en pipelines de integración y despliegue continuo (CI/CD). Esto permite una iteración rápida sin la complejidad de administrar un servidor dedicado.
    
    \item \textbf{Compatibilidad con SQLAlchemy 2}: SQLite se integra perfectamente con SQLAlchemy 2, el ORM empleado en este proyecto. Gracias a la API declarativa de SQLAlchemy, las interacciones con la base de datos quedan abstraídas, permitiendo que el código sea portable a otros motores como PostgreSQL con solo modificar la variable \texttt{SQLALCHEMY\_DATABASE\_URI} en el archivo \texttt{config.py} (véase Listado~\ref{lst:19}). Esta flexibilidad asegura una posible escalabilidad futura sin necesidad de refactorizar el código.
    
    \item \textbf{Licencia y footprint}: SQLite es de dominio público y su biblioteca ocupa menos de 1 MB, lo que lo hace extremadamente ligero y portable. Esta característica cumple con el requisito no funcional RNF-03, que exige que el sistema sea fácilmente desplegable en diferentes entornos, reduciendo la complejidad y los recursos necesarios para su ejecución.
\end{enumerate}

La inicialización del motor de base de datos y la creación de las tablas se realizan automáticamente durante el proceso de \emph{bootstrap} de la aplicación, como se muestra en el Listado~\ref{lst:21}. Esto asegura un entorno consistente para el desarrollo y las pruebas.

%................................................................
\paragraph*{Modelo de datos}

El esquema de la base de datos consta de \textbf{tres tablas} que representan los conceptos clave del dominio SRTP, definidos en el capítulo \ref{subsec:diseno_datos}. A continuación, se describen los modelos de datos implementados:

\begin{enumerate}[label=\arabic*)]
    \item \textbf{Actor}: Este modelo representa a los actores involucrados en el flujo SRTP, como pagadores, beneficiarios y proveedores de servicios de pago (PSPs). Incluye atributos como \texttt{id}, \texttt{username}, \texttt{password}, \texttt{name}, \texttt{role} (que define su función en el sistema), y opcionalmente \texttt{psp\_id}, una clave foránea que referencia a otro actor que actúa como PSP. Además, cuenta con campos como \texttt{iban}, \texttt{balance} y \texttt{photo\_url} para gestionar información financiera y visual. La definición completa se encuentra en el Listado~\ref{lst:22}.
    
    \item \textbf{RTP}: El modelo \texttt{RTP} es la entidad transaccional principal, que encapsula la información de una solicitud de pago Request-to-Pay. Sus atributos incluyen \texttt{iban}, \texttt{amount}, \texttt{status} (inicialmente "creado", siguiendo la máquina de estados de la Figura 3-2), \texttt{timestamp}, y referencias a los actores involucrados (\texttt{beneficiary\_id}, \texttt{psp\_beneficiary\_id}, \texttt{psp\_payer\_id}, \texttt{payer\_id}). Este modelo asegura la integridad de las solicitudes y cumple con el requisito funcional RF-01. Su esquema completo está en el Listado~\ref{lst:23}.
    
    \item \textbf{Log}: El modelo \texttt{Log} proporciona trazabilidad al registrar las transiciones de estado de las solicitudes RTP. Cada entrada incluye \texttt{rtp\_id}, \texttt{old\_status}, \texttt{new\_status}, \texttt{timestamp} y \texttt{hash\_value}. Esto satisface el requisito no funcional RNF-03 de trazabilidad. La implementación se detalla en el Listado~\ref{lst:24}.
\end{enumerate}

%................................................................
\paragraph*{Conclusión}

En conclusión, la capa de persistencia del prototipo utiliza SQLite por su simplicidad y portabilidad, mientras que SQLAlchemy abstrae las interacciones con la base de datos, ofreciendo flexibilidad para futuras migraciones. Los modelos \texttt{Actor}, \texttt{RTP} y \texttt{Log} cubren todas las necesidades del flujo SRTP, desde la gestión de actores hasta la auditoría de transacciones, sentando las bases para un sistema robusto y escalable.


\section{Servicios de dominio}
\label{subsec:servicios_dominio}

% Introduciendo el propósito y la relación con el capítulo 3
El apartado 4.3 presenta la implementación de los servicios de dominio dentro del prototipo SRTP, una capa crítica que encapsula la lógica de negocio responsable de gestionar el ciclo de vida de las solicitudes RTP. Esta capa se basa en la arquitectura lógica descrita en el capítulo \ref{sec:diseno}, específicamente en la sección \ref{subsec:diseno_arquitectura}, donde se define el componente de servicios de aplicación como el encargado de coordinar las operaciones del sistema. Los servicios de dominio traducen los conceptos teóricos de la máquina de estados (figura \ref{fig:state_machine_rtp}) en funciones prácticas que aseguran la correcta ejecución de los procesos de creación, validación, enrutamiento y resolución de solicitudes RTP, cumpliendo con los requisitos funcionales establecidos.

% Describiendo el módulo central y su rol
La implementación de esta lógica se concentra en el módulo \texttt{services.py}, ubicado en el directorio \texttt{backend/} del prototipo. Este módulo actúa como el corazón operativo del sistema, proporcionando una interfaz programática que los controladores REST (definidos en \texttt{routes.py}) y los eventos WebSocket utilizan para interactuar con la base de datos y los actores del flujo SRTP. Su diseño respeta los principios de cohesión y bajo acoplamiento descritos en el capítulo 3, permitiendo que las operaciones de negocio sean independientes de los detalles de presentación o transporte.

% Estableciendo el patrón general de los servicios
\section*{4.3.1 Estructura de los servicios}

% Detallando el flujo común de los servicios
Cada servicio de dominio sigue una estructura estandarizada que garantiza consistencia y robustez en la ejecución de las operaciones. Esta estructura incluye:

\begin{enumerate}
    \item \textbf{Inicio transaccional}: Cada operación se encapsula en una transacción gestionada por SQLAlchemy, iniciada con \texttt{session.begin()}. Esto asegura que los cambios en la base de datos sean atómicos, evitando estados inconsistentes en caso de fallos.
    \item \textbf{Validación de condiciones}: Antes de proceder, el servicio comprueba las condiciones previas, como el estado actual de la solicitud RTP en la máquina de estados y los permisos del actor que realiza la acción.
    \item \textbf{Ejecución de la lógica}: Se actualizan los modelos de datos relevantes (por ejemplo, la entidad \texttt{RTP}) y se registra la operación en la tabla de auditoría \texttt{Log}, cumpliendo con el requisito no funcional de trazabilidad.
    \item \textbf{Notificación}: Tras confirmar la transacción con \texttt{session.commit()}, se emite un evento a través de Socket.IO para informar a los actores involucrados, satisfaciendo el requisito funcional RF-04 de comunicación en tiempo real.
\end{enumerate}

% Explicando los servicios específicos implementados
\section*{4.3.2 Descripción de los servicios implementados}

% Listando y describiendo cada servicio
A continuación, se describen los servicios clave implementados en \texttt{services.py}, cada uno asociado a una etapa del flujo SRTP:

\begin{itemize}
    \item \textbf{\texttt{crear\_rtp\_service}}: Permite al Beneficiario iniciar una solicitud RTP. Valida los parámetros de entrada (como IBAN y cantidad) y crea un registro en la base de datos con el estado inicial "pendiente". Este servicio satisface el requisito RF-01 y se muestra en el listado \ref{lst:1}.
    \item \textbf{\texttt{validar\_beneficiario\_service}}: Ejecutado por el PSP del Beneficiario, este servicio verifica la solicitud en términos de formato y autenticidad, actualizando su estado a "validada". Cumple con RF-02 y depende de la transición "pendiente $\rightarrow$ validada" de la máquina de estados. Se muestra en el listado \ref{lst:4}.
    \item \textbf{\texttt{enrutar\_rtp\_service}}: Enruta la solicitud validada al PSP del Pagador, cambiando el estado a "enrutada" y notificando al siguiente actor. Este servicio también está vinculado a RF-02 y se detalla en el \ref{lst:4}.
    \item \textbf{\textbf{validatar\_payer\_service}}: Ejecutado por el PSP del pagador. Este servicio verifica el RTP antes de enviarlo al pagador para la decisión final. Se detalla en el listado \ref{lst:8}
    \item \textbf{\texttt{decision\_payer\_service}}: Permite al Pagador aceptar o rechazar la solicitud. Si se acepta, el estado pasa a "completada"; si se rechaza, a "rechazada". Este servicio cumple con RF-03 y es el paso final del flujo básico del SRTP. Se muestra en el listado \ref{lst:11}
\end{itemize}

% Concluyendo con la relevancia y extensibilidad
\section{API REST y WebSocket}
\label{subsec:api_ws}

La API REST del sistema SRTP proporciona una interfaz programática que permite la interacción con las funcionalidades principales del prototipo. Esta API sigue los principios RESTful, utilizando métodos HTTP estándar para gestionar recursos como las solicitudes Request-to-Pay (RTP) y los actores del sistema. Para organizar las rutas de manera eficiente, la implementación se estructura en dos blueprints de Flask: \texttt{rtp} y \texttt{actors}, lo que mejora la modularidad y facilita el mantenimiento y la escalabilidad del código.

\section{Blueprints y su propósito}

Los blueprints son una característica de Flask que permite dividir la lógica de las rutas en módulos independientes. En este sistema, se han definido dos blueprints:

\begin{itemize}
    \item \textbf{Blueprint \texttt{rtp}}: Agrupa los endpoints relacionados con la gestión del ciclo de vida de las solicitudes RTP, incluyendo su creación, validación por parte de los PSPs, enrutamiento y decisión final del pagador. Además, incluye funcionalidades adicionales como la autenticación, la gestión de perfiles, la creación de actores y la obtención de logs.
    \item \textbf{Blueprint \texttt{actors}}: Se centra específicamente en la creación de actores del sistema, como beneficiarios, pagadores y PSPs, proporcionando una interfaz dedicada para esta funcionalidad.
\end{itemize}

Esta estructura modular permite una clara separación de responsabilidades y simplifica la extensión del sistema en el futuro.

\section{Endpoints REST}

A continuación, se presenta una tabla con todos los endpoints REST disponibles en la API, el método HTTP, la URL y una breve descripción de su funcionalidad.

\begin{table}[H]
    \centering
    \caption{Endpoints REST del sistema SRTP}
    \label{tab:endpoints}
    \begin{tabular}{@{}p{2cm}p{5cm}p{7cm}@{}}
        \toprule
        \textbf{Método} & \textbf{URL} & \textbf{Descripción} \\
        \midrule
        POST & /rtp & Crea una nueva solicitud RTP. Requiere rol \texttt{beneficiary}. \\
        POST & /rtp/\textless int:rtp\_id\textgreater /validate-beneficiary & Valida la RTP por el PSP del beneficiario. Requiere rol \texttt{psp\_beneficiary}. \\
        POST & /rtp/\textless int:rtp\_id\textgreater /route & Enruta la RTP al PSP del pagador. Requiere rol \texttt{psp\_beneficiary}. \\
        POST & /rtp/\textless int:rtp\_id\textgreater /validate-payer & Valida la RTP por el PSP del pagador. Requiere rol \texttt{psp\_payer}. \\
        POST & /rtp/\textless int:rtp\_id\textgreater /decision & Registra la decisión final del pagador sobre la RTP. Requiere rol \texttt{payer}. \\
        GET & /logs & Obtiene los logs del sistema para auditoría y monitoreo. \\
        POST & /actors & Crea un nuevo actor en el sistema (beneficiario, pagador o PSP). \\
        GET & /actors\_info/\textless int:actor\_id\textgreater & Obtiene información detallada de un actor específico. \\
        POST & /login & Autentica a un usuario y devuelve información del actor. \\
        GET & /profile/\textless int:actor\_id\textgreater & Obtiene el perfil de un actor específico. \\
        POST & /profile & Actualiza el perfil de un actor. Requiere rol \texttt{payer}. \\
        \bottomrule
    \end{tabular}
\end{table}


\section{Frontend y notificaciones}
\label{subsec:frontend}

% Introduciendo el propósito del apartado
Este apartado describe la implementación del frontend del prototipo SRTP, que proporciona una interfaz de usuario intuitiva para interactuar con las funcionalidades del sistema, y el mecanismo de notificaciones en tiempo real que mantiene informados a los actores. El frontend, alineado con los requisitos funcionales del Capítulo 3, permite a los usuarios (beneficiarios, PSPs y pagadores) gestionar solicitudes RTP y acceder a sus perfiles, mientras que el sistema de notificaciones asegura una comunicación ágil, como se detalla en el requisito funcional RF-05.

\subsection*{4.7.1 \; Frontend}

% Describiendo la estructura y tecnologías del frontend
El frontend está implementado como una aplicación web de página única (SPA-like) que utiliza tecnologías modernas para ofrecer una experiencia de usuario fluida. La interfaz se basa en los siguientes componentes tecnológicos:

\begin{itemize}
    \item \textbf{HTML5 y Bootstrap 5}: La estructura de la interfaz se define en \texttt{index.html}, utilizando Bootstrap para un diseño responsivo y componentes preestilizados como tarjetas, formularios y barras de navegación. La sección principal se divide en vistas dinámicas (dashboard, cuentas, tarjetas, perfil y RTP) que se muestran u ocultan según las acciones del usuario.
    \item \textbf{CSS personalizado}: El archivo \texttt{styles.css} define estilos adicionales, como gradientes de fondo, animaciones de transición (\texttt{fadeIn}) y ajustes visuales para elementos como el círculo de saldo y la foto de perfil. Las fuentes \texttt{Montserrat} y \texttt{Great Vibes} aportan una estética moderna y profesional.
    \item \textbf{JavaScript y Socket.IO}: La lógica del cliente se implementa en \texttt{app.js} y \texttt{RTP.js}. El primero gestiona la autenticación, el cambio de vistas y la carga de datos del perfil, mientras que el segundo se encarga de las interacciones específicas con las solicitudes RTP. Socket.IO facilita la comunicación en tiempo real con el backend.
\end{itemize}

% Explicando la funcionalidad principal
La interfaz comienza con una pantalla de inicio de sesión (\texttt{loginSection} en \texttt{index.html}) que autentica a los actores mediante una solicitud POST al endpoint \texttt{/login}. Tras un login exitoso, se muestra la barra de navegación y el contenido principal, con un dashboard inicial que presenta información del actor (nombre, IBAN, saldo y foto). La función \texttt{cargarHomeDashboard} obtiene estos datos desde el endpoint \texttt{/profile/<actor\_id>} y los formatea para su visualización, ajustando dinámicamente el tamaño de fuente del saldo con \texttt{adjustFontSize}.

% Detallando la sección RTP
La sección de Request-to-Pay, definida en \texttt{RTP.html} y cargada dinámicamente por \texttt{RTP.js}, es el núcleo de la interacción con el flujo SRTP. La función \texttt{mostrarPanelRTPporRol} ajusta la visibilidad de los paneles según el rol del usuario, mostrando formularios específicos para crear, validar, enrutar o decidir sobre solicitudes RTP. Por ejemplo, los beneficiarios pueden crear RTPs mediante \texttt{createRTPForm}, mientras que los pagadores toman decisiones con \texttt{decisionForm}, cumpliendo con los requisitos funcionales RF-01 a RF-04.

% Describiendo la experiencia de usuario
La experiencia de usuario se optimiza mediante un menú inferior (\texttt{bottomMenuSquares}) con iconos y animaciones hover, y una barra de navegación que permite alternar entre secciones. Aunque las secciones de cuentas y tarjetas son placeholders, la sección de perfil permite actualizar datos como IBAN y saldo, integrándose con el endpoint \texttt{/profile}. Esta estructura modular asegura que el frontend sea extensible para futuras funcionalidades, como se propone en el capítulo \ref{sec:Potencial}.

\subsection*{4.7.2 \; Notificaciones}

% Breve descripción de las notificaciones
El sistema de notificaciones en tiempo real, implementado con Flask-SocketIO y descrito parcialmente en los apartados 4.1 y 4.3, utiliza WebSockets para informar a los actores sobre cambios en el estado de las solicitudes RTP, cumpliendo con RF-05. En el frontend, \texttt{RTP.js} registra listeners para eventos como \texttt{rtp\_created}, \texttt{rtp\_routed}, \texttt{rtp\_validated\_payer} y \texttt{rtp\_decision}. Estos eventos actualizan una tabla de notificaciones (\texttt{notificationsTable} en \texttt{RTP.html}) que muestra el ID, monto, estado y acciones disponibles según el rol del usuario, como validar o decidir sobre una RTP. La función \texttt{renderNotificationsTable} gestiona la visualización dinámica, asegurando una interacción reactiva y eficiente.

% Conclusión del apartado
En resumen, el frontend del prototipo SRTP ofrece una interfaz funcional y adaptable que satisface las necesidades de los actores, mientras que el sistema de notificaciones proporciona actualizaciones en tiempo real. La combinación de tecnologías modernas y un diseño basado en roles garantiza una experiencia de usuario coherente con los objetivos establecidos en el Capítulo 3.

\section{Despliegue y configuración}
\label{subsec:despliegue}

Este apartado detalla el proceso de despliegue y configuración del prototipo SRTP, abarcando desde la preparación del entorno hasta la ejecución de la aplicación. El sistema está diseñado para operar en un entorno de desarrollo controlado, utilizando tecnologías ligeras y portables que cumplen con el requisito no funcional RNF-03 (portabilidad). La configuración se centraliza en archivos específicos, y el despliegue se realiza sobre un entorno virtual Python en Ubuntu 22.04.6 LTS ejecutado como WSL (Windows Subsystem for Linux) en Windows, garantizando reproducibilidad y facilidad de instalación.

\subsection*{4.8.1 \; Preparación del entorno}

% Describiendo el sistema operativo y el entorno virtual
El prototipo se despliega en \textbf{Ubuntu 22.04.6 LTS} bajo WSL, una elección que combina la flexibilidad de un sistema Linux con la compatibilidad de Windows. Para aislar las dependencias y evitar conflictos, se utiliza un entorno virtual Python (\texttt{venv}). Los pasos iniciales para preparar el entorno son:

\begin{enumerate}
    \item \textbf{Instalación de Python}: Se requiere Python 3.10 o superior, preinstalado en Ubuntu 22.04.6 LTS. El comando \texttt{python3 --version} verifica la versión instalada.
    \item \textbf{Creación del entorno virtual}: Desde el directorio raíz del proyecto, se ejecuta \texttt{python3 -m venv venv} para crear el entorno virtual, seguido de \texttt{source venv/bin/activate} para activarlo.
    \item \textbf{Instalación de dependencias}: Las dependencias del proyecto están listadas en el archivo \texttt{requirements.txt} (Listado~\ref{lst:20}), que incluye:
        \begin{itemize}
            \item \texttt{Flask==2.2.2}: Framework web para la API REST y la gestión de rutas.
            \item \texttt{Flask-SQLAlchemy==3.0.2}: ORM para interactuar con la base de datos SQLite.
            \item \texttt{Flask-SocketIO}: Soporte para notificaciones en tiempo real mediante WebSockets.
            \item Otras dependencias implícitas, como \texttt{sqlalchemy} y \texttt{eventlet}, necesarias para el funcionamiento del sistema.
        \end{itemize}
        Las dependencias se instalan con el comando \texttt{pip install -r requirements.txt}, asegurando un entorno reproducible.
\end{enumerate}

% Mencionando la base de datos y sockets
La base de datos SQLite (\texttt{rtp.db}) se genera automáticamente al iniciar la aplicación, como se describe en el apartado 4.2. No requiere configuración adicional, ya que su URI se define en \texttt{config.py}. Los sockets, gestionados por Flask-SocketIO, se inicializan en \texttt{ext\_socketio.py} (Listado~\ref{lst:14}) y se configuran para permitir conexiones desde cualquier origen (\texttt{cors\_allowed\_origins="*"}).

\subsection*{4.8.2 \; Configuración del sistema}

% Explicando los archivos de configuración
La configuración del prototipo se centraliza en el archivo \texttt{config.py} (Listado~\ref{lst:19}), que define parámetros clave:

\begin{itemize}
    \item \textbf{\texttt{SQLALCHEMY\_DATABASE\_URI}}: Establece la ubicación de la base de datos SQLite (\texttt{sqlite:///rtp.db}) relativa al directorio del proyecto.
    \item \textbf{\texttt{SQLALCHEMY\_TRACK\_MODIFICATIONS}}: Desactivado (\texttt{False}) para optimizar el rendimiento y evitar advertencias de SQLAlchemy.
\end{itemize}

% Detallando la inicialización en app.py
El archivo \texttt{app.py} (Listado~\ref{lst:21}) es el punto de entrada de la aplicación y configura los componentes principales:

\begin{itemize}
    \item \textbf{Inicialización de Flask}: Se crea una instancia de \texttt{Flask} con una carpeta estática (\texttt{frontend}) para servir archivos como \texttt{index.html} y \texttt{styles.css}.
    \item \textbf{Configuración de SQLAlchemy y SocketIO}: Se vinculan con la aplicación mediante \texttt{db.init\_app(app)} y \texttt{socketio.init\_app(app)}.
    \item \textbf{Creación de la base de datos}: Dentro de un contexto de aplicación, se eliminan (\texttt{db.drop\_all()}) y recrean (\texttt{db.create\_all()}) las tablas, inicializando cuatro actores predefinidos (Mercadona, PSPMercadona, PSPalonso, Alonso) con roles y relaciones específicas, como se describe en el apartado 4.2.
    \item \textbf{Registro de blueprints}: El blueprint \texttt{rtp\_blueprint} (definido en \texttt{routes.py}) se registra para exponer los endpoints REST.
\end{itemize}

% Explicando el puerto de escucha
El puerto de escucha se establece en \texttt{app.py} mediante la ejecución de \texttt{socketio.run(app, debug=True)}, que por defecto utiliza el puerto 5000. Este puerto es accesible localmente en \texttt{http://127.0.0.1:5000}. Para modificar el puerto, se puede pasar el parámetro \texttt{port} a \texttt{socketio.run}, por ejemplo, \texttt{socketio.run(app, port=8080, debug=True)}. Además, \texttt{app.py} abre automáticamente un navegador web en la URL raíz al iniciar la aplicación, facilitando las pruebas.

\subsection{Ejecución del sistema}

% Describiendo el proceso de ejecución
Para ejecutar el prototipo, se siguen estos pasos desde el directorio raíz del proyecto:

\begin{enumerate}
    \item Activar el entorno virtual: \texttt{source venv/bin/activate}.
    \item Ejecutar la aplicación: \texttt{python app.py}. Esto inicia el servidor Flask y SocketIO en el puerto 5000, crea la base de datos, inicializa los actores y sirve la interfaz web.
\end{enumerate}

% Mencionando el soporte para pruebas
El modo de depuración (\texttt{debug=True}) permite recargar automáticamente el servidor ante cambios en el código, ideal para el desarrollo. Para un entorno de producción, se recomienda usar un servidor WSGI como \texttt{gunicorn} y desactivar el modo de depuración, como se sugiere en el Capítulo 6.

\subsection{Conclusión}

% Resumiendo la configuración y su alineación con los requisitos
El despliegue del prototipo SRTP es sencillo y portable gracias al uso de un entorno virtual Python, SQLite y Flask-SocketIO. La configuración centralizada en \texttt{config.py} y la inicialización automatizada en \texttt{app.py} garantizan un arranque consistente, mientras que el uso de Ubuntu WSL proporciona un entorno de desarrollo robusto. Esta implementación cumple con los requisitos de portabilidad y trazabilidad establecidos en el Capítulo 3, sentando las bases para un sistema escalable y mantenible.


# END FILE CONTENTS


# File: backend/app.py

from flask import Flask, send_from_directory
from ext_socketio import socketio, join_room
from config import Config
from models import db, Actor
import os
import webbrowser
from routes import rtp_blueprint

STATIC_FOLDER = os.path.join(os.path.dirname(__file__), '../frontend')
app = Flask(__name__, static_folder=STATIC_FOLDER)
app.config.from_object(Config)
db.init_app(app)

# Inicialización de SocketIO
socketio.init_app(app, cors_allowed_origins="*")

with app.app_context():
    db.drop_all()
    db.create_all()

    # Crear los 4 usuarios predefinidos:
    # 1) "Mercadona" => beneficiary
    # 2) "PSPMercadona" => psp_beneficiary
    # 3) "PSPalonso" => psp_payer
    # 4) "alonso" => payer
    # Contraseñas ficticias, p.ej. "1234"
    mercadona = Actor(
        username="e",
        password="1",
        name="Empresa",
        role="beneficiary",
        iban="ES26001234567890123456",
        balance=0.0
    )
    psp_merc = Actor(
        username="pm",
        password="1",
        name="PSP de empresa",
        role="psp_beneficiary"
    )
    psp_alonso = Actor(
        username="pa",
        password="1",
        name="PSP de Alonso",
        role="psp_payer"
    )
    alonso = Actor(
        username="a",
        password="1",
        name="Alonso",
        role="payer",
        iban="ES45098765432100000000",
        balance=1000.0
    )

    db.session.add_all([mercadona, psp_merc, psp_alonso, alonso])
    db.session.commit()

    # Ahora vinculamos:
    # - Mercadona -> PSPMercadona
    # - alonso -> PSPalonso
    mercadona.psp_id = psp_merc.id
    alonso.psp_id = psp_alonso.id
    db.session.commit()

# Servir index.html en la raíz
@app.route('/')
def home():
    return app.send_static_file('index.html')

# Servir archivos estáticos desde el directorio frontend
@app.route('/<path:filename>')
def serve_static(filename):
    return send_from_directory(app.static_folder, filename)

# Registrar el blueprint con todos los endpoints de RTP
app.register_blueprint(rtp_blueprint)

@socketio.on('join')
def handle_join(data):
    actor_id = data['actor_id']
    actor = Actor.query.get(actor_id)
    if actor:
        room = f"{actor.role}_{actor_id}"
        join_room(room)
        print(f"Actor {actor_id} se unió a la sala {room}")

if __name__ == '__main__':
    webbrowser.open("http://127.0.0.1:5000/")
    socketio.run(app, debug=True)


# END FILE CONTENTS


# File: backend/utils_roles.py

# utils_roles.py (archivo nuevo para la lógica de roles)
from functools import wraps
from flask import request, jsonify
from models import Actor, db

def role_required(required_role):
    """
    Decorador que verifica que el actor que invoca el endpoint
    tenga el rol adecuado.
    Se espera que en el body JSON llegue "actor_id".
    """
    def decorator(f):
        @wraps(f)
        def wrapper(*args, **kwargs):
            data = request.get_json() or {}
            actor_id = data.get('actor_id')
            if not actor_id:
                return jsonify({"error": "Se requiere actor_id para esta acción"}), 400

            actor = Actor.query.get(actor_id)
            if not actor:
                return jsonify({"error": "Actor no encontrado"}), 404

            if actor.role != required_role:
                return jsonify({"error": f"Rol '{actor.role}' no tiene acceso a esta acción"}), 403

            # Si el rol coincide, continuamos
            return f(*args, **kwargs)
        return wrapper
    return decorator


# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/DiagEstado.svg:Zone.Identifier



# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/DIAGRAMAaER.pdf:Zone.Identifier

[ZoneTransfer]
ZoneId=3
ReferrerUrl=https://convertio.co/
HostUrl=https://s184.convertio.me/p/5ZgSIUDHaniBz-MOcY6Qrg/a41c7c2113f6e5a22b7187c20642ecc7/DIAGRAMAaER.pdf


# END FILE CONTENTS


# File: MemoriaTFG/src/metodos.tex

\chapter{Métodos}
\label{sec:Metodos}
Esta sección describe los métodos empleados para desarrollar y evaluar el sistema...

\section{Preparación de los datos de entrada}
\label{subsec:PreparacionDatos}
\subsection{Simulación de solicitudes HTTP}
\label{subsubsec:SimulacionSolicitudes}
Se simularon solicitudes HTTP utilizando herramientas como curl...

\subsection{Configuración de escenarios de prueba}
\label{subsubsec:EscenariosPrueba}
Se definieron escenarios de prueba que cubren casos de uso típicos...

\section{Evaluación del sistema}
\label{subsec:EvaluacionSistema}
\subsection{Métricas de rendimiento}
\label{subsubsec:MetricasRendimiento}
Se evaluaron métricas como latencia y \textit{throughput}...

\subsection{Diseño de pruebas}
\label{subsubsec:DisenoPruebas}
Se diseñaron pruebas unitarias, de integración y de carga...

\subsection{Análisis de resultados}
\label{subsubsec:AnalisisResultados}
Los resultados obtenidos se analizaron para identificar cuellos de botella...

\section{Optimización del servidor}
\label{subsec:Optimizacion}
Se implementaron mejoras para optimizar el rendimiento del servidor...

\section{Validación cruzada de la implementación}
\label{subsec:ValidacionCruzada}
La implementación se comparó con los estándares del EPC...


# END FILE CONTENTS


# File: MemoriaTFG/src/implementacion_past.tex

\chapter{Diseño e Implementación}
\label{sec:DisenoImplementacion}
Para implementar un sistema completo de \textit{Request To Pay}, se ha desarrollado un servidor HTTP que expone una API RESTful y un cliente web en tiempo real. El objetivo de este apartado es detallar cómo se ha llevado a cabo esta implementación, así como las fases de desarrollo involucradas.

\section{Fundamentos Teóricos}
Antes de profundizar en la implementación, es fundamental aclarar los dos pilares teóricos en los que se basa el sistema:

\begin{itemize}
    \item \textbf{Servidor HTTP}: Una aplicación que permanece a la escucha en un puerto de red, esperando conexiones TCP de clientes capaces de comunicarse mediante el protocolo HTTP. Una vez establecida la conexión, el servidor recibe un mensaje estructurado con los siguientes componentes:
    \begin{itemize}
        \item \textit{Línea de petición}: Indica el método (GET, POST, etc.), la ruta del recurso solicitado y la versión del protocolo.
        \item \textit{Cabeceras}: Aportan metadatos, como el tipo de contenido, credenciales o longitud del mensaje.
        \item \textit{Cuerpo} (opcional): Contiene datos adicionales, si el método lo requiere.
    \end{itemize}
    El servidor interpreta la ruta, determina qué componente interno debe procesarla, ejecuta la lógica correspondiente y genera una respuesta formada por:
    \begin{itemize}
        \item \textit{Línea de estado}: Incluye un código de resultado (por ejemplo, 200 OK, 404 Not Found, 500 Internal Server Error).
        \item \textit{Cabeceras}: Describen la respuesta.
        \item \textit{Cuerpo} (opcional): Contiene datos, como HTML o JSON.
    \end{itemize}
    Tras enviar la respuesta, la conexión puede cerrarse o mantenerse activa para futuras peticiones, dependiendo de la versión del protocolo y las cabeceras de control. En esencia, el servidor HTTP funciona como el centro de operaciones que recibe todas las solicitudes y coordina el acceso a la lógica y los datos de la aplicación.

    \item \textbf{API RESTful}: Se basa en los principios de la arquitectura REST (\textit{Representational State Transfer}\footnote{Transferencia de Estado Representacional}) aplicados al protocolo HTTP para exponer recursos de forma uniforme y predecible. Sus características principales son:
    \begin{itemize}
        \item Cada entidad del dominio (por ejemplo, un usuario o una petición RTP) se representa mediante una URL estable.
        \item Los verbos HTTP (POST, GET, PUT, DELETE) describen operaciones como creación, consulta, modificación o eliminación de recursos.
        \item El servidor es \textit{sin estado}, por lo que cada solicitud contiene toda la información necesaria, facilitando la escalabilidad horizontal.\footnote{Es decir, permite añadir o retirar servidores sin necesidad de compartir sesiones en memoria.}
        \item La uniformidad de los códigos de estado y los formatos de representación asegura que clientes heterogéneos consuman la API de manera predecible.
        \item Herramientas como cachés, control de versiones en URLs o cabeceras, y negociación de contenido permiten evolucionar la interfaz sin afectar a los consumidores existentes.
    \end{itemize}
\end{itemize}

En conjunto, el servidor HTTP actúa como el camino por donde viajan las solicitudes, mientras que la API RESTful establece las reglas claras y fáciles de mantener para que ese camino conecte eficientemente la lógica del servidor con los diversos clientes que dependen de ella.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Tecnologías utilizadas}
\label{subsec:Herramientas de desarrollo}
El desarrollo del proyecto se ha llevado a cabo en un entorno virtual Python que aísla las dependencias y permite reproducir la instalación mediante el comando \texttt{pip install -r requirements.txt}. Este enfoque asegura consistencia y portabilidad, facilitando tanto la colaboración entre desarrolladores como el despliegue en entornos diversos.

\textbf{Backend.} El núcleo del backend se fundamenta en Python 3 y Flask, un micro-framework que proporciona un servidor WSGI, un sistema de enrutado eficiente y una integración fluida con el estándar HTTP. Sobre esta base, se incorpora Flask-socketIO, un middleware que habilita la negociación de WebSockets, permitiendo servir tráfico HTTP y comunicación bidireccional en el mismo puerto de manera transparente. Para la gestión de datos, se emplea SQLAlchemy a través de Flask-SQLAlchemy, lo que facilita la representación de modelos de dominio como objetos Python, mientras que SQLite actúa como una base de datos ligera y autónoma durante el desarrollo, eliminando la necesidad de un servidor externo para transacciones básicas. Este núcleo se complementa con utilidades de la librería estándar de Python, incluyendo:
\begin{itemize}
    \item \texttt{hashlib}, para firmar transacciones de estado mediante el algoritmo SHA-256;
    \item \texttt{datetime}, para registrar marcas temporales en los logs.
\end{itemize}

\textbf{Frontend.} En el lado del cliente, se ha implementado un frontend estático basado en HTML5, CSS3 y JavaScript ES6, priorizando la ligereza al evitar frameworks complejos. La maquetación adaptativa se logra mediante Bootstrap 5, cargado vía CDN, y la iconografía se enriquece con Font Awesome, también distribuido por CDN. La comunicación en tiempo real se establece con el cliente Socket.IO 4.x, que conecta vía WebSocket al mismo host y puerto que Flask, mientras que las peticiones REST se realizan de forma nativa con la Fetch API, sin depender de librerías adicionales.

\textbf{Herramientas de desarrollo.} El entorno de trabajo se ha centrado en Visual Studio Code como editor principal, aprovechando sus extensiones para optimizar la gestión del proyecto y el desarrollo del código. El control de versiones se ha gestionado con Git, utilizando ramas específicas para cada funcionalidad nueva, lo que asegura un desarrollo ordenado y trazable. Para las pruebas manuales de la API, se ha empleado Postman, donde se diseñó una colección de peticiones parametrizadas que serán detalladas en secciones posteriores del documento.

El uso de un entorno virtual junto con dependencias consolidadas establece una base robusta para el despliegue de la aplicación en entornos más exigentes, como contenedores, nubes públicas o servidores locales, preservando la integridad de su arquitectura fundamental.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Estructura y funcionamiento}
\label{subsec:Estructura}
El código del proyecto se estructura en dos componentes principales, \textbf{backend} y \textbf{frontend}, interconectados mediante los protocolos HTTP y WebSockets. Esta división, diseñada de manera intencionada, responde a la necesidad de lograr un desarrollo ordenado, eficiente y preparado para futuros crecimientos, considerando que trabajé en el proyecto de forma individual. Al separar el \textit{backend}, encargado de la lógica de negocio, el manejo de datos y la comunicación con el cliente, del \textit{frontend}, centrado en la interfaz de usuario y la experiencia interactiva, se obtiene una arquitectura clara y modular. Esta organización aporta múltiples ventajas: mejora la mantenibilidad al permitir identificar y corregir errores de manera localizada, simplifica la incorporación de nuevas funcionalidades sin alterar otras partes del sistema y refleja fielmente la arquitectura empleada en entornos de producción reales, lo que facilita una transición fluida hacia despliegues en contenedores, nubes públicas o servidores locales. Además, esta separación promueve la reutilización de código, ya que el \textit{backend} puede servir a múltiples clientes (como aplicaciones móviles o de escritorio) y el \textit{frontend} puede adaptarse a diferentes dispositivos sin modificar la lógica subyacente. A continuación, se describen los archivos que componen cada una de estas partes, su rol específico en el proyecto y el fragmento de código más relevante.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/treeB.png}
  \caption{Tree}
  \label{fig:Tree}
\end{figure}

\subsection{Backend}
\label{subsubsec:Backend}

\begin{itemize}
    \item \textbf{app.py} es el punto de arranque, para lanzar la aplicación debo ejecutar dentro de mi venv "python app.py". En este fichero se crea la instancia de Flask, aplica la configuración, inicializa la base de datos y arranca Socket.IO. Al mismo tiempo registra el blueprint con todos los endpoints y expone una ruta raíz que sirve directamente index.html, de manera que el mismo proceso pueda funcionar como servidor de APi y de archivos estáticos. 
        \begin{figure}[H]
            \centering
            \includegraphics[width=0.8\textwidth]{Imagenes/Arranque1.png}
            \caption{Arranque}
            \label{fig:Arranque}
        \end{figure}
        Tras ejecutarlo basta con poner "http://127.0.0.1:5000"     en el buscador para conectarnos al servidor.


        \begin{lstlisting}[language=Python, style=custom, caption={Configuración y arranque del servidor Flask-SocketIO}]
            STATIC_FOLDER = os.path.join(os.path.dirname(__file__), '../frontend')
            app = Flask(__name__, static_folder=STATIC_FOLDER)
            app.config.from_object(Config)
            db.init_app(app)
            # Servir index.html en la raíz
            @app.route('/')
            def home():
                return app.send_static_file('index.html')

            # Servir archivos estáticos desde el directorio frontend
            @app.route('/<path:filename>')
            def serve_static(filename):
                return send_from_directory(app.static_folder, filename)

            # Registrar el blueprint con todos los endpoints de RTP
            app.register_blueprint(rtp_blueprint)

            @socketio.on('join')
            def handle_join(data):
                actor_id = data['actor_id']
                actor = Actor.query.get(actor_id)
                if actor:
                    room = f"{actor.role}_{actor_id}"
                    join_room(room)
                    print(f"Actor {actor_id} se unió a la sala {room}")

            if __name__ == '__main__':
                webbrowser.open("http://127.0.0.1:5000/")
                socketio.run(app, debug=True)
        \end{lstlisting}

    \item \textbf{config.py} contiene la configuración: URI de SQLite y parámetro para desactivar el tracker de SQLAlchemy. Facilita cambiar de motor BD en modificaciones futuras solamente cambiando esta clase.
            \begin{lstlisting}[language=Python, style=custom, caption={Configuración SQLAlchemy y SQLite}]
                basedir = os.path.abspath(os.path.dirname(__file__))

                class Config:
                    SQLALCHEMY_DATABASE_URI = 'sqlite:///' + os.path.join(basedir, 'rtp.db')
                    SQLALCHEMY_TRACK_MODIFICATIONS = False

            \end{lstlisting}

    \item \textbf{models.py} define el modelo de datos que se va utilizar y contiene un ORM\footnote{Object-Relational Mapping} para interactuar con una base de datos relacional. Aquí definimos tres clases principales que representan tablas en la base de datos: Actor, RTP y log.
            Esto se hace así para mayor facilidad a la hora de realizar operaciones como crear, leer, actualizar y eliminar registros.
            Cada una de estas clases corresponde con una tabla en la base de datos y cada atributo de cada clase con una columna de su tabla correspondiente. Además se incluye un método todict para serializar los datos a formato JSON para enviarlos a través de una API.
            A continuacion se muestra únicamente una de las 3 clases ya que ambas tienen la misma estructura.

            \begin{lstlisting}[language=Python, style=custom, caption={Modelo ORM + clase Actor}]
                    from flask_sqlalchemy import SQLAlchemy

                    db = SQLAlchemy()

                    class Actor(db.Model):
                        __tablename__ = 'actor'
                        id = db.Column(db.Integer, primary_key=True)
                        username = db.Column(db.String(50), unique=True)
                        password = db.Column(db.String(50))
                        name = db.Column(db.String(50), nullable=False)
                        role = db.Column(db.String(20), nullable=False)

                        photo_url = db.Column(db.String(200), nullable=True)  # URL o base64
                        iban = db.Column(db.String(34), nullable=True)
                        balance = db.Column(db.Float, default=0.0)

                        # Campo nuevo: psp_id, que referencia a otro Actor que es PSP
                        psp_id = db.Column(db.Integer, db.ForeignKey('actor.id'), nullable=True)
                        # Relación para que se pueda acceder con actor.psp
                        psp = db.relationship('Actor', remote_side=[id])

                        def to_dict(self):
                            return {
                                "id": self.id,
                                "username": self.username,
                                "name": self.name,
                                "role": self.role,
                                "photo_url": self.photo_url,
                                "iban": self.iban,
                                "balance": self.balance,
                                "psp_id": self.psp_id  # Podríamos incluir más info del psp, etc.
                            }

                \end{lstlisting}

    \item \textbf{utils.py} agrega métodos auxiliares que son llamados desde otros ficheros. Son métodos de utilidad y se han puesto en este fichero con el objetivo de no sobrecargar los ficheros principales. Algunas de las funcionalidades que incluye son "cambiar\_esatdo_rtp", "rechazar\_rtp" o "validar\_iban".

            \begin{lstlisting}[language=Python, style=custom, caption={Funciones utilitarias}]
                def cambiar_estado_rtp(db, rtp_obj, new_status):
                old_status = rtp_obj.status
                rtp_obj.status = new_status
                db.session.commit()

                # Generar un hash
                hash_input = f"{rtp_obj.id}{rtp_obj.iban}{rtp_obj.amount}{old_status}{new_status}".encode('utf-8')
                hash_value = hashlib.sha256(hash_input).hexdigest()

                nuevo_log = Log(
                    rtp_id=rtp_obj.id,
                    old_status=old_status,
                    new_status=new_status,
                    hash_value=hash_value
                )
                db.session.add(nuevo_log)
                db.session.commit()

                return {
                    "message": f"RTP {rtp_obj.id} actualizado de {old_status} a {new_status}"
                }

            def rechazar_rtp(db, rtp_obj, motivo):
                return cambiar_estado_rtp(db, rtp_obj, "rechazado")

            def validar_iban(iban, rtp_obj):
                iban = rtp_obj.iban
                if not iban or not isinstance(iban, str) or len(iban) < 15:
                    return cambiar_estado_rtp(db, rtp_obj, "rechazado")
                if not (iban[:2].isalpha() and iban[2:].replace(' ', '').isalnum()):
                    return cambiar_estado_rtp(db, rtp_obj, "rechazado")
                return {
                    "message": f"RTP {rtp_obj.id} validado con IBAN correcto"
                }

            \end{lstlisting}

    \item \textbf{utils roles.py} contiene el decorador rolerequired que inspecciona el actorid recibido en el cuerpo JSON y bloquea la ruta si el rol no coincide con el requerido.
            De esta manera se asegura de cada actor tenga acceso a sus propias funciones.

            \begin{lstlisting}[language=Python, style=custom, caption={Decorador para control de funciones}]
                def role_required(required_role):
                """
                Decorador que verifica que el actor que invoca el endpoint
                tenga el rol adecuado.
                Se espera que en el body JSON llegue "actor_id".
                """
                def decorator(f):
                    @wraps(f)
                    def wrapper(*args, **kwargs):
                        data = request.get_json() or {}
                        actor_id = data.get('actor_id')
                        if not actor_id:
                            return jsonify({"error": "Se requiere actor_id para esta acción"}), 400

                        actor = Actor.query.get(actor_id)
                        if not actor:
                            return jsonify({"error": "Actor no encontrado"}), 404

                        if actor.role != required_role:
                            return jsonify({"error": f"Rol '{actor.role}' no tiene acceso a esta acción"}), 403

                        # Si el rol coincide, continuamos
                        return f(*args, **kwargs)
                    return wrapper
                return decorator

            \end{lstlisting}
    
    \item \textbf{services.py} contiene la capa de negocio. Cada función del fichero orquesta la consulta/actualizacion de modelos, invoca las utilidades de estado y emite eventos Socket.IO a la room adecuada.
            A través de todas estas funciones se lleva a cabo el flujo RTP, que posteriormente explicaré.
    
    \item \textbf{routes.py} contiene el Blueprint que expone la máquina de estados RTP (cinco rutas POST) y utilidades de autenticación, perfil y logs. Cada endpoint invoca a su homónimo en servcies.py y devuelve el JSON estandarizado.
            Algunas de estos endpoints que no afectan directamente sobre el flujo RTP son el proceso de login (ya que se trata de simular la página de un banco) o el apartado de perfil donde puedes modificar algunos elementos.

            A cada uno de estos endpoints le corresponde su fichero o apartado .html que veremos en posteriores apartados del documento.
            
            \begin{lstlisting}[language=Python, style=custom, caption={Declaración blueprint rtp}]
                rtp_blueprint = Blueprint('rtp', __name__)
            \end{lstlisting}

            \begin{lstlisting}[language=Python, style=custom, caption={Endpoint login}]
                @rtp_blueprint.route('/login', methods=['POST'])
                def login():
                    data = request.get_json()
                    username = data.get('username')
                    password = data.get('password')
                    if not username or not password:
                        return jsonify({"error": "Faltan credenciales"}), 400
                    
                    actor = Actor.query.filter_by(username=username).first()
                    if not actor:
                        return jsonify({"error": "Usuario no existe"}), 404
                    
                    if actor.password != password:
                        return jsonify({"error": "Contraseña incorrecta"}), 401
                    
                    # Login exitoso
                    return jsonify({
                        "message": "Login correcto",
                        "actor_id": actor.id,
                        "role": actor.role,
                        "name": actor.name
                    })
            \end{lstlisting}

            \begin{lstlisting}[language=Python, style=custom, caption={Endpoint profile}]
                    @rtp_blueprint.route('/profile', methods=['POST'])
                    @role_required('payer')
                    def update_profile():
                        data = request.get_json() or {}
                        actor_id = data.get('actor_id')
                        actor = Actor.query.get(actor_id)
                        if not actor:
                            return jsonify({"error": "Actor no encontrado"}), 404

                        # Campos opcionales
                        new_photo = data.get('photo_url')
                        new_iban = data.get('iban')
                        new_balance = data.get('balance')

                        if new_photo is not None:
                            actor.photo_url = new_photo
                        if new_iban is not None:
                            actor.iban = new_iban
                        if new_balance is not None:
                            actor.balance = float(new_balance)

                        db.session.commit()
                        return jsonify({"message": "Perfil actualizado", "actor": actor.to_dict()})

            \end{lstlisting}

    \item \textbf{routes actors.py} contiene un pequeño blueprint aparte para el alta de actores, esto se ha hecho así para demostrar cómo escalar la API sin engordar el fichero principal.
            \begin{lstlisting}[language=Python, style=custom, caption={Declaración blueprint actores}]
                actors_blueprint = Blueprint('actors', __name__)

                @actors_blueprint.route('/actors', methods=['POST'])
                def create_actor():
                    data = request.get_json()
                    name = data.get('name')
                    role = data.get('role')  # 'beneficiary', 'psp_beneficiary', 'psp_payer', 'payer'

                    if not name or not role:
                        return jsonify({"error": "Faltan campos requeridos: name, role"}), 400

                    # Validar que el role sea uno de los cuatro permitidos:
                    valid_roles = ['beneficiary', 'psp_beneficiary', 'psp_payer', 'payer']
                    if role not in valid_roles:
                        return jsonify({"error": f"Rol '{role}' no válido"}), 400

                    actor = Actor(name=name, role=role)
                    db.session.add(actor)
                    db.session.commit()

                    return jsonify({"message": "Actor creado", "id": actor.id, "role": actor.role}), 201

            \end{lstlisting}

    \item \textbf{ext socketio.py} simplemente es un fichero de conveniencia que crea la instancia soccketIO.
            Separar la instancia de Socket.IO en un fichero independiente permite mantener una arquitectura limpia y flexible: evita importaciones circulares entre módulo, se integra sin fricción en el patrón application factory de Flask al poder llamarse luego socketio.initapp desde app.py. Así centralizamos en un único punto la configuración o el cambio de motor de concurrencia facilitando la escalabilidad.
            \begin{lstlisting}[language=Python, style=custom, caption={Instancia global de socketIO}]
                from flask_socketio import SocketIO, join_room, emit

                socketio = SocketIO()
            \end{lstlisting}


    \item \textbf{rtp.db} es una base de datos sencilla que se crea sola la primera vez que inicias la aplicación. Cuando arrancas el programa, las herramientas explicadas anteriormente crean este archivo automáticamente. Este archivo guarda toda la información del proyecto, como las tablas y datos, sin necesidad de instalar nada más ni usar un servidor aparte. Esto hace que sea muy fácil empezar a trabajar en el proyecto, ya sea para desarrollarlo, hacer pruebas o mostrar cómo funciona, porque solo necesitas instalar lo básico.

        Cuando el proyecto crezca y se necesite manejar más usuarios al mismo tiempo, hacer copias de seguridad mientras está funcionando o tener varias copias de la base de datos, se puede cambiar a una base de datos más potente, como PostgreSQL o MySQL. Esto se hace simplemente cambiando una dirección de conexión, sin modificar casi nada del programa.
\end{itemize}

\subsection{Frontend}
\label{subsubsec:Frontend}

\begin{itemize}
    \item \textbf{index.html} define el formulario de login inicial, el navbar colapsable y cinco bloques: homeDashboard, seccionCuentas, seccionTarjetas, seccionPerfiles y seccionRTP, de las cuales la única relevante es la seccionRTP, las demás son relleno para simular una página de un banco.
        
    El documento carga Bootstrap 5, Font Awesome, Google Fonts y la hoja styles.css.

    Al final del documento se incluye app.js y RTP.js de modo que la misma página sirve toda la experiencia de usuario sin recargas.
    \item \textbf{app.js} desempeña un papel central como el núcleo de la interfaz de usuario, orquestando toda la experiencia de la aplicación de página única (\textit{single-page application}, SPA) del proyecto. Desde su carga inicial, este fichero establece las bases para una interacción fluida y dinámica, integrando las siguientes funcionalidades clave:
        \begin{itemize}
            \item \textbf{Establecimiento de la conexión WebSocket.} Al cargarse, inicia una conexión WebSocket con el servidor mediante una instrucción adecuada, asegurando que los eventos emitidos por el backend lleguen al navegador en tiempo real. Tras un inicio de sesión exitoso, envía un evento \texttt{join} que suscribe al usuario a la sala correspondiente, permitiendo recibir actualizaciones instantáneas de cambios de estado.

            \item \textbf{Gestión del proceso de autenticación.} Intercepta el envío del formulario de inicio de sesión, realiza una solicitud \texttt{POST /login}, almacena en memoria el identificador (\texttt{currentActorId}) y el rol (\texttt{currentActorRole}) devueltos por la API, y desbloquea la navegación por la aplicación, ofreciendo una transición suave al usuario.

            \item \textbf{Navegación tipo SPA.} Incluye una función que muestra u oculta secciones según la opción seleccionada en la barra de menús, evitando recargas completas de la página y simulando la experiencia de una aplicación nativa. Esta funcionalidad garantiza una navegación ágil y eficiente.

            \item \textbf{Carga del panel principal.} Al acceder al panel "Inicio", invoca un cargador de datos que obtiene el perfil del usuario mediante una solicitud \texttt{fetch}, formatea el saldo con separadores de miles para mayor claridad, enmascara el IBAN por razones de seguridad y ajusta dinámicamente el tamaño de fuente para que el monto se ajuste perfectamente dentro del círculo de balance.

            \item \textbf{Edición del perfil.} Ofrece un módulo que precarga el formulario con los datos actuales del usuario, permite su edición y, al enviarlo, actualiza la información en el servidor a través de una solicitud \texttt{POST /profile}, mostrando mensajes de éxito o error sin necesidad de salir de la página.

            \item \textbf{Adaptación a dispositivos móviles.} Monitorea los eventos de expansión y colapso de la barra de navegación (\textit{navbar}) de Bootstrap, ajustando la visibilidad del menú inferior para evitar que los controles oculten el contenido en pantallas pequeñas, asegurando una experiencia coherente y usable.

            \item \textbf{Mantenimiento del estado y sincronización.} Coordina el estado del usuario, sincroniza los datos con el backend, responde a notificaciones en tiempo real y proporciona una navegación fluida, todo ello sin depender de frameworks SPA pesados. Incluye utilidades propias como funciones para formatear cantidades, IBANs y tamaños de texto, que refuerzan la usabilidad y la consistencia visual de la aplicación.
        \end{itemize}

    \item \textbf{RTP.js} se encarga de transformar la sección RTP de la aplicación de página única (\textit{single-page application}, SPA) en un panel interactivo que opera en tiempo real. Este módulo integra la interfaz visual con el backend, gestiona eventos dinámicos y ofrece flujos de trabajo adaptados a los roles de los usuarios, todo ello mientras mantiene un diseño ligero y sin dependencias de frameworks externos. A continuación, se detallan sus principales funcionalidades:
    
        \begin{itemize}
            \item \textbf{Carga inicial de la interfaz.} Una vez que el DOM está completamente cargado, el módulo descarga el fragmento \texttt{RTP.html} y lo inserta en el contenedor \texttt{seccionRTP}. Posteriormente, invoca un inicializador que registra los \textit{event listeners} necesarios para la interacción. Este enfoque mantiene el HTML de la interfaz separado del código JavaScript, lo que reduce el peso de la página principal y facilita el mantenimiento.

            \item \textbf{Gestión de notificaciones y roles.} \texttt{RTP.js} almacena en memoria un arreglo con todas las notificaciones recibidas durante la sesión del usuario. Utilizando la variable global \texttt{currentActorRole}, determina qué panel de acciones debe mostrarse (Beneficiario, PSP Beneficiario, PSP Pagador o Pagador) y oculta los demás. Esta lógica de visibilidad se aplica tanto al cargar la sección como al cambiar de pestaña, asegurando que la interfaz se adapte dinámicamente al rol del usuario, incluso si la sesión se reutiliza para diferentes perfiles.

            \item \textbf{Flujos de trabajo por rol.} El módulo encapsula los procesos de negocio mediante manejadores de eventos que varían según el rol del usuario:
            \begin{itemize}
                \item \textit{Beneficiario}: Intercepta el formulario "Crear RTP", construye un objeto JSON con el IBAN, el importe y el identificador del actor, y lo envía a \texttt{POST /rtp}. La respuesta del servidor se muestra en un contenedor de retroalimentación.
                \item \textit{PSP Beneficiario}: Proporciona formularios para validar al beneficiario (\texttt{POST /rtp/\linebreak <id>/validate-beneficiary}) y enrutar la solicitud (\texttt{POST /rtp/<id>/route}).
                \item \textit{PSP Pagador}: Ofrece un formulario para validar los fondos del pagador.
                \item \textit{Pagador}: Incluye un formulario para tomar la decisión final (aceptar o rechazar la solicitud).
            \end{itemize}
            Cada acción se realiza mediante la API Fetch sin recargar la página, y los resultados se notifican visualmente al usuario. Además, los identificadores RTP pueden accionarse desde botones en la tabla de notificaciones, permitiendo a PSPs y pagadores responder con un solo clic, sin necesidad de completar formularios manualmente.

            \item \textbf{Sincronización en tiempo real.} El módulo instala \textit{listeners} WebSocket para los eventos \texttt{rtp\_created}, \texttt{rtp\_routed}, \texttt{rtp\_validated\_payer} y \texttt{rtp\_decision}. Cuando el backend emite uno de estos eventos, el cliente verifica si el rol conectado es el destinatario. Si lo es, añade el objeto RTP al arreglo de notificaciones y actualiza la tabla de la interfaz. El renderizado genera filas con el importe, el estado y un botón contextual que activa la acción correspondiente según el rol y el estado actual, manteniendo la interfaz sincronizada sin necesidad de solicitudes adicionales al servidor.

            \item \textbf{Auditoría de transacciones.} Un botón ``Mostrar logs'' realiza una solicitud \texttt{GET /logs}, recupera el historial de transiciones firmado con SHA-256 y lo presenta en un listado colapsable. Esto permite al usuario revisar el ciclo de vida de cada solicitud de manera instantánea, ofreciendo una herramienta de auditoría clara y accesible.
        \end{itemize}

    \item \textbf{RTP.html} es una plantilla HTML autónoma que el cliente carga dinámicamente cuando el usuario accede a la sección Request-to-Pay; reúne, en un único fragmento, los formularios de acción de los cuatro roles (Beneficiary, PSP Beneficiary, PSP Payer y Payer) y una tabla de notificaciones donde se van listando los cambios de estado recibidos en tiempo real, de modo que toda la interfaz específica del flujo RTP se mantiene separada del documento principal y puede insertarse o actualizarse sin recargar la página.
    \item \textbf{styles.css} es consumido por todas las páginas del frontend (por ejemplo, index.html y los fragmentos dinámicos como RTP.html) y su única misión es dotar de coherencia visual a la aplicación: define la paleta de colores (degradados morados y dorados), las tipografías (Montserrat y Great Vibes), los espaciados y sombras de los componentes (cards, inputs, botones), y aplica transiciones suaves (hover, fade-in) para mejorar la percepción de interactividad sin añadir ninguna lógica de negocio. 
\end{itemize}

\section{Emulación del prototipo \textit{Request To Pay}}
\label{subsec:EmulacionRTP}
Para emular el flujo Request To Pay, se han configurado cuatro actores con roles y permisos claramente diferenciados: el beneficiario, el pagador y los PSP correspondientes a cada uno de ellos. Cada actor dispone de un conjunto específico de endpoints REST para ejecutar sus operaciones (crear, validar, enrutar y decidir sobre una petición RTP) y escucha eventos WebSocket que garantizan la notificación en tiempo real de cada cambio de estado. De esta manera, el sistema reproduce fielmente el ciclo completo de una solicitud de cobro, desde su emisión por parte del beneficiario hasta la decisión final del pagador, manteniendo la trazabilidad y la coherencia de los estados en el backend y el frontend.

Tal como se describió anteriormente, todos los participantes deben estar previamente registrados en el Registro OSM, que actúa como fuente única de verdad y coordina la relación entre clientes y sus proveedores de servicio de pago. Gracias a este repositorio central, el banco del pagador ya conoce a su cliente y, de forma análoga, el banco del beneficiario está al tanto de su cliente beneficiario. Cuando este último genera una solicitud RTP introduciendo el IBAN del pagador, el OSM suministra automáticamente la información del PSP correspondiente, de modo que la petición se dirige al servicio adecuado. Por tanto, en esta emulación se asume la inscripción previa de los actores en el OSM y no se modela el proceso de registro dentro del flujo RTP.

Cuando ejecuto el código y me conecto al servidor lo que se ve es la página del login. Esto emula el proceso de login de la página web o aplicación de un banco real, en la cual si no eres cliente, no puedes acceder.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/LoginForm.png}
  \caption{LoginForm}
  \label{fig:Login}
\end{figure}

Tras iniciar sesión, la aplicación muestra la \textbf{página principal del banco} (Figura \ref{fig:DashBoard}) con los datos esenciales del cliente —nombre, IBAN, saldo y fotografía— y un menú superior que da acceso a funcionalidades habituales como \emph{Cuentas}, \emph{Tarjetas} o \emph{Perfil}. Esta interfaz reproduce la estética y el flujo de una banca en línea real: si no eres cliente, el proceso se detiene en la pantalla de inicio de sesión; si lo eres, se habilitan los paneles correspondientes a tus productos financieros.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/DashBoard.png}
  \caption{DashBoard}
  \label{fig:DashBoard}
\end{figure}

Lo verdaderammente novedoso del prototipo, y por tanto, el \emph{producto} que se "vende" es la nueva opcion \emph{Request To Pay} que aparece en el menú. Dicha opción encapsula todo el software desarrollado ya explicado anteriormente.

La propuesta es que, una vez los bancos se adhieran al esquema RTP, todas las webs y aplicaciones bancarias incorporen esta sección tal y como se muestra aquí. El módulo es independiente, integrable vía API y compatible con las plataformas existentes, de manera que cualquier entidad que se registre en el sistema podría habilitarlo sin rediseñar su banca digital. En síntesis el producto de este TFG es un software que materializa el estándar RTP y lo hace accesible al usuario final desde la misma pantalla donde hoy consulta su saldo o sus tarjetas.

Como el objeto de interés es el apartado RTP el resto de apartados son secciones vacías ya que no aportan nada:

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/Tarjetas.png}
  \caption{Tarjetas}
  \label{fig:Tarjetas}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/Cuentas.png}
  \caption{Cuentas}
  \label{fig:Cuentas}
\end{figure}

En la opción Perfil se pueden consultar o modificar algunos datos.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/Perfil.png}
  \caption{Perfil}
  \label{fig:Perfil}
\end{figure}

Esto aplica a todos los usuarios registrados en la página del banco, tanto empresas como clientes.

A continuación voy a explicar cómo se modela el flujo de un proceso de pago mediante RTP. En primer lugar he iniciado sesión en la página del banco de los cuatro actores para ser conscientes de qué es lo que vería cada uno de ellos durante el proceso.

Me centraré en explicar principalmente el backend, ya que el frontend es una página web y no creo que haya que detallar demasiado.

\begin{itemize}
    \item \textbf{Creación del RTP}\\[6pt]
        El flujo comienza cuando el beneficiario, ya autenticado, envía una
        petición \texttt{POST} a la ruta \texttt{/rtp}.  
        A partir de aquí intervienen dos piezas de código: la capa de
        exposición HTTP y la capa de negocio que materializa la petición.
        \vspace{0.6em}

        %---------------------------------------------------------------
        % 1. Endpoint HTTP (routes.py)
        %---------------------------------------------------------------
       \begin{lstlisting}[language=Python, style=custom, caption={Endpoint creación de solicitud RTP}]
            @rtp_blueprint.route('/rtp', methods=['POST'])
            @role_required('beneficiary')
            def crear_rtp():
                data = request.get_json()
                # ID del beneficiario que está logueado
                beneficiary_id = data.get('actor_id')
                # IBAN del pagador
                payer_iban = data.get('payer_iban')
                # Importe solicitado
                amount = data.get('amount')

                if not payer_iban:
                    return jsonify({"error": "Falta iban"}), 400

                if not amount:
                    return jsonify({"error": "Falta amount"}), 400

                # Delegación a la capa de negocio
                result = crear_rtp_service(data)
                status = 201 if "error" not in result else 400
                return jsonify(result), status
        \end{lstlisting}

        \begin{enumerate}
           \item Se impone un control de acceso que restringe la ruta a
                 beneficiarios.  
           \item Se extraen y validan los tres datos imprescindibles:
                 identificador del beneficiario, IBAN del pagador e importe.  
           \item Si alguno falta, se aborta el flujo devolviendo un error de
                 validación.  
           \item Con los datos verificados, la lógica de negocio toma el
                 relevo y, al finalizar, la ruta convierte su resultado en una
                 respuesta HTTP adecuada (éxito o error).
        \end{enumerate}
        \vspace{0.8em}

        %---------------------------------------------------------------
        % 2. Lógica de negocio (services.py)
        %---------------------------------------------------------------
       \begin{lstlisting}[language=Python, style=custom, caption={Servicio de negocio creacion RTP}]

            def crear_rtp_service(data):
                beneficiary_id = data.get('actor_id')
                payer_iban      = data.get('payer_iban')
                amount          = data.get('amount')

                # 1) Validar beneficiario y su PSP
                beneficiary = Actor.query.get(beneficiary_id)
                if not beneficiary or beneficiary.role != 'beneficiary':
                    return {"error": "El actor no es beneficiario o no existe"}

                if not beneficiary.psp_id:
                    return {"error": "El beneficiario no tiene PSP asociado"}
                psp_benef_id = beneficiary.psp_id

                # 2) Localizar pagador y su PSP
                payer = Actor.query.filter_by(iban=payer_iban, role='payer').first()
                if not payer:
                    return {"error": "No se encontró un pagador con ese IBAN"}

                if not payer.psp_id:
                    return {"error": "El pagador no tiene PSP asociado"}
                psp_payer_id = payer.psp_id

                # 3) Crear y guardar el RTP
                nuevo_rtp = RTP(
                    iban=payer_iban,
                    amount=amount,
                    beneficiary_id=beneficiary.id,
                    psp_beneficiary_id=psp_benef_id,
                    psp_payer_id=psp_payer_id,
                    payer_id=payer.id
                )
                db.session.add(nuevo_rtp)
                db.session.commit()

                # 4) Notificación en tiempo real al PSP del beneficiario
                socketio.emit(
                    'rtp_created',
                    nuevo_rtp.to_dict(),
                    room=f'psp_beneficiary_{psp_benef_id}'
                )

                return {
                    "message": "RTP creado correctamente",
                    "id": nuevo_rtp.id
                }
        \end{lstlisting}

        \begin{enumerate}
          \item Se verifica que el beneficiario existe, posee el rol correcto
                y tiene un PSP asignado.  
          \item Se identifica al pagador mediante su IBAN y se confirma que
                también cuenta con un PSP registrado.  
          \item Una vez validados ambos actores y sus PSP, se crea un registro
                RTP que deja constancia de todos los datos relevantes y se
                persiste en la base de datos.  
          \item Al confirmarse la grabación, se emite un evento en tiempo real
                dirigido al canal del PSP del beneficiario, de modo que este
                recibe instantáneamente la solicitud y puede empezar a
                procesarla.
        \end{enumerate}
        \bigskip

        Gracias a la coordinación entre estos dos bloques de código el primer
        paso del flujo Request~To~Pay queda cubierto: la petición se registra
        de forma duradera y el PSP del beneficiario obtiene la información
        necesaria para continuar con las etapas siguientes.

    \item \textbf{Validación y enrutamiento del RTP por parte del PSP beneficiario}\\[6pt]
        Una vez que el beneficiario ha creado el RTP y el PSP del beneficiario ha
        recibido la notificación, este PSP asume el control para verificar la
        solicitud y, si todo es correcto, remitirla al PSP del pagador.
        \vspace{0.6em}

        %---------------------------------------------------------------
        % 1. Endpoints HTTP (routes.py)
        %---------------------------------------------------------------
       \begin{lstlisting}[language=Python, style=custom, caption={Endpoints para validación y enrutado}]
            @rtp_blueprint.route('/rtp/<int:rtp_id>/validate-beneficiary', methods=['POST'])
            @role_required('psp_beneficiary')
            def validar_beneficiario(rtp_id):
                result = validar_beneficiario_service(rtp_id)
                status = 200 if "error" not in result else 400
                return jsonify(result), status

            @rtp_blueprint.route('/rtp/<int:rtp_id>/route', methods=['POST'])
            @role_required('psp_beneficiary')
            def enrutar_rtp(rtp_id):
                result = enrutar_rtp_service(rtp_id)
                status = 200 if "error" not in result else 400
                return jsonify(result), status
        \end{lstlisting}

        \begin{enumerate}
          \item \emph{Control de acceso}.  
                Ambas rutas están protegidas para garantizar que sólo un actor
                con rol de PSP del beneficiario pueda ejecutar estas acciones.
          \item \emph{Validación inicial}.  
                La primera ruta confirma que el RTP cumple los requisitos
                mínimos (coherencia de datos, existencia, formato, seguridad).
                Si la verificación falla, se devuelve un error; en caso
                contrario, el proceso avanza.
          \item \emph{Enrutamiento}.  
                La segunda ruta, accesible tras la validación, pone el RTP en
                camino hacia el PSP del pagador, devolviendo una respuesta de
                éxito cuando la operación se completa o un error si surge
                alguna incidencia.
        \end{enumerate}
        \vspace{0.8em}

        %---------------------------------------------------------------
        % 2. Lógica de negocio (services.py)
        %---------------------------------------------------------------
       \begin{lstlisting}[language=Python, style=custom, caption={Servicio de negocio validación y enrutado}]
            def validar_beneficiario_service(rtp_id):
                rtp_obj = RTP.query.get(rtp_id)
                if not rtp_obj:
                    return {"error": "RTP no encontrado"}
                result = cambiar_estado_rtp(db, rtp_obj, "validado-beneficiario")

                socketio.emit(
                    'rtp_validated_beneficiary',
                    rtp_obj.to_dict(),
                    room=f'psp_beneficiary_{rtp_obj.psp_beneficiary_id}'
                )
                return result

            def enrutar_rtp_service(rtp_id):
                rtp_obj = RTP.query.get(rtp_id)
                if not rtp_obj:
                    return {"error": "RTP no encontrado"}
                result = cambiar_estado_rtp(db, rtp_obj, "enrutado")

                socketio.emit(
                    'rtp_routed',
                    rtp_obj.to_dict(),
                    room=f'psp_payer_{rtp_obj.psp_payer_id}'
                )
                return result
        \end{lstlisting}
        \begin{enumerate}
          \item \emph{Recuperación y comprobación}.  
                Para cada operación se localiza el registro RTP mediante su
                identificador y se verifica su existencia; de no hallarse, se
                informa del error.
          \item \emph{Actualización de estado}.  
                \begin{itemize}
                  \item En la validación se marca el RTP como
                        \texttt{validado-beneficiario}.  
                  \item En el enrutamiento se actualiza a
                        \texttt{enrutado}, indicando que ya ha sido
                        despachado hacia el PSP del pagador.
                \end{itemize}
          \item \emph{Persistencia}.  
                Cada cambio de estado se registra de forma duradera en la base
                de datos, lo que asegura la trazabilidad del flujo.
          \item \emph{Notificación en tiempo real}.  
                Tras la validación se emite un evento dirigido a la sala del
                propio PSP beneficiario para confirmar la operación; después,
                al enrutarse, se envía otro evento a la sala del PSP del
                pagador, de modo que este último reciba de inmediato la
                solicitud y pueda continuar con el proceso.
        \end{enumerate}
        \bigskip

        Con esta secuencia de pasos, el PSP del beneficiario garantiza la
        integridad técnica y comercial del RTP y lo traslada, de forma segura y
        casi instantánea, al siguiente eslabón de la cadena: el PSP del
        pagador.

         \item \textbf{Validación del RTP por el PSP del pagador}\\[6pt]
        Tras recibir el mensaje «enrutado» proveniente del PSP del
        beneficiario, el PSP del pagador debe decidir si la solicitud es
        aceptable desde un punto de vista operativo (fondos, reglas de riesgo,
        etc.).  Esta responsabilidad vuelve a dividirse entre la capa HTTP y
        la capa de negocio.
        \vspace{0.6em}

        %---------------------------------------------------------------
        % 1. Ruta HTTP (routes.py)
        %---------------------------------------------------------------
       \begin{lstlisting}[language=Python, style=custom, caption={Endpoint validación pagador}]
            @rtp_blueprint.route('/rtp/<int:rtp_id>/validate-payer', methods=['POST'])
            @role_required('psp_payer')
            def validar_payer(rtp_id):
                result = validar_payer_service(rtp_id)
                status = 200 if "error" not in result else 400
                return jsonify(result), status
        \end{lstlisting}

        \begin{enumerate}
          \item El acceso queda restringido al rol \emph{psp\_payer}, impidiendo que
                cualquier otro actor invoque la ruta.
          \item Se delega la lógica de validación al servicio interno,
                traduciendo después su resultado a una respuesta HTTP de éxito
                (200) o error (400).
        \end{enumerate}
        \vspace{0.8em}

        %---------------------------------------------------------------
        % 2. Lógica de negocio (services.py)
        %---------------------------------------------------------------
       \begin{lstlisting}[language=Python, style=custom, caption={Servicio de negocio validación pagador}]
            def validar_payer_service(rtp_id):
                """
                Validación por el PSP del pagador.
                1) Si el pagador no dispone de fondos suficientes, se fuerza el rechazo.
                2) En caso contrario, se marca el RTP como validado por el PSP del pagador.
                """
                rtp_obj = RTP.query.get(rtp_id)
                if not rtp_obj:
                    return {"error": "RTP no encontrado"}

                # Buscar al pagador asociado y verificar su saldo
                from models import Actor
                payer_actor = Actor.query.get(rtp_obj.payer_id)
                if not payer_actor:
                    return {"error": "El payer asignado a este RTP no existe"}

                if payer_actor.balance < rtp_obj.amount:
                    # Rechazo inmediato por falta de fondos
                    return rechazar_rtp(db, rtp_obj, "Saldo insuficiente (PSP forzó cancelación)")

                # Fondos suficientes implica validación satisfactoria
                result = cambiar_estado_rtp(db, rtp_obj, "validado_payer")

                # Notificación al pagador (front-end) para que tome su decisión final
                socketio.emit('rtp_validated_payer',
                            rtp_obj.to_dict(),
                            room=f'payer_{rtp_obj.payer_id}')

                return result
        \end{lstlisting}

        \begin{enumerate}
          \item Se localiza el RTP y se verifica que existe en la base de
                datos.
          \item Se consulta al actor \emph{payer} para comprobar que realmente
                dispone de los fondos necesarios.
          \item Si el saldo es insuficiente, el flujo se interrumpe y el RTP se
                marca como \emph{rechazado}, devolviendo la causa concreta.
          \item Cuando los fondos son suficientes, el estado cambia a
                \emph{validado\_payer}.  Simultáneamente se emite un evento en
                tiempo real hacia la sala del pagador, de modo que su
                aplicación cliente muestre la notificación y solicite al
                usuario la decisión definitiva (aceptar o rechazar el cobro).
        \end{enumerate}
        \bigskip

        Con estas dos piezas de código el PSP del pagador completa su parte:
        revisa la viabilidad financiera y, si procede, deja el RTP listo para
        que el pagador humano confirme el pago o lo rechace.

          \item \textbf{Decisión final del pagador}\\[6pt]
        Cuando el PSP del pagador ha declarado la solicitud viable, el
        control pasa al propio pagador, que puede aceptar o rechazar el
        cobro.  Este último paso del flujo se implementa, como los
        anteriores, con una ruta HTTP y una pieza de lógica de negocio.
        \vspace{0.6em}

        %---------------------------------------------------------------
        % 1. Ruta HTTP (routes.py)
        %---------------------------------------------------------------
       \begin{lstlisting}[language=Python, style=custom, caption={Endpoint decisión final}]
            @rtp_blueprint.route('/rtp/<int:rtp_id>/decision', methods=['POST'])
            @role_required('payer')
            def decision_payer(rtp_id):
                data = request.get_json()
                result = decision_payer_service(rtp_id, data)
                status = 200 if "error" not in result else 400
                return jsonify(result), status
        \end{lstlisting}

        \begin{enumerate}
          \item El acceso se restringe al rol \emph{payer}; ningún otro actor
                puede invocar la ruta.  
          \item La decisión (aceptar o rechazar) llega en el cuerpo JSON
                junto con la identidad del pagador.  
          \item El resultado se traduce en una respuesta HTTP con código
                \texttt{200} si todo fue correcto o \texttt{400} si se
                produjo un error de validación.
        \end{enumerate}
        \vspace{0.8em}

        %---------------------------------------------------------------
        % 2. Lógica de negocio (services.py)
        %---------------------------------------------------------------
       \begin{lstlisting}[language=Python, style=custom, caption={Servicio de negocio decisión final}]
            def decision_payer_service(rtp_id, data):
                """
                Decisión final del pagador: 'aceptado' o 'rechazado'.
                - Si es 'aceptado', se descuentan los fondos.
                - Se registra el nuevo estado y se notifica al beneficiario.
                """
                rtp_obj = RTP.query.get(rtp_id)
                if not rtp_obj:
                    return {"error": "RTP no encontrado"}
                
                decision = data.get('decision')
                if decision not in ["aceptado", "rechazado"]:
                    return {"error": "Decisión no válida"}

                # Descontar fondos si procede
                if decision == "aceptado":
                    from models import Actor
                    payer_actor = Actor.query.get(rtp_obj.payer_id)
                    if not payer_actor:
                        return {"error": "El payer asignado no existe"}
                    if payer_actor.balance < rtp_obj.amount:
                        return rechazar_rtp(db, rtp_obj,
                                            "Saldo insuficiente en el último momento")
                    payer_actor.balance -= rtp_obj.amount
                    db.session.commit()

                result = cambiar_estado_rtp(db, rtp_obj, decision)

                # Aviso en tiempo real al beneficiario
                socketio.emit('rtp_decision',
                            rtp_obj.to_dict(),
                            room=f'beneficiary_{rtp_obj.beneficiary_id}')

                return result
        \end{lstlisting}

        \begin{enumerate}
          \item Se recupera el RTP y se verifica que existe; en caso
                contrario, el proceso se detiene con un error.  
          \item Se comprueba que la elección recibida sea «aceptado» o
                «rechazado».  Cualquier otro valor provoca un error de
                validación.  
          \item Si la opción es «aceptado», se confirma que el pagador
                dispone de saldo suficiente y, de ser así, se descuenta el
                importe correspondiente de su cuenta.  Si no hay fondos, el
                RTP se marca inmediatamente como rechazado.  
          \item Finalmente se actualiza el estado del RTP con la decisión
                tomada y se registra un log con traza hash; al mismo tiempo
                se envía una notificación en tiempo real al beneficiario
                para informarle del resultado.  
        \end{enumerate}
        \bigskip

        Con estas acciones concluye el flujo Request~To~Pay: el pagador
        emite su veredicto, se ejecuta (o cancela) el cargo y todas las
        partes quedan notificadas del desenlace.
\end{itemize}

\section{Pruebas y validación}
\label{subsubsec:PruebasValidacion}
Para las pruebas en \emph{Postman} lo primero fue definir la variable de entorno
\texttt{baseURL}, que almacena la dirección raíz del servidor
(Fig.~\ref{fig:baseURL}).  
De este modo evito repetir la URL completa en cada petición \texttt{POST} o
\texttt{GET}.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/baseURL.png}
  \caption{Variable \texttt{baseURL} en Postman}
  \label{fig:baseURL}
\end{figure}
Con la variable configurada, diseñé un flujo mínimo de peticiones para
verificar los principales endpoints de la API.  
Al inicio del proyecto el servidor carecía de interfaz web, por lo que toda la
validación se realizó a través de Postman: definía la petición, añadía los
parámetros necesarios y comprobaba la respuesta.  
Este ciclo de prueba–error permitió depurar la lógica hasta conseguir un
comportamiento estable.

Durante las primeras fases existían más endpoints de los que finalmente se han
publicado; algunos, como la creación de actores, siguen disponibles pero no
están expuestos en la aplicación web.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/crearActor.png}
  \caption{crearActor}
  \label{fig:crearActor}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/crearActorResponse.png}
  \caption{crearActorResponse}
  \label{fig:crearActorResponse}
\end{figure}

Durante las primeras fases del desarollo se creó una coleccion de peticiones que se activa manualmente para verificar el correcto funcionamiento de la API tras cada cambio en las funcionalidades:

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/MiAPITFG.png}
  \caption{MiAPITFG}
  \label{fig:MiAPITFG}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/RunResults.png}
  \caption{RunResults}
  \label{fig:RunResults}
\end{figure}

Las peticiones relevantes del flujo  son:

\begin{enumerate}
\item \textbf{Creación RTP}
    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/crearRTP.png}
    \caption{crearRTP}
    \label{fig:crearRTP}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/crearRTPResponse.png}
    \caption{crearRTPResponse}
    \label{fig:crearRTPResponse}
    \end{figure}
\item \textbf{Validación y enrutado del PSP del beneficiario}
    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/validarBenef.png}
    \caption{validarBenef}
    \label{fig:validarBenef}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/validarBenefResponse.png}
    \caption{validarBenefResponse}
    \label{fig:validarBenefResponse}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/enrutarBenef.png}
    \caption{enrutarBenef}
    \label{fig:enrutarBenef}
    \end{figure}


    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/enrutarBenefResponse.png}
    \caption{enrutarBenefResponse}
    \label{fig:enrutarBenefResponse}
    \end{figure}

\item \textbf{Validación del PSP del pagador}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/validarPayer.png}
    \caption{validarPayer}
    \label{fig:validarPayer}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/validarPayerResponse.png}
    \caption{validarPayerResponse}
    \label{fig:validarPayerResponse}
    \end{figure}

\item \textbf{Decisión final}
\item 
    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/decision.png}
    \caption{decision}
    \label{fig:decision}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/decisionResponse.png}
    \caption{decisionResponse}
    \label{fig:decisionResponse}
    \end{figure}
\end{enumerate}

Hay ocasiones en las que el flujo no va a completarse debido a errores o rechazos:

Si al crear el RTP el IBAN no corresponde con ningún cliente regitrado en el esquema RTP o no cumple la normativa ISO 13616\footnote{Esta norma internacional define la estructura del IBAN: ES + 2 dígitos de control + 20 dígitos del número de cuenta}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/error1.png}
    \caption{error1}
    \label{fig:error1}
    \end{figure}

Si se crea un RTP con importe mayor al que el pagador puede hacer frente, el RTP llegará hasta el PSP del pagador, quien tras comprobar el importe, lo rechazará.

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/error2_1.png}
    \caption{error2\_1}
    \label{fig:error2_1}
    \end{figure}

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/error2_2.png}
    \caption{error2\_2}
    \label{fig:error2_2}
    \end{figure}

Cuando se crea un RTP deben existir los cuatro actores involucrados o de lo contrario también dará un error:

    \begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Imagenes/error3.png}
    \caption{error3}
    \label{fig:error3}
    \end{figure}


# END FILE CONTENTS


# File: MemoriaTFG/main.lot

\boolfalse {citerequest}\boolfalse {citetracker}\boolfalse {pagetracker}\boolfalse {backtracker}\relax 
\babel@toc {english}{}
\babel@toc {spanish}{}
\babel@toc {spanish}{}
\babel@toc {english}{}
\babel@toc {spanish}{}
\addvspace {10\p@ }
\contentsline {table}{\numberline {1.1}{\ignorespaces Comparativa entre SDD y SRTP con SCT Inst}}{5}{table.1.1}%
\addvspace {10\p@ }
\contentsline {table}{\numberline {2.1}{\ignorespaces Pasos del flujo del esquema SEPA Request-to-Pay (SRTP) y su descripción}}{9}{table.2.1}%
\contentsline {table}{\numberline {2.2}{Pasos del esquema SRTP}}{12}{table.2.2}%
\addvspace {10\p@ }
\contentsline {table}{\numberline {3.1}{Requisitos funcionales}}{27}{table.3.1}%
\contentsline {table}{\numberline {3.2}{Requisitos no funcionales}}{28}{table.3.2}%
\addvspace {10\p@ }
\contentsline {table}{\numberline {4.1}{\ignorespaces Endpoints REST del sistema SRTP}}{47}{table.4.1}%
\addvspace {10\p@ }
\addvspace {10\p@ }
\addvspace {10\p@ }


# END FILE CONTENTS


# File: MemoriaTFG/main.blg

[0] Config.pm:304> INFO - This is Biber 2.14 (beta)
[0] Config.pm:307> INFO - Logfile is 'main.blg'
[63] biber:322> INFO - === Tue Jun 24, 2025, 08:14:14
[78] Biber.pm:415> INFO - Reading 'main.bcf'
[132] Biber.pm:940> INFO - Using all citekeys in bib section 0
[142] Biber.pm:4256> INFO - Processing section 0
[143] Utils.pm:75> INFO - Globbing data source 'bibliografia.bib'
[143] Utils.pm:91> INFO - Globbed data source 'bibliografia.bib' to bibliografia.bib
[157] Biber.pm:4455> INFO - Looking for bibtex format file 'bibliografia.bib' for section 0
[159] bibtex.pm:1653> INFO - LaTeX decoding ...
[171] bibtex.pm:1471> INFO - Found BibTeX data source 'bibliografia.bib'
[263] UCollate.pm:68> INFO - Overriding locale 'en-US' defaults 'normalization = NFD' with 'normalization = prenormalized'
[263] UCollate.pm:68> INFO - Overriding locale 'en-US' defaults 'variable = shifted' with 'variable = non-ignorable'
[263] Biber.pm:4084> INFO - Sorting list 'nyt/global//global/global' of type 'entry' with template 'nyt' and locale 'en-US'
[263] Biber.pm:4090> INFO - No sort tailoring available for locale 'en-US'
[283] bbl.pm:652> INFO - Writing 'main.bbl' with encoding 'UTF-8'
[291] bbl.pm:755> INFO - Output to main.bbl


# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/MAQUINAESTADOS.svg:Zone.Identifier



# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/DIAGRAMA.svg:Zone.Identifier



# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/DIAGRAMA.pdf:Zone.Identifier

[ZoneTransfer]
ZoneId=3
ReferrerUrl=https://convertio.co/
HostUrl=https://s141.convertio.me/p/xoqr3ZdRiNMAjKLKYu5dOA/a41c7c2113f6e5a22b7187c20642ecc7/DIAGRAMA.pdf


# END FILE CONTENTS


# File: MemoriaTFG/castellano2.bst

%%
%% This is file `castellano2.bst',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% merlin.mbs  (with options: `head,exlang,alph,alf-1,vonx,nm-init,ed-au,vnum-nr,volp-com,pgsep-p,jwdpg,jwdvol,num-xser,edpar,spanish,pp,and-xcom,etal-xc,etal-it,nfss,,{}')
%% spanish.mbs  (with options: `exlang,alph,alf-1,vonx,nm-init,ed-au,vnum-nr,volp-com,pgsep-p,jwdpg,jwdvol,num-xser,edpar,spanish,pp,and-xcom,etal-xc,etal-it,nfss,,{}')
%% merlin.mbs  (with options: `tail,exlang,alph,alf-1,vonx,nm-init,ed-au,vnum-nr,volp-com,pgsep-p,jwdpg,jwdvol,num-xser,edpar,spanish,pp,and-xcom,etal-xc,etal-it,nfss,,{}')
%% ----------------------------------------
%% *** bibliofrafia en castellano con citas nominales ***
%% 
%% Copyright 1994-2005 Patrick W Daly
 % ===============================================================
 % IMPORTANT NOTICE:
 % This bibliographic style (bst) file has been generated from one or
 % more master bibliographic style (mbs) files, listed above.
 %
 % This generated file can be redistributed and/or modified under the terms
 % of the LaTeX Project Public License Distributed from CTAN
 % archives in directory macros/latex/base/lppl.txt; either
 % version 1 of the License, or any later version.
 % ===============================================================
 % Name and version information of the main mbs file:
 % \ProvidesFile{merlin.mbs}[2005/10/17 4.14 (PWD, AO, DPC)]
 %   For use with BibTeX version 0.99a or later
 %-------------------------------------------------------------------
 % This bibliography style file is intended for texts in
 %   SPANISH
 % This is a labelled citation style similar to the standard alpha.bst,
 %   where labels are of the form Dal90 or DBK89.
 % It requires no extra package to interface to the main text.
 % The form of the \bibitem entries is
 %   \bibitem[label]{key}...
 % Usage of \cite is as follows:
 %   \cite{key} ==>>          [label]
 %   \cite[chap. 2]{key} ==>> [label, chap. 2]
 % The order in the reference list is by label.
 %---------------------------------------------------------------------

ENTRY
  { address
    author
    booktitle
    chapter
    edition
    editor
    eid
    howpublished
    institution
    journal
    key
    month
    note
    number
    organization
    pages
    publisher
    school
    series
    title
    type
    volume
    year
  }
  {}
  { label extra.label sort.label }
INTEGERS { output.state before.all mid.sentence after.sentence after.block }
FUNCTION {init.state.consts}
{ #0 'before.all :=
  #1 'mid.sentence :=
  #2 'after.sentence :=
  #3 'after.block :=
}
STRINGS { s t}
FUNCTION {output.nonnull}
{ 's :=
  output.state mid.sentence =
    { ", " * write$ }
    { output.state after.block =
        { add.period$ write$
          newline$
          "\newblock " write$
        }
        { output.state before.all =
            'write$
            { add.period$ " " * write$ }
          if$
        }
      if$
      mid.sentence 'output.state :=
    }
  if$
  s
}
FUNCTION {output}
{ duplicate$ empty$
    'pop$
    'output.nonnull
  if$
}
FUNCTION {output.check}
{ 't :=
  duplicate$ empty$
    { pop$ "empty " t * " in " * cite$ * warning$ }
    'output.nonnull
  if$
}
FUNCTION {fin.entry}
{ add.period$
  write$
  newline$
}

FUNCTION {new.block}
{ output.state before.all =
    'skip$
    { after.block 'output.state := }
  if$
}
FUNCTION {new.sentence}
{ output.state after.block =
    'skip$
    { output.state before.all =
        'skip$
        { after.sentence 'output.state := }
      if$
    }
  if$
}
FUNCTION {add.blank}
{  " " * before.all 'output.state :=
}

FUNCTION {date.block}
{
  new.block
}

FUNCTION {not}
{   { #0 }
    { #1 }
  if$
}
FUNCTION {and}
{   'skip$
    { pop$ #0 }
  if$
}
FUNCTION {or}
{   { pop$ #1 }
    'skip$
  if$
}
FUNCTION {new.block.checka}
{ empty$
    'skip$
    'new.block
  if$
}
FUNCTION {new.block.checkb}
{ empty$
  swap$ empty$
  and
    'skip$
    'new.block
  if$
}
FUNCTION {new.sentence.checka}
{ empty$
    'skip$
    'new.sentence
  if$
}
FUNCTION {new.sentence.checkb}
{ empty$
  swap$ empty$
  and
    'skip$
    'new.sentence
  if$
}
FUNCTION {field.or.null}
{ duplicate$ empty$
    { pop$ "" }
    'skip$
  if$
}
FUNCTION {emphasize}
{ duplicate$ empty$
    { pop$ "" }
    { "\emph{" swap$ * "}" * }
  if$
}
FUNCTION {tie.or.space.prefix}
{ duplicate$ text.length$ #3 <
    { "~" }
    { " " }
  if$
  swap$
}

FUNCTION {capitalize}
{ "u" change.case$ "t" change.case$ }

FUNCTION {space.word}
{ " " swap$ * " " * }
 % Here are the language-specific definitions for explicit words.
 % Each function has a name bbl.xxx where xxx is the English word.
 %-------------------------------------------------------------------
 % Begin module:
 % \ProvidesFile{spanish.mbs}[2003/11/06 4.2 (PWD/TB)]

 % The language selected here is SPANISH
FUNCTION {bbl.and}
{ "y"}

FUNCTION {bbl.etal}
{ "et~al." }

FUNCTION {bbl.editors}
{ "editores" }

FUNCTION {bbl.editor}
{ "editor" }

FUNCTION {bbl.edby}
{ "editado por" }

FUNCTION {bbl.edition}
{ "edici\'on" }

FUNCTION {bbl.volume}
{ "volumen" }

FUNCTION {bbl.of}
{ "de" }

FUNCTION {bbl.number}
{ "n\'umero" }

FUNCTION {bbl.nr}
{ "n\raise1ex\hbox{\underbar{\scriptsize o}}" }

FUNCTION {bbl.in}
{ "en" }

FUNCTION {bbl.pages}
{ "p\'ags." }

FUNCTION {bbl.page}
{ "p\'ag." }

FUNCTION {bbl.chapter}
{ "cap\'{\i}tulo" }

FUNCTION {bbl.techrep}
{ "Informe T\'ecnico" }

FUNCTION {bbl.mthesis}
{ "Proyecto Fin de Carrera" }

FUNCTION {bbl.phdthesis}
{ "Tesis Doctoral" }

FUNCTION {bbl.first}
{ "primera" }

FUNCTION {bbl.second}
{ "segunda" }

FUNCTION {bbl.third}
{ "tercera" }

FUNCTION {bbl.fourth}
{ "cuarta" }

FUNCTION {bbl.fifth}
{ "quinta" }

FUNCTION {bbl.th}
{ "\raise1ex\hbox{\underbar{\scriptsize a}}" }

MACRO {jan} {"enero"}

MACRO {feb} {"febrero"}

MACRO {mar} {"marzo"}

MACRO {apr} {"abril"}

MACRO {may} {"mayo"}

MACRO {jun} {"junio"}

MACRO {jul} {"julio"}

MACRO {aug} {"agosto"}

MACRO {sep} {"septiembre"}

MACRO {oct} {"octubre"}

MACRO {nov} {"noviembre"}

MACRO {dec} {"diciembre"}

 % End module: spanish.mbs
%% Copyright 1994-2005 Patrick W Daly
MACRO {acmcs} {"ACM Computing Surveys"}

MACRO {acta} {"Acta Informatica"}

MACRO {cacm} {"Communications of the ACM"}

MACRO {ibmjrd} {"IBM Journal of Research and Development"}

MACRO {ibmsj} {"IBM Systems Journal"}

MACRO {ieeese} {"IEEE Transactions on Software Engineering"}

MACRO {ieeetc} {"IEEE Transactions on Computers"}

MACRO {ieeetcad}
 {"IEEE Transactions on Computer-Aided Design of Integrated Circuits"}

MACRO {ipl} {"Information Processing Letters"}

MACRO {jacm} {"Journal of the ACM"}

MACRO {jcss} {"Journal of Computer and System Sciences"}

MACRO {scp} {"Science of Computer Programming"}

MACRO {sicomp} {"SIAM Journal on Computing"}

MACRO {tocs} {"ACM Transactions on Computer Systems"}

MACRO {tods} {"ACM Transactions on Database Systems"}

MACRO {tog} {"ACM Transactions on Graphics"}

MACRO {toms} {"ACM Transactions on Mathematical Software"}

MACRO {toois} {"ACM Transactions on Office Information Systems"}

MACRO {toplas} {"ACM Transactions on Programming Languages and Systems"}

MACRO {tcs} {"Theoretical Computer Science"}
FUNCTION {bibinfo.check}
{ swap$
  duplicate$ missing$
    {
      pop$ pop$
      ""
    }
    { duplicate$ empty$
        {
          swap$ pop$
        }
        { swap$
          pop$
        }
      if$
    }
  if$
}
FUNCTION {bibinfo.warn}
{ swap$
  duplicate$ missing$
    {
      swap$ "missing " swap$ * " in " * cite$ * warning$ pop$
      ""
    }
    { duplicate$ empty$
        {
          swap$ "empty " swap$ * " in " * cite$ * warning$
        }
        { swap$
          pop$
        }
      if$
    }
  if$
}
STRINGS  { bibinfo}
INTEGERS { nameptr namesleft numnames }

FUNCTION {format.names}
{ 'bibinfo :=
  duplicate$ empty$ 'skip$ {
  's :=
  "" 't :=
  #1 'nameptr :=
  s num.names$ 'numnames :=
  numnames 'namesleft :=
    { namesleft #0 > }
    { s nameptr
      "{f.~}{vv~}{ll}{, jj}"
      format.name$
      bibinfo bibinfo.check
      't :=
      nameptr #1 >
        {
          namesleft #1 >
            { ", " * t * }
            {
              s nameptr "{ll}" format.name$ duplicate$ "others" =
                { 't := }
                { pop$ }
              if$
              t "others" =
                {
                  " " * bbl.etal emphasize *
                }
                {
                  bbl.and
                  space.word * t *
                }
              if$
            }
          if$
        }
        't
      if$
      nameptr #1 + 'nameptr :=
      namesleft #1 - 'namesleft :=
    }
  while$
  } if$
}
FUNCTION {format.names.ed}
{
  format.names
}
FUNCTION {format.authors}
{ author "author" format.names
}
FUNCTION {get.bbl.editor}
{ editor num.names$ #1 > 'bbl.editors 'bbl.editor if$ }

FUNCTION {format.editors}
{ editor "editor" format.names duplicate$ empty$ 'skip$
    {
      " " *
      get.bbl.editor
   "(" swap$ * ")" *
      *
    }
  if$
}
FUNCTION {format.note}
{
 note empty$
    { "" }
    { note #1 #1 substring$
      duplicate$ "{" =
        'skip$
        { output.state mid.sentence =
          { "l" }
          { "u" }
        if$
        change.case$
        }
      if$
      note #2 global.max$ substring$ * "note" bibinfo.check
    }
  if$
}

FUNCTION {format.title}
{ title
  duplicate$ empty$ 'skip$
    { "t" change.case$ }
  if$
  "title" bibinfo.check
}
FUNCTION {output.bibitem}
{ newline$
  "\bibitem[" label * "]{" * write$
  cite$ write$
  "}" write$
  newline$
  ""
  before.all 'output.state :=
}

FUNCTION {if.digit}
{ duplicate$ "0" =
  swap$ duplicate$ "1" =
  swap$ duplicate$ "2" =
  swap$ duplicate$ "3" =
  swap$ duplicate$ "4" =
  swap$ duplicate$ "5" =
  swap$ duplicate$ "6" =
  swap$ duplicate$ "7" =
  swap$ duplicate$ "8" =
  swap$ "9" = or or or or or or or or or
}
FUNCTION {n.separate}
{ 't :=
  ""
  #0 'numnames :=
  { t empty$ not }
  { t #-1 #1 substring$ if.digit
      { numnames #1 + 'numnames := }
      { #0 'numnames := }
    if$
    t #-1 #1 substring$ swap$ *
    t #-2 global.max$ substring$ 't :=
    numnames #5 =
      { duplicate$ #1 #2 substring$ swap$
        #3 global.max$ substring$
        "." swap$ * *
      }
      'skip$
    if$
  }
  while$
}
FUNCTION {n.dashify}
{
  n.separate
  't :=
  ""
    { t empty$ not }
    { t #1 #1 substring$ "-" =
        { t #1 #2 substring$ "--" = not
            { "--" *
              t #2 global.max$ substring$ 't :=
            }
            {   { t #1 #1 substring$ "-" = }
                { "-" *
                  t #2 global.max$ substring$ 't :=
                }
              while$
            }
          if$
        }
        { t #1 #1 substring$ *
          t #2 global.max$ substring$ 't :=
        }
      if$
    }
  while$
}

FUNCTION {word.in}
{ bbl.in capitalize
  " " * }

FUNCTION {format.date}
{
  month "month" bibinfo.check
  duplicate$ empty$
  year  "year"  bibinfo.check duplicate$ empty$
    { swap$ 'skip$
        { "there's a month but no year in " cite$ * warning$ }
      if$
      *
    }
    { swap$ 'skip$
        {
          swap$
          " " * bbl.of * " " * swap$
        }
      if$
      *
    }
  if$
}
FUNCTION {format.btitle}
{ title "title" bibinfo.check
  duplicate$ empty$ 'skip$
    {
      emphasize
    }
  if$
}
FUNCTION {either.or.check}
{ empty$
    'pop$
    { "can't use both " swap$ * " fields in " * cite$ * warning$ }
  if$
}
FUNCTION {format.bvolume}
{ volume empty$
    { "" }
    { bbl.volume volume tie.or.space.prefix
      "volume" bibinfo.check * *
      series "series" bibinfo.check
      duplicate$ empty$ 'pop$
        { swap$ bbl.of space.word * swap$
          emphasize * }
      if$
      "volume and number" number either.or.check
    }
  if$
}
FUNCTION {format.number.series}
{ volume empty$
    { number empty$
        { series field.or.null }
        { series empty$
            { number "number" bibinfo.check }
            { output.state mid.sentence =
                { bbl.number }
                { bbl.number capitalize }
              if$
              number tie.or.space.prefix "number" bibinfo.check * *
              bbl.in space.word *
              series "series" bibinfo.check *
            }
          if$
        }
      if$
    }
    { "" }
  if$
}
FUNCTION {is.num}
{ chr.to.int$
  duplicate$ "0" chr.to.int$ < not
  swap$ "9" chr.to.int$ > not and
}

FUNCTION {extract.num}
{ duplicate$ 't :=
  "" 's :=
  { t empty$ not }
  { t #1 #1 substring$
    t #2 global.max$ substring$ 't :=
    duplicate$ is.num
      { s swap$ * 's := }
      { pop$ "" 't := }
    if$
  }
  while$
  s empty$
    'skip$
    { pop$ s }
  if$
}

FUNCTION {convert.edition}
{ extract.num "l" change.case$ 's :=
  s "first" = s "1" = or
    { bbl.first 't := }
    { s "second" = s "2" = or
        { bbl.second 't := }
        { s "third" = s "3" = or
            { bbl.third 't := }
            { s "fourth" = s "4" = or
                { bbl.fourth 't := }
                { s "fifth" = s "5" = or
                    { bbl.fifth 't := }
                    { s #1 #1 substring$ is.num
                        { s bbl.th * 't := }
                        { edition 't := }
                      if$
                    }
                  if$
                }
              if$
            }
          if$
        }
      if$
    }
  if$
  t
}

FUNCTION {format.edition}
{ edition duplicate$ empty$ 'skip$
    {
      convert.edition
      output.state mid.sentence =
        { "l" }
        { "t" }
      if$ change.case$
      "edition" bibinfo.check
      " " * bbl.edition *
    }
  if$
}
INTEGERS { multiresult }
FUNCTION {multi.page.check}
{ 't :=
  #0 'multiresult :=
    { multiresult not
      t empty$ not
      and
    }
    { t #1 #1 substring$
      duplicate$ "-" =
      swap$ duplicate$ "," =
      swap$ "+" =
      or or
        { #1 'multiresult := }
        { t #2 global.max$ substring$ 't := }
      if$
    }
  while$
  multiresult
}
FUNCTION {format.pages}
{ pages duplicate$ empty$ 'skip$
    { duplicate$ multi.page.check
        {
          bbl.pages swap$
          n.dashify
        }
        {
          bbl.page swap$
        }
      if$
      tie.or.space.prefix
      "pages" bibinfo.check
      * *
    }
  if$
}
FUNCTION {format.journal.pages}
{ pages duplicate$ empty$ 'pop$
    { swap$ duplicate$ empty$
        { pop$ pop$ format.pages }
        {
          ", " *
          swap$
          n.dashify
          pages multi.page.check
            'bbl.pages
            'bbl.page
          if$
          swap$ tie.or.space.prefix
          "pages" bibinfo.check
          * *
          *
        }
      if$
    }
  if$
}
FUNCTION {format.journal.eid}
{ eid "eid" bibinfo.check
  duplicate$ empty$ 'pop$
    { swap$ duplicate$ empty$ 'skip$
      {
          ", " *
      }
      if$
      swap$ *
    }
  if$
}
FUNCTION {format.vol.num.pages}
{ volume field.or.null
  duplicate$ empty$ 'skip$
    {
      bbl.volume swap$ tie.or.space.prefix
      "volume" bibinfo.check
      * *
    }
  if$
  number "number" bibinfo.check duplicate$ empty$ 'skip$
    {
      swap$ duplicate$ empty$
        { "there's a number but no volume in " cite$ * warning$ }
        'skip$
      if$
      swap$
      ", " bbl.nr * number tie.or.space.prefix pop$ * swap$ *
    }
  if$ *
  eid empty$
    { format.journal.pages }
    { format.journal.eid }
  if$
}

FUNCTION {format.chapter.pages}
{ chapter empty$
    'format.pages
    { type empty$
        { bbl.chapter }
        { type "l" change.case$
          "type" bibinfo.check
        }
      if$
      chapter tie.or.space.prefix
      "chapter" bibinfo.check
      * *
      pages empty$
        'skip$
        { ", " * format.pages * }
      if$
    }
  if$
}

FUNCTION {format.booktitle}
{
  booktitle "booktitle" bibinfo.check
  emphasize
}
FUNCTION {format.in.ed.booktitle}
{ format.booktitle duplicate$ empty$ 'skip$
    {
      editor "editor" format.names.ed duplicate$ empty$ 'pop$
        {
          " " *
          get.bbl.editor
          "(" swap$ * "), " *
          * swap$
          * }
      if$
      word.in swap$ *
    }
  if$
}
FUNCTION {empty.misc.check}
{ author empty$ title empty$ howpublished empty$
  month empty$ year empty$ note empty$
  and and and and and
  key empty$ not and
    { "all relevant fields are empty in " cite$ * warning$ }
    'skip$
  if$
}
FUNCTION {format.thesis.type}
{ type duplicate$ empty$
    'pop$
    { swap$ pop$
      "t" change.case$ "type" bibinfo.check
    }
  if$
}
FUNCTION {format.tr.number}
{ number "number" bibinfo.check
  type duplicate$ empty$
    { pop$ bbl.techrep }
    'skip$
  if$
  "type" bibinfo.check
  swap$ duplicate$ empty$
    { pop$ "t" change.case$ }
    { tie.or.space.prefix * * }
  if$
}
FUNCTION {format.article.crossref}
{
  key duplicate$ empty$
    { pop$
      journal duplicate$ empty$
        { "need key or journal for " cite$ * " to crossref " * crossref * warning$ }
        { "journal" bibinfo.check emphasize word.in swap$ * }
      if$
    }
    { word.in swap$ * " " *}
  if$
  " \cite{" * crossref * "}" *
}
FUNCTION {format.crossref.editor}
{ editor #1 "{vv~}{ll}" format.name$
  "editor" bibinfo.check
  editor num.names$ duplicate$
  #2 >
    { pop$
      "editor" bibinfo.check
      " " * bbl.etal
      emphasize
      *
    }
    { #2 <
        'skip$
        { editor #2 "{ff }{vv }{ll}{ jj}" format.name$ "others" =
            {
              "editor" bibinfo.check
              " " * bbl.etal
              emphasize
              *
            }
            {
             bbl.and space.word
              * editor #2 "{vv~}{ll}" format.name$
              "editor" bibinfo.check
              *
            }
          if$
        }
      if$
    }
  if$
}
FUNCTION {format.book.crossref}
{ volume duplicate$ empty$
    { "empty volume in " cite$ * "'s crossref of " * crossref * warning$
      pop$ word.in
    }
    { bbl.volume
      capitalize
      swap$ tie.or.space.prefix "volume" bibinfo.check * * bbl.of space.word *
    }
  if$
  editor empty$
  editor field.or.null author field.or.null =
  or
    { key empty$
        { series empty$
            { "need editor, key, or series for " cite$ * " to crossref " *
              crossref * warning$
              "" *
            }
            { series emphasize * }
          if$
        }
        { key * }
      if$
    }
    { format.crossref.editor * }
  if$
  " \cite{" * crossref * "}" *
}
FUNCTION {format.incoll.inproc.crossref}
{
  editor empty$
  editor field.or.null author field.or.null =
  or
    { key empty$
        { format.booktitle duplicate$ empty$
            { "need editor, key, or booktitle for " cite$ * " to crossref " *
              crossref * warning$
            }
            { word.in swap$ * }
          if$
        }
        { word.in key * " " *}
      if$
    }
    { word.in format.crossref.editor * " " *}
  if$
  " \cite{" * crossref * "}" *
}
FUNCTION {format.org.or.pub}
{ 't :=
  ""
  address empty$ t empty$ and
    'skip$
    {
      t empty$
        { address "address" bibinfo.check *
        }
        { t *
          address empty$
            'skip$
            { ", " * address "address" bibinfo.check * }
          if$
        }
      if$
    }
  if$
}
FUNCTION {format.publisher.address}
{ publisher "publisher" bibinfo.warn format.org.or.pub
}

FUNCTION {format.organization.address}
{ organization "organization" bibinfo.check format.org.or.pub
}

FUNCTION {article}
{ output.bibitem
  format.authors "author" output.check
  new.block
  format.title "title" output.check
  new.block
  crossref missing$
    {
      journal
      "journal" bibinfo.check
      emphasize
      "journal" output.check
      format.vol.num.pages output
      format.date "year" output.check
    }
    { format.article.crossref output.nonnull
      format.pages output
    }
  if$
  new.block
  format.note output
  fin.entry
}
FUNCTION {book}
{ output.bibitem
  author empty$
    { format.editors "author and editor" output.check
    }
    { format.authors output.nonnull
      crossref missing$
        { "author and editor" editor either.or.check }
        'skip$
      if$
    }
  if$
  new.block
  format.btitle "title" output.check
  crossref missing$
    { format.bvolume output
      new.block
      format.number.series output
      new.sentence
      format.publisher.address output
    }
    {
      new.block
      format.book.crossref output.nonnull
    }
  if$
  format.edition output
  format.date "year" output.check
  new.block
  format.note output
  fin.entry
}
FUNCTION {booklet}
{ output.bibitem
  format.authors output
  new.block
  format.title "title" output.check
  new.block
  howpublished "howpublished" bibinfo.check output
  address "address" bibinfo.check output
  format.date output
  new.block
  format.note output
  fin.entry
}

FUNCTION {inbook}
{ output.bibitem
  author empty$
    { format.editors "author and editor" output.check
    }
    { format.authors output.nonnull
      crossref missing$
        { "author and editor" editor either.or.check }
        'skip$
      if$
    }
  if$
  new.block
  format.btitle "title" output.check
  crossref missing$
    {
      format.bvolume output
      format.chapter.pages "chapter and pages" output.check
      new.block
      format.number.series output
      new.sentence
      format.publisher.address output
    }
    {
      format.chapter.pages "chapter and pages" output.check
      new.block
      format.book.crossref output.nonnull
    }
  if$
  format.edition output
  format.date "year" output.check
  new.block
  format.note output
  fin.entry
}

FUNCTION {incollection}
{ output.bibitem
  format.authors "author" output.check
  new.block
  format.title "title" output.check
  new.block
  crossref missing$
    { format.in.ed.booktitle "booktitle" output.check
      format.bvolume output
      format.number.series output
      format.chapter.pages output
      new.sentence
      format.publisher.address output
      format.edition output
      format.date "year" output.check
    }
    { format.incoll.inproc.crossref output.nonnull
      format.chapter.pages output
    }
  if$
  new.block
  format.note output
  fin.entry
}
FUNCTION {inproceedings}
{ output.bibitem
  format.authors "author" output.check
  new.block
  format.title "title" output.check
  new.block
  crossref missing$
    { format.in.ed.booktitle "booktitle" output.check
      format.bvolume output
      format.number.series output
      format.pages output
      new.sentence
      publisher empty$
        { format.organization.address output }
        { organization "organization" bibinfo.check output
          format.publisher.address output
        }
      if$
      format.date "year" output.check
    }
    { format.incoll.inproc.crossref output.nonnull
      format.pages output
    }
  if$
  new.block
  format.note output
  fin.entry
}
FUNCTION {conference} { inproceedings }
FUNCTION {manual}
{ output.bibitem
  author empty$
    { organization "organization" bibinfo.check
      duplicate$ empty$ 'pop$
        { output
          address "address" bibinfo.check output
        }
      if$
    }
    { format.authors output.nonnull }
  if$
  new.block
  format.btitle "title" output.check
  author empty$
    { organization empty$
        {
          address new.block.checka
          address "address" bibinfo.check output
        }
        'skip$
      if$
    }
    {
      organization address new.block.checkb
      organization "organization" bibinfo.check output
      address "address" bibinfo.check output
    }
  if$
  format.edition output
  format.date output
  new.block
  format.note output
  fin.entry
}

FUNCTION {mastersthesis}
{ output.bibitem
  format.authors "author" output.check
  new.block
  format.btitle
  "title" output.check
  new.block
  bbl.mthesis format.thesis.type output.nonnull
  school "school" bibinfo.warn output
  address "address" bibinfo.check output
  format.date "year" output.check
  new.block
  format.note output
  fin.entry
}

FUNCTION {misc}
{ output.bibitem
  format.authors output
  title howpublished new.block.checkb
  format.title output
  howpublished new.block.checka
  howpublished "howpublished" bibinfo.check output
  format.date output
  new.block
  format.note output
  fin.entry
  empty.misc.check
}
FUNCTION {phdthesis}
{ output.bibitem
  format.authors "author" output.check
  new.block
  format.btitle
  "title" output.check
  new.block
  bbl.phdthesis format.thesis.type output.nonnull
  school "school" bibinfo.warn output
  address "address" bibinfo.check output
  format.date "year" output.check
  new.block
  format.note output
  fin.entry
}

FUNCTION {proceedings}
{ output.bibitem
  editor empty$
    { organization "organization" bibinfo.check output
    }
    { format.editors output.nonnull }
  if$
  new.block
  format.btitle "title" output.check
  format.bvolume output
  format.number.series output
  editor empty$
    { publisher empty$
        'skip$
        {
          new.sentence
          format.publisher.address output
        }
      if$
    }
    { publisher empty$
        {
          new.sentence
          format.organization.address output }
        {
          new.sentence
          organization "organization" bibinfo.check output
          format.publisher.address output
        }
      if$
     }
  if$
      format.date "year" output.check
  new.block
  format.note output
  fin.entry
}

FUNCTION {techreport}
{ output.bibitem
  format.authors "author" output.check
  new.block
  format.title
  "title" output.check
  new.block
  format.tr.number output.nonnull
  institution "institution" bibinfo.warn output
  address "address" bibinfo.check output
  format.date "year" output.check
  new.block
  format.note output
  fin.entry
}

FUNCTION {unpublished}
{ output.bibitem
  format.authors "author" output.check
  new.block
  format.title "title" output.check
  format.date output
  new.block
  format.note "note" output.check
  fin.entry
}

FUNCTION {default.type} { misc }
READ
FUNCTION {sortify}
{ purify$
  "l" change.case$
}
INTEGERS { len }
FUNCTION {chop.word}
{ 's :=
  'len :=
  s #1 len substring$ =
    { s len #1 + global.max$ substring$ }
    's
  if$
}
INTEGERS { et.al.char.used }
FUNCTION {initialize.et.al.char.used}
{ #0 'et.al.char.used :=
}
EXECUTE {initialize.et.al.char.used}
FUNCTION {format.lab.names}
{ 's :=
  s #1 "{l{}}" format.name$
  duplicate$ text.length$ #2 <
    { pop$ s #1 "{ll}" format.name$ #3 text.prefix$ }
      'skip$
    if$
}
FUNCTION {author.key.label}
{ author empty$
    { key empty$
        { cite$ #1 #3 substring$ }
        { key #3 text.prefix$ }
      if$
    }
    { author format.lab.names }
  if$
}

FUNCTION {author.editor.key.label}
{ author empty$
    { editor empty$
        { key empty$
            { cite$ #1 #3 substring$ }
            { key #3 text.prefix$ }
          if$
        }
        { editor format.lab.names }
      if$
    }
    { author format.lab.names }
  if$
}

FUNCTION {author.key.organization.label}
{ author empty$
    { key empty$
        { organization empty$
            { cite$ #1 #3 substring$ }
            { "The " #4 organization chop.word #3 text.prefix$ }
          if$
        }
        { key #3 text.prefix$ }
      if$
    }
    { author format.lab.names }
  if$
}

FUNCTION {editor.key.organization.label}
{ editor empty$
    { key empty$
        { organization empty$
            { cite$ #1 #3 substring$ }
            { "The " #4 organization chop.word #3 text.prefix$ }
          if$
        }
        { key #3 text.prefix$ }
      if$
    }
    { editor format.lab.names }
  if$
}

FUNCTION {calc.label}
{ type$ "book" =
  type$ "inbook" =
  or
    'author.editor.key.label
    { type$ "proceedings" =
        'editor.key.organization.label
        { type$ "manual" =
            'author.key.organization.label
            'author.key.label
          if$
        }
      if$
    }
  if$
  duplicate$
  year field.or.null purify$ #-1 #2 substring$
  *
  'label :=
  year field.or.null purify$ #-1 #4 substring$
  *
  sortify 'sort.label :=
}
FUNCTION {sort.format.names}
{ 's :=
  #1 'nameptr :=
  ""
  s num.names$ 'numnames :=
  numnames 'namesleft :=
    { namesleft #0 > }
    { s nameptr
      "{ll{ }}{  f{ }}{  jj{ }}"
      format.name$ 't :=
      nameptr #1 >
        {
          "   "  *
          namesleft #1 = t "others" = and
            { "zzzzz" * }
            { t sortify * }
          if$
        }
        { t sortify * }
      if$
      nameptr #1 + 'nameptr :=
      namesleft #1 - 'namesleft :=
    }
  while$
}

FUNCTION {sort.format.title}
{ 't :=
  "A " #2
    "An " #3
      "The " #4 t chop.word
    chop.word
  chop.word
  sortify
  #1 global.max$ substring$
}
FUNCTION {author.sort}
{ author empty$
    { key empty$
        { "to sort, need author or key in " cite$ * warning$
          ""
        }
        { key sortify }
      if$
    }
    { author sort.format.names }
  if$
}
FUNCTION {author.editor.sort}
{ author empty$
    { editor empty$
        { key empty$
            { "to sort, need author, editor, or key in " cite$ * warning$
              ""
            }
            { key sortify }
          if$
        }
        { editor sort.format.names }
      if$
    }
    { author sort.format.names }
  if$
}
FUNCTION {author.organization.sort}
{ author empty$
    { organization empty$
        { key empty$
            { "to sort, need author, organization, or key in " cite$ * warning$
              ""
            }
            { key sortify }
          if$
        }
        { "The " #4 organization chop.word sortify }
      if$
    }
    { author sort.format.names }
  if$
}
FUNCTION {editor.organization.sort}
{ editor empty$
    { organization empty$
        { key empty$
            { "to sort, need editor, organization, or key in " cite$ * warning$
              ""
            }
            { key sortify }
          if$
        }
        { "The " #4 organization chop.word sortify }
      if$
    }
    { editor sort.format.names }
  if$
}
FUNCTION {presort}
{ calc.label
  sort.label
  "    "
  *
  type$ "book" =
  type$ "inbook" =
  or
    'author.editor.sort
    { type$ "proceedings" =
        'editor.organization.sort
        { type$ "manual" =
            'author.organization.sort
            'author.sort
          if$
        }
      if$
    }
  if$
  *
  "    "
  *
  year field.or.null sortify
  *
  "    "
  *
  title field.or.null
  sort.format.title
  *
  #1 entry.max$ substring$
  'sort.key$ :=
}
ITERATE {presort}
SORT
STRINGS { longest.label last.sort.label next.extra }
INTEGERS { longest.label.width last.extra.num }
FUNCTION {initialize.longest.label}
{ "" 'longest.label :=
  #0 int.to.chr$ 'last.sort.label :=
  "" 'next.extra :=
  #0 'longest.label.width :=
  #0 'last.extra.num :=
}
FUNCTION {forward.pass}
{ last.sort.label sort.label =
    { last.extra.num #1 + 'last.extra.num :=
      last.extra.num int.to.chr$ 'extra.label :=
    }
    { "a" chr.to.int$ 'last.extra.num :=
      "" 'extra.label :=
      sort.label 'last.sort.label :=
    }
  if$
}
FUNCTION {reverse.pass}
{ next.extra "b" =
    { "a" 'extra.label := }
    'skip$
  if$
  label extra.label * 'label :=
  label width$ longest.label.width >
    { label 'longest.label :=
      label width$ 'longest.label.width :=
    }
    'skip$
  if$
  extra.label 'next.extra :=
}
EXECUTE {initialize.longest.label}
ITERATE {forward.pass}
REVERSE {reverse.pass}
FUNCTION {begin.bib}
{ et.al.char.used
    { "\newcommand{\etalchar}[1]{$^{#1}$}" write$ newline$ }
    'skip$
  if$
  preamble$ empty$
    'skip$
    { preamble$ write$ newline$ }
  if$
  "\begin{thebibliography}{"  longest.label  * "}" *
  write$ newline$
}
EXECUTE {begin.bib}
EXECUTE {init.state.consts}
ITERATE {call.type$}
FUNCTION {end.bib}
{ newline$
  "\end{thebibliography}" write$ newline$
}
EXECUTE {end.bib}
%% End of customized bst file
%%
%% End of file `castellano2.bst'.


# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/ER.svg:Zone.Identifier



# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/DiagComp.svg

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="464px" preserveAspectRatio="none" style="width:774px;height:464px;background:#FFFFFF;" version="1.1" viewBox="0 0 774 464" width="774px" zoomAndPan="magnify"><defs/><g><!--cluster Prototipo SRTP--><g class="cluster" data-entity="Prototipo SRTP" data-source-line="1" data-uid="ent0002" id="cluster_Prototipo SRTP"><path d="M25.73,6 L146.5025,6 A3.75,3.75 0 0 1 149.0025,8.5 L156.0025,28.2969 L469.73,28.2969 A2.5,2.5 0 0 1 472.23,30.7969 L472.23,454.69 A2.5,2.5 0 0 1 469.73,457.19 L25.73,457.19 A2.5,2.5 0 0 1 23.23,454.69 L23.23,8.5 A2.5,2.5 0 0 1 25.73,6" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="23.23" x2="156.0025" y1="28.2969" y2="28.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="119.7725" x="27.23" y="20.9951">Prototipo SRTP</text></g><!--entity Gateway REST--><g class="entity" data-entity="Gateway REST" data-source-line="2" data-uid="ent0003" id="entity_Gateway REST"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142.3066" x="70.08" y="41"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="192.3866" y="46"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="190.3866" y="48"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="190.3866" y="52"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102.3066" x="85.08" y="73.9951">Gateway REST</text></g><!--entity Service RTP--><g class="entity" data-entity="Service RTP" data-source-line="2" data-uid="ent0004" id="entity_Service RTP"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.9131" x="110.77" y="148.3"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="213.6831" y="153.3"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="211.6831" y="155.3"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="211.6831" y="159.3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.9131" x="125.77" y="181.2951">Service RTP</text></g><!--entity Base de Datos SQLite--><g class="entity" data-entity="Base de Datos SQLite" data-source-line="3" data-uid="ent0006" id="entity_Base de Datos SQLite"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="191.3477" x="76.56" y="271.6"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="247.9077" y="276.6"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="245.9077" y="278.6"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="245.9077" y="282.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.3477" x="91.56" y="304.5951">Base de Datos SQLite</text></g><!--entity Notification Hub--><g class="entity" data-entity="Notification Hub" data-source-line="4" data-uid="ent0008" id="entity_Notification Hub"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153.0664" x="302.7" y="271.6"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="435.7664" y="276.6"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="433.7664" y="278.6"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="433.7664" y="282.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.0664" x="317.7" y="304.5951">Notification Hub</text></g><!--entity Actores--><g class="entity" data-entity="Actores" data-source-line="4" data-uid="ent0009" id="entity_Actores"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92.9922" x="312.73" y="394.89"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="385.7222" y="399.89"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="383.7222" y="401.89"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="383.7222" y="405.89"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.9922" x="327.73" y="427.8851">Actores</text></g><g class="entity" data-entity="GMN14" data-source-line="12" data-uid="ent0015" id="entity_GMN14"><path d="M490.91,282.18 L490.91,307.3128 L767.5555,307.3128 L767.5555,292.18 L757.5555,282.18 L490.91,282.18" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M757.5555,282.18 L757.5555,292.18 L767.5555,292.18 L757.5555,282.18" fill="#FEFFDD" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.6455" x="496.91" y="299.2469">Gestionada con SQLAlchemy y Alembic</text></g><g class="entity" data-entity="GMN17" data-source-line="16" data-uid="ent0018" id="entity_GMN17"><path d="M488.39,397.91 L488.39,414.04 L406.1,418.04 L488.39,422.04 L488.39,438.1756 A0,0 0 0 0 488.39,438.1756 L696.0619,438.1756 A0,0 0 0 0 696.0619,438.1756 L696.0619,407.91 L686.0619,397.91 L488.39,397.91 A0,0 0 0 0 488.39,397.91" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M686.0619,397.91 L686.0619,407.91 L696.0619,407.91 L686.0619,397.91" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.6719" x="494.39" y="414.9769">Beneficiary, PSP Beneficiary,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.0112" x="494.39" y="430.1097">PSP Payer, Payer</text></g><!--link Gateway REST to Service RTP--><g class="link" data-entity-1="Gateway REST" data-entity-2="Service RTP" data-source-line="2" data-uid="lnk5" id="link_Gateway REST_Service RTP"><path d="M147.88,87.74 C153.11,105.51 158.6651,124.3844 163.8951,142.1444" fill="none" id="Gateway REST-to-Service RTP" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="165.59,147.9,166.8847,138.1366,164.1776,143.1036,159.2105,140.3965,165.59,147.9" style="stroke:#181818;stroke-width:1;"/></g><!--link Service RTP to Base de Datos SQLite--><g class="link" data-entity-1="Service RTP" data-entity-2="Base de Datos SQLite" data-source-line="3" data-uid="lnk7" id="link_Service RTP_Base de Datos SQLite"><path d="M172.23,194.98 C172.23,216.77 172.23,243.59 172.23,265.33" fill="none" id="Service RTP-to-Base de Datos SQLite" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="172.23,271.33,176.23,262.33,172.23,266.33,168.23,262.33,172.23,271.33" style="stroke:#181818;stroke-width:1;"/></g><!--link Notification Hub to Actores--><g class="link" data-entity-1="Notification Hub" data-entity-2="Actores" data-source-line="4" data-uid="lnk10" id="link_Notification Hub_Actores"><path d="M359.8,318.36 C353.56,327.02 347.44,337.36 344.23,347.89 C339.54,363.29 341.4958,375.4036 346.5558,389.0636" fill="none" id="Notification Hub-to-Actores" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="348.64,394.69,349.2647,384.861,346.9032,390.0013,341.7628,387.6398,348.64,394.69" style="stroke:#181818;stroke-width:1;"/></g><!--link Notification Hub to Actores--><g class="link" data-entity-1="Notification Hub" data-entity-2="Actores" data-source-line="8" data-uid="lnk12" id="link_Notification Hub_Actores"><path d="M374.7046,323.2131 C371.1046,344.9931 367.3224,367.9564 363.7424,389.6964" fill="none" id="Notification Hub-Actores" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;"/><rect fill="#FFFFFF" height="10" style="stroke:#181818;stroke-width:1.5;" width="10" x="370.52" y="313.28"/><rect fill="#FFFFFF" height="10" style="stroke:#181818;stroke-width:1.5;" width="10" x="357.93" y="389.63"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73.0806" x="371.23" y="360.9569">WebSocket</text></g><!--link Gateway REST to Actores--><g class="link" data-entity-1="Gateway REST" data-entity-2="Actores" data-source-line="7" data-uid="lnk11" id="link_Gateway REST_Actores"><path d="M118.5152,91.3627 C80.0752,138.1327 6,244.24 59.23,317.89 C117.47,398.47 238.6235,414.4624 307.3335,417.0424" fill="none" id="Gateway REST-Actores" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;"/><rect fill="#FFFFFF" height="10" style="stroke:#181818;stroke-width:1.5;" width="10" x="116.69" y="82.5"/><rect fill="#FFFFFF" height="10" style="stroke:#181818;stroke-width:1.5;" width="10" x="307.33" y="412.23"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.3159" x="47.23" y="237.6669">HTTP/REST</text></g><!--link Service RTP to Notification Hub--><g class="link" data-entity-1="Service RTP" data-entity-2="Notification Hub" data-source-line="9" data-uid="lnk13" id="link_Service RTP_Notification Hub"><path d="M210.68,194.98 C247.74,216.7 298.3432,246.3467 335.4632,268.0967" fill="none" id="Service RTP-to-Notification Hub" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="340.64,271.13,334.897,263.1289,336.326,268.6023,330.8526,270.0313,340.64,271.13" style="stroke:#181818;stroke-width:1;"/></g><!--link Base de Datos SQLite to GMN14--><g class="link" data-entity-1="Base de Datos SQLite" data-entity-2="GMN14" data-source-line="12" data-uid="lnk16" id="link_Base de Datos SQLite_GMN14"><path d="M210.29,271.25 C235.49,257.12 269.85,240.47 302.73,233.1 C368.65,218.31 388.15,221.68 454.73,233.1 C508.72,242.35 568.2,266.63 601.91,281.81" fill="none" id="Base de Datos SQLite-GMN14" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;"/></g><!--SRC=[TOzDRy8m38Rl-HMlu0hiliEaearmcAQCLDe1zU2cBaIK1gNUfcZQVr-w8lO1dABuVVpOFf3TqOOnqi6B5tVmCAjSZ_2XWFM2XDyfOlLWyWBJwHtMXiERium45Jto-pyGS-eO5UEUn7SmpuzE-1jzIlxQMHBdMonVooEVMV61kq9zAlLludWs6_y0kCKop_LDdwaBjZFwXKlZxOv5NLZph5-frWiZkCrMuElhXoouwvke8jZKcuAiiLlUHqHa3UzBPnMt5NhTKTfmFJXFnm9pRZaju2Z42RJHVmefxqkQ8eV9y9oSNm00]--></g></svg>

# END FILE CONTENTS


# File: MemoriaTFG/main.toc

\boolfalse {citerequest}\boolfalse {citetracker}\boolfalse {pagetracker}\boolfalse {backtracker}\relax 
\babel@toc {english}{}
\babel@toc {spanish}{}
\contentsline {section}{Agradecimientos}{2}{section*.1}%
\contentsline {section}{Resumen}{4}{section*.3}%
\babel@toc {spanish}{}
\babel@toc {english}{}
\contentsline {section}{Lista de acrónimos}{11}{chapter*.8}%
\babel@toc {spanish}{}
\contentsline {chapter}{\numberline {1}Introducción}{1}{chapter.1}%
\contentsline {section}{\numberline {1.1}Motivación}{1}{section.1.1}%
\contentsline {subsection}{\numberline {1.1.1}Ineficiencias operativas detectadas}{2}{subsection.1.1.1}%
\contentsline {paragraph}{En conclusión.}{4}{section*.9}%
\contentsline {subsection}{\numberline {1.1.2}Oportunidad de un esquema RTP}{4}{subsection.1.1.2}%
\contentsline {section}{\numberline {1.2}Objetivos fundamentales}{5}{section.1.2}%
\contentsline {section}{\numberline {1.3}Fases y Métodos}{6}{section.1.3}%
\contentsline {chapter}{\numberline {2}Antecedentes y estado del arte}{7}{chapter.2}%
\contentsline {section}{\numberline {2.1}Evolución de los medios de pago hacia SEPA}{7}{section.2.1}%
\contentsline {section}{\numberline {2.2}El papel del EPC en la estandarización y el surgimiento de Request-to-Pay}{8}{section.2.2}%
\contentsline {section}{\numberline {2.3}Funcionamiento técnico de SEPA Request-to-Pay (SRTP)}{8}{section.2.3}%
\contentsline {paragraph}{Modelo de cuatro esquinas.}{8}{section*.10}%
\contentsline {paragraph}{Casos de uso representativos.}{14}{section*.11}%
\contentsline {section}{\numberline {2.4}RTP dentro del ecosistema de pagos: arquitectura en capas}{17}{section.2.4}%
\contentsline {chapter}{\numberline {3}Diseño}{23}{chapter.3}%
\contentsline {section}{\numberline {3.1}Objetivos técnicos}{23}{section.3.1}%
\contentsline {section}{\numberline {3.2}Actores y alcance}{25}{section.3.2}%
\contentsline {paragraph}{Alcance de la emulación.}{26}{section*.13}%
\contentsline {section}{\numberline {3.3}Requisitos}{27}{section.3.3}%
\contentsline {subsection}{\numberline {3.3.1}Requisitos funcionales (RF)}{27}{subsection.3.3.1}%
\contentsline {subsection}{\numberline {3.3.2}Requisitos no funcionales (RNF)}{28}{subsection.3.3.2}%
\contentsline {section}{\numberline {3.4}Casos de uso}{28}{section.3.4}%
\contentsline {subsection}{\numberline {3.4.1}CU-01 Crear solicitud RTP}{28}{subsection.3.4.1}%
\contentsline {subsection}{\numberline {3.4.2}CU-02: Decidir solicitud RTP}{29}{subsection.3.4.2}%
\contentsline {section}{\numberline {3.5}Modelo de datos}{29}{section.3.5}%
\contentsline {section}{\numberline {3.6}Arquitectura lógica}{33}{section.3.6}%
\contentsline {subsection}{\numberline {3.6.1}Componentes principales}{33}{subsection.3.6.1}%
\contentsline {subsection}{\numberline {3.6.2}Flujo de interacción lógico}{34}{subsection.3.6.2}%
\contentsline {section}{\numberline {3.7}Emulación del flujo RTP}{34}{section.3.7}%
\contentsline {subsection}{\numberline {3.7.1}Máquina de estados del objeto RTP}{35}{subsection.3.7.1}%
\contentsline {subsection}{\numberline {3.7.2}Transiciones y reglas de negocio}{35}{subsection.3.7.2}%
\contentsline {subsection}{\numberline {3.7.3}Condiciones excepcionales y \emph {timeouts}}{36}{subsection.3.7.3}%
\contentsline {chapter}{\numberline {4}Implementación}{37}{chapter.4}%
\contentsline {section}{\numberline {4.1}Visión general de la arquitectura y organización del código}{37}{section.4.1}%
\contentsline {subsection}{\numberline {4.1.1}Componentes del servidor}{37}{subsection.4.1.1}%
\contentsline {paragraph}{Cliente}{38}{section*.14}%
\contentsline {paragraph}{Interacción entre componentes}{38}{section*.15}%
\contentsline {subsection}{\numberline {4.1.2}Estructura de directorios}{38}{subsection.4.1.2}%
\contentsline {subsection}{\numberline {4.1.3}Satisfacción de requisitos}{40}{subsection.4.1.3}%
\contentsline {section}{\numberline {4.2}Persistencia y modelos ORM}{43}{section.4.2}%
\contentsline {section}{\numberline {4.3}Servicios de dominio}{45}{section.4.3}%
\contentsline {section}{\numberline {4.4}API REST y WebSocket}{46}{section.4.4}%
\contentsline {section}{\numberline {4.5}Blueprints y su propósito}{46}{section.4.5}%
\contentsline {section}{\numberline {4.6}Endpoints REST}{46}{section.4.6}%
\contentsline {section}{\numberline {4.7}Frontend y notificaciones}{47}{section.4.7}%
\contentsline {section}{\numberline {4.8}Despliegue y configuración}{49}{section.4.8}%
\contentsline {subsection}{\numberline {4.8.1}Ejecución del sistema}{50}{subsection.4.8.1}%
\contentsline {subsection}{\numberline {4.8.2}Conclusión}{50}{subsection.4.8.2}%
\contentsline {chapter}{\numberline {5}Validacion}{51}{chapter.5}%
\contentsline {section}{\numberline {5.1}Entorno de pruebas}{51}{section.5.1}%
\contentsline {section}{\numberline {5.2}Metodología}{51}{section.5.2}%
\contentsline {section}{\numberline {5.3}Flujo \textit {happy path}}{52}{section.5.3}%
\contentsline {section}{\numberline {5.4}Escenarios de error}{52}{section.5.4}%
\contentsline {section}{\numberline {5.5}Conclusiones}{53}{section.5.5}%
\contentsline {chapter}{\numberline {6}Conclusiones}{61}{chapter.6}%
\contentsline {chapter}{\numberline {7}Líneas futuras}{63}{chapter.7}%
\contentsline {section}{Índice de Figuras}{77}{chapter*.28}%
\contentsline {section}{Índice de Tablas}{79}{chapter*.29}%
\contentsline {section}{Índice de Listados}{81}{chapter*.30}%


# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/ER.svg

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="CLASS" height="670px" preserveAspectRatio="none" style="width:240px;height:670px;background:#FFFFFF;" version="1.1" viewBox="0 0 240 670" width="240px" zoomAndPan="magnify"><defs/><g><!--class Actor--><g class="entity" data-entity="Actor" data-source-line="1" data-uid="ent0002" id="entity_Actor"><rect fill="#F1F1F1" height="194.6719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="173.3965" x="33.47" y="7"/><ellipse cx="97.3758" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M101.4851,29 L93.7664,29 L93.7664,16.6094 L101.4851,16.6094 L101.4851,18.7656 L96.2195,18.7656 L96.2195,21.4375 L100.9851,21.4375 L100.9851,23.5938 L96.2195,23.5938 L96.2195,26.8438 L101.4851,26.8438 L101.4851,29 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.085" x="117.8758" y="27.8467">Actor</text><line style="stroke:#181818;stroke-width:0.5;" x1="34.47" x2="205.8665" y1="39" y2="39"/><ellipse cx="44.47" cy="52.6484" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.7188" x="53.47" y="55.9951">id : integer &#171;PK&#187;</text><ellipse cx="44.47" cy="68.9453" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.0449" x="53.47" y="72.292">username : string</text><ellipse cx="44.47" cy="85.2422" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120.5176" x="53.47" y="88.5889">password : string</text><ellipse cx="44.47" cy="101.5391" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.5088" x="53.47" y="104.8857">name : string</text><ellipse cx="44.47" cy="117.8359" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.6299" x="53.47" y="121.1826">role : string</text><ellipse cx="44.47" cy="134.1328" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119.7041" x="53.47" y="137.4795">photo_url : string</text><ellipse cx="44.47" cy="150.4297" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.0342" x="53.47" y="153.7764">iban : string</text><ellipse cx="44.47" cy="166.7266" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.1875" x="53.47" y="170.0732">balance : float</text><ellipse cx="44.47" cy="183.0234" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147.3965" x="53.47" y="186.3701">psp_id : integer &#171;FK&#187;</text><line style="stroke:#181818;stroke-width:0.5;" x1="34.47" x2="205.8665" y1="193.6719" y2="193.6719"/></g><!--class RTP--><g class="entity" data-entity="RTP" data-source-line="13" data-uid="ent0003" id="entity_RTP"><rect fill="#F1F1F1" height="178.375" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="226.3408" x="7" y="278.67"/><ellipse cx="102.5596" cy="294.67" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M106.6689,300.67 L98.9502,300.67 L98.9502,288.2794 L106.6689,288.2794 L106.6689,290.4356 L101.4033,290.4356 L101.4033,293.1075 L106.1689,293.1075 L106.1689,295.2637 L101.4033,295.2637 L101.4033,298.5137 L106.6689,298.5137 L106.6689,300.67 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.7217" x="123.0596" y="299.5167">RTP</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="232.3408" y1="310.67" y2="310.67"/><ellipse cx="18" cy="324.3184" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.7188" x="27" y="327.6651">id : integer &#171;PK&#187;</text><ellipse cx="18" cy="340.6153" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.0342" x="27" y="343.962">iban : string</text><ellipse cx="18" cy="356.9122" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.0869" x="27" y="360.2589">amount : float</text><ellipse cx="18" cy="373.2091" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.8242" x="27" y="376.5557">status : string</text><ellipse cx="18" cy="389.5059" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152.332" x="27" y="392.8526">timestamp : datetime</text><ellipse cx="18" cy="405.8028" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="200.3408" x="27" y="409.1495">beneficiary_id : integer &#171;FK&#187;</text><ellipse cx="18" cy="422.0997" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="162.4492" x="27" y="425.4464">payer_id : integer &#171;FK&#187;</text><ellipse cx="18" cy="438.3966" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109.6279" x="27" y="441.7432">concept : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="232.3408" y1="449.045" y2="449.045"/></g><!--class Log--><g class="entity" data-entity="Log" data-source-line="24" data-uid="ent0004" id="entity_Log"><rect fill="#F1F1F1" height="129.4844" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="178.332" x="31" y="534.05"/><ellipse cx="103.29" cy="550.05" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M107.3994,556.05 L99.6807,556.05 L99.6807,543.6594 L107.3994,543.6594 L107.3994,545.8156 L102.1338,545.8156 L102.1338,548.4875 L106.8994,548.4875 L106.8994,550.6438 L102.1338,550.6438 L102.1338,553.8938 L107.3994,553.8938 L107.3994,556.05 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.252" x="123.79" y="554.8967">Log</text><line style="stroke:#181818;stroke-width:0.5;" x1="32" x2="208.332" y1="566.05" y2="566.05"/><ellipse cx="42" cy="579.6984" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115.7188" x="51" y="583.0451">id : integer &#171;PK&#187;</text><ellipse cx="42" cy="595.9953" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.4609" x="51" y="599.342">rtp_id : integer &#171;FK&#187;</text><ellipse cx="42" cy="612.2922" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.166" x="51" y="615.6389">old_status : string</text><ellipse cx="42" cy="628.5891" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.7607" x="51" y="631.9357">new_status : string</text><ellipse cx="42" cy="644.8859" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152.332" x="51" y="648.2326">timestamp : datetime</text><line style="stroke:#181818;stroke-width:0.5;" x1="32" x2="208.332" y1="655.5344" y2="655.5344"/></g><!--link Actor to RTP--><g class="link" data-entity-1="Actor" data-entity-2="RTP" data-source-line="32" data-uid="lnk5" id="link_Actor_RTP"><path codeLine="32" d="M50.5283,209.4607 C45.9883,224.7907 46.95,233.07 51.17,248.67 C53.87,258.65 50.203,252.2582 54.613,261.9782" fill="none" id="Actor-RTP" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="47.8288" x2="55.4995" y1="204.4895" y2="206.7612"/><line style="stroke:#181818;stroke-width:1;" x1="46.9769" x2="54.6476" y1="207.366" y2="209.6377"/><line style="stroke:#181818;stroke-width:1;" x1="50.5283" x2="52.8" y1="209.4607" y2="201.79"/><line style="stroke:#181818;stroke-width:1;" x1="58.7447" x2="67.5139" y1="271.0848" y2="275.891"/><line style="stroke:#181818;stroke-width:1;" x1="58.7447" x2="56.5861" y1="271.0848" y2="280.849"/><line style="stroke:#181818;stroke-width:1;" x1="58.7447" x2="62.05" y1="271.0848" y2="278.37"/><ellipse cx="56.2657" cy="265.6208" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.8032" x="52.17" y="244.7369">beneficiary_id</text></g><!--link Actor to RTP--><g class="link" data-entity-1="Actor" data-entity-2="RTP" data-source-line="33" data-uid="lnk6" id="link_Actor_RTP"><path codeLine="33" d="M147.3366,209.7402 C149.2566,225.3502 148.89,233.45 147.17,248.67 C146.07,258.4 147.7715,250.7935 145.9115,260.7935" fill="none" id="Actor-RTP-1" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="142.8782" x2="150.8184" y1="206.2584" y2="205.2818"/><line style="stroke:#181818;stroke-width:1;" x1="143.2445" x2="151.1846" y1="209.236" y2="208.2593"/><line style="stroke:#181818;stroke-width:1;" x1="147.3366" x2="146.36" y1="209.7402" y2="201.8"/><line style="stroke:#181818;stroke-width:1;" x1="144.0829" x2="148.5188" y1="270.6249" y2="279.5872"/><line style="stroke:#181818;stroke-width:1;" x1="144.0829" x2="136.7212" y1="270.6249" y2="277.3928"/><line style="stroke:#181818;stroke-width:1;" x1="144.0829" x2="142.62" y1="270.6249" y2="278.49"/><ellipse cx="145.1801" cy="264.7261" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.6182" x="148.17" y="244.7369">payer_id</text></g><!--link RTP to Log--><g class="link" data-entity-1="RTP" data-entity-2="Log" data-source-line="34" data-uid="lnk7" id="link_RTP_Log"><path codeLine="34" d="M120.17,465.37 C120.17,490.78 120.17,492 120.17,515.64" fill="none" id="RTP-Log" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="116.17" x2="124.17" y1="461.37" y2="461.37"/><line style="stroke:#181818;stroke-width:1;" x1="116.17" x2="124.17" y1="464.37" y2="464.37"/><line style="stroke:#181818;stroke-width:1;" x1="120.17" x2="120.17" y1="465.37" y2="457.37"/><line style="stroke:#181818;stroke-width:1;" x1="120.17" x2="126.17" y1="525.64" y2="533.64"/><line style="stroke:#181818;stroke-width:1;" x1="120.17" x2="114.17" y1="525.64" y2="533.64"/><line style="stroke:#181818;stroke-width:1;" x1="120.17" x2="120.17" y1="525.64" y2="533.64"/><ellipse cx="120.17" cy="519.64" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37.0576" x="121.17" y="500.1169">rtp_id</text></g><!--SRC=[ZPB1QiCm38RlUGgV1ts1K0gxxB8TojWzg8cQ6Hp9o0ebj7ltsN57SPhI7VNhb_L_maXgTJAlhRAOSsNCYx6TgOqbnHx5RBVxzzrkriU0GZ1Wx0OLI_siUWZXnDALwhrFs2qdlrcv6SMLiZq0bSe1752Rfe-EGVDmyCqYw5iA-bDLc94-l_PFWEutmS0ZQR4eAEWOIflQ0QC- -2Xte9Zgd1G9ZxQr8DDgkdom2ULXj-L8wlMsxmRqmVqJ857_y65sNRF6GdXg_iqOm-IVShbiDdoURrmlgDSSVynLAg-TX5DV8_y2]--></g></svg>

# END FILE CONTENTS


# File: MemoriaTFG/src/estado_arte.tex

%----------------------------------------------------------------------
% Antecedentes y estado del arte
%----------------------------------------------------------------------

\chapter{Antecedentes y estado del arte}
\label{sec:estado-arte}

\section{Evolución de los medios de pago hacia SEPA}
\label{subsec:evolucion-sepa}


El ecosistema europeo de pagos ha experimentado una transformación en las últimas décadas, pasando de sistemas nacionales heterogéneos a un marco unificado bajo la iniciativa \textbf{SEPA}. Antes de SEPA, cada país operaba infraestructuras y normas propias para transferencias bancarias y adeudos, lo que complicaba los pagos transfronterizos dentro de Europa.  
Con la introducción del euro y el objetivo de un mercado único, surgió la necesidad de armonizar los instrumentos de pago. El Consejo Europeo impulsó la creación de SEPA a través del Reglamento UE~\num{260}/\num{2012} \cite{eu_260_2012}, que fijó la migración obligatoria a los nuevos esquemas paneuropeos de transferencia y adeudo en fechas límite (febrero de 2014 para la zona euro).  
\vspace{0.5cm}

Así, en \textit{2008} se lanzó el esquema \textit{\textbf{SEPA Credit Transfer} (\textbf{SCT})} \cite{epc125_2023} para transferencias de crédito en euros, y en \textit{2009} el \textbf{SDD} para adeudos domiciliados. Estos esquemas sustituyeron progresivamente a los medios nacionales, unificando formatos (por ejemplo, el uso obligatorio de \emph{IBAN} \cite{EU_IBAN_2001}) y reglas de funcionamiento en todos los países SEPA. Posteriormente, para atender las demandas de inmediatez, la transferencia instantánea \textit{\textbf{SCT~Inst}} entró en funcionamiento en \textit{2017}, permitiendo abonar al beneficiario en menos de \SI{10}{\second}. La implantación de \textit{SCT~Inst} ha sido voluntaria hasta ahora, aunque recientemente la UE ha aprobado su obligatoriedad progresiva en 2025 para acelerar su adopción. \cite{EBA_RT1}.
\vspace{0.5cm}

En la actualidad, los esquemas SEPA (transferencias estándar e inmediatas, adeudos básicos y B2B) concentran la mayoría de pagos bancarios en euros dentro de Europa. Este salto hacia la unificación de pagos fue liderado por la propia industria bancaria europea. En \textit{2002} los bancos constituyeron el \textit{\textbf{European Payments Council} (EPC)}, órgano de autorregulación que diseña y gestiona los esquemas SEPA. El EPC publicó las primeras \emph{rulebooks} de SCT y SDD en 2008–2009, estableciendo estándares comunes de mensaje \emph{ISO~20022} y calendarios de liquidación. Cabe destacar que el EPC no es un organismo legislativo de la UE ni un regulador, sino una asociación del sector bancario que actúa de facto como ente normalizador: especifica las reglas de los esquemas utilizados por los \textbf{PSP} y coopera con los bancos centrales para operar las infraestructuras de compensación. Gracias a esta colaboración público-privada, a partir de \textit{2014} se completó con éxito la migración de millones de pagos nacionales al formato SEPA, eliminando diferencias entre pagos domésticos y transfronterizos en euros.

\section{El papel del EPC en la estandarización y el surgimiento de Request-to-Pay}
\label{subsec:epc-rtp}

El EPC ha desempeñado un rol central en la estandarización de los instrumentos de pago SEPA. Tras la implementación de SCT y SDD, el EPC continuó explorando mejoras para la era digital, en línea con las iniciativas del Eurosistema para fomentar pagos electrónicos paneuropeos más eficientes. En noviembre de 2018, el \emph{Euro Retail Payments Board} (\textbf{ERPB}) (órgano del BCE que orienta la estrategia de pagos minoristas \cite{ECB_ERPB}) lanzó un llamado a la acción para desarrollar el concepto de \emph{Request to Pay} como nuevo servicio en la zona SEPA.  

Atendiendo esta petición, el EPC creó un grupo de trabajo y comenzó a diseñar un esquema formal de Request to Pay durante 2019–2020. Tras una consulta pública, en noviembre de 2020 se publicó el primer \emph{SRTP Scheme Rulebook} (versión 1.0) y se abrió el registro de participantes. El esquema SRTP entró en vigor el \textit{15 de junio de 2021}, marcando un hito en la evolución de SEPA más allá de los instrumentos tradicionales. Al igual que SCT~Inst, la adhesión al esquema RTP es voluntaria; sin embargo, su desarrollo cuenta con fuerte apoyo institucional al considerarse un potenciador de los pagos instantáneos y digitales en Europa. El EPC continúa gestionando y actualizando el esquema (versión 4.0 en 2025), con la expectativa de que Request-to-Pay se integre gradualmente como componente clave del panorama de pagos europeos.

\section{Funcionamiento técnico de SEPA Request-to-Pay (SRTP)}
\label{subsec:funcionamiento-srtp}

\textbf{RTP} es un servicio de mensajería financiera que actúa como capa de solicitud previa al pago. A diferencia de los instrumentos tradicionales (transferencias o adeudos) que mueven fondos, RTP no mueve dinero por sí mismo: permite a un beneficiario (\emph{Payee}) enviar electrónicamente una solicitud de pago a un pagador (\emph{Payer}), quien puede aceptarla o rechazarla antes de iniciarse la transacción monetaria. El servicio funciona \emph{24 × 7} y añade al flujo de pago un intercambio estructurado de datos (importe, concepto, vencimiento, identidad de las partes, etc.) previo al envío de fondos.  

Los mensajes SRTP viajan en tiempo real formateados según ISO~20022, lo que facilita su integración con las plataformas SEPA existentes.

\paragraph{Modelo de cuatro esquinas.} SRTP adopta la clásica arquitectura \emph{4-corner model} \cite{fourcorner_wiki} de la figura \ref{fig:4corner} presente en el \textit{rulebook} \cite{ecp014}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/4CornerModel.pdf}
  \caption{Modelo de 4 esquinas}
  \label{fig:4corner}
\end{figure}


\begin{table}[htbp]
  \centering
  \renewcommand{\arraystretch}{1.2} % aumenta un poco la altura de las filas
  \caption{Pasos del flujo del esquema SEPA Request-to-Pay (SRTP) y su descripción}
  \label{tab:srtp-steps-a}
  \begin{tabularx}{\textwidth}{@{} >{\bfseries}l  X @{}}
    \toprule
    Paso  & Descripción \\
    \midrule
    1.\ Identificación
      & Una primera interacción que establece la comunicación entre pagador y beneficiario. \\
    2.\ Envío de la SRTP al PSP del beneficiario
      & El beneficiario envía la solicitud de pago SRTP a su PSP, incluyendo todos los datos esenciales del esquema (importe, concepto, vencimiento…). \\
    3.\ Transmisión al PSP del pagador
      & El PSP del beneficiario reenvía la SRTP al PSP del pagador. \\
    4.\ Presentación al pagador
      & La solicitud se muestra al pagador en el canal acordado (app móvil, web, etc.), permitiendo que revise los detalles. \\
    5.\ Informe de estado
      & El resultado (aceptación o rechazo) se comunica de vuelta al beneficiario mediante los PSP correspondientes. \\
    \bottomrule
  \end{tabularx}
\end{table}

La \textit{Operational Scheme Manager (OSM)} es el elemento central que mantiene vivo y accesible a todo el ecosistema SRTP. Es un gran directorio seguro y siempre actualizado, gestionado por el EPC, donde quedan registrados todos los PSP y demás actores autorizados: sus identificadores, los certificados TLS que usan para cifrar las comunicaciones, las claves de firma y las URLs de sus endpoints(puntos finales de API donde se reciben y se envían RTP). Gracias a la OSM, cada PSP puede, en cualquier momento, localizar de forma sencilla y confiable a otro PSP: comprueba automáticamente que el receptor está homologado, que su endpoint está operativo, y que la conexión será segura antes de intercambiar solicitudes o respuestas de pago. \cite{epc098_2021}.

Su misión va más allá de un simple directorio estático: la OSM supervisa y valida de forma continua la disponibilidad y el correcto funcionamiento de todos los endpoints adheridos, publica esta información en el \textit{EPC Directory Service (EDS)} y notifica de inmediato cualquier incidencia. De este modo, se garantiza que las transacciones RTP fluyan sin interrupciones, con altos estándares de seguridad y cumplimiento de ISO 20022, y que todos los participantes puedan interoperar con total confianza.

En este TFG no se va a simular ni modelar este registro previo en la OSM, asumiremos que todos los actores se encuentran correctamente dados de alta en el directorio. Así, podremos centrarnos exclusivamente en las dinámicas de la solicitud, aceptación, rechazo yu cancelación de pagos, dando por hecho que el acceso a los endpoints y la homologación técnica ya están resueltos.

El flujo básico de un intercambio RTP se encuentra en la figura \ref{fig:Flujo}.
\newpage

\begin{figure}[H]
  \centering
  \includegraphics[width=0.95\textwidth, height=0.95\textheight, keepaspectratio]{Imagenes/Flujo.png}
  \caption{Diagrama de flujo de intercambio RTP}
  \label{fig:Flujo}
\end{figure}

\newcolumntype{L}[1]{%
  >{\setlength\parindent{1em}% sangría primera línea
    \raggedright\arraybackslash}%
  p{#1}%
}

\setlength{\tabcolsep}{10pt}
\renewcommand{\arraystretch}{1.5}
\begin{longtable}{|L{3cm}|p{12cm}|}
  \caption[Pasos del esquema SRTP]{Pasos del flujo del esquema SRTP y su descripción}
  \label{tab:srtp-steps-b} \\

  \hline
  \textbf{Paso/Función} & \textbf{Descripción} \\
  \hline
  \endfirsthead % Encabezado para la primera página

  \hline
  \textbf{Paso/Función} & \textbf{Descripción} \\
  \hline
  \endhead % Encabezado para las páginas siguientes

  \hline
  \multicolumn{2}{|c|}{\textit{(continúa en la siguiente página)}} \\
  \hline
  \endfoot % Pie de página para todas las páginas excepto la última

  \hline
  \multicolumn{2}{|c|}{\textit{Fin de la tabla}} \\
  \hline
  \endlastfoot % Pie de página para la última página

  % Contenido de la tabla
  1 Crear y enviar RTP & El beneficiario crea el SRTP en el formato normalizado (en un formato acordado bilateralmente con su proveedor). Contiene todos los elementos obligatorios y elementos opcionales que puedan ajustarse al flujo en función de las condiciones comerciales. El beneficiario lo envía al proveedor de servicios SRTP del beneficiario. \\
  \hline
  2 Validar RTP & El proveedor de servicios SRTP del beneficiario realiza una primera validación del SRTP. Esto incluye, por ejemplo, validación técnica, de seguridad y de formato (por ejemplo, comprobación del IBAN). \\
  \hline
  2B Rechazo & Si la validación en el paso 2 no tiene éxito, el proveedor de servicios SRTP del beneficiario notifica al beneficiario el rechazo del SRTP, crea un informe de estado negativo y lo envía al beneficiario en el formato acordado con este. \\
  \hline
  3 Completar y enviar RTP & En caso de validación correcta en el paso 2, el proveedor de servicios SRTP del beneficiario enriquece el SRTP con los elementos necesarios para el enrutamiento en el espacio entre proveedores de servicios SRTP y añade un sello de tiempo. \\
  \hline
  4 Enrutar RTP & El SRTP se envía al proveedor de servicios SRTP del pagador en función de los mecanismos de enrutamiento establecidos por el PSP. \\
  \hline
  5 Validar RTP & El proveedor de servicios SRTP del pagador valida el SRTP, incluye la comprobación del identificador del pagador. Esto puede incluir la validación específica del pagador (por ejemplo, si el pagador ha optado por no participar en el servicio, el SRTP es rechazado por defecto). \\
  \hline
  5B Rechazo & Si la validación en el paso 5 no tiene éxito, el proveedor de servicios SRTP del pagador rechaza el SRTP. El proveedor de servicios SRTP del beneficiario y el beneficiario son informados de este rechazo mediante un código de motivo de no aceptación del RTP. \\
  \hline
  5C Confirmación positiva funcional & Después de una validación externa en el paso 5, el proveedor de servicios SRTP confirma al pagador que el proveedor de servicios SRTP ha completado con éxito el procedimiento beneficial. Esta confirmación es obligatoria solo en el caso de que el beneficiario o el proveedor de servicios SRTP no haya confirmado previamente la positividad funcional. \\
  \hline
  6 Enviar RTP & En el caso de validación correcta en el paso 5, el proveedor de servicios SRTP envía el documento SRTP al pagador en el formato acordado (el SRTP puede ser convertido en este paso). \\
  \hline
  7 Evaluar RTP & El pagador decide si aceptar o rechazar el SRTP, determinando el próximo curso de acción. \\
  \hline
  7B Positivo & Si el pagador decide aceptar el SRTP, se envía una respuesta positiva al proveedor de servicios SRTP por parte del pagador. \\
  \hline
  7C Negativo & Si el pagador rechaza el SRTP, se envía una respuesta negativa al proveedor de servicios SRTP por parte del pagador. \\
  \hline
  8 Crear/modificar y mandar informe RTP & El proveedor de servicios SRTP crea un informe informativo basado en la decisión del pagador. Si la decisión es negativa (7B/7C), el informe se envía de vuelta al pagador para su revisión. Si el SRTP ya ha sido aceptado o rechazado, surge un caso excepcional donde no se espera un acuse de recibo. El informe debe considerar la fecha de expiración del SRTP. En este caso, el proveedor de servicios SRTP es responsable de notificar al beneficiario la decisión del proveedor de servicios SRTP, incluyendo el código correspondiente. Como resultado, el beneficiario debe representar el SRTP o utilizar otro canal. \\
  \hline
  9 Enviar informe de estado & El proveedor de servicios SRTP envía un informe de estado actualizado (positivo o negativo) al pagador a través del mismo canal utilizado para el SRTP original, utilizando mecanismos establecidos para la actualización. \\
  \hline
  10 Proceder y remitir informe & El proveedor de servicios SRTP del beneficiario procesa el informe de estado recibido (positivo o negativo), informa al beneficiario y decide los pasos siguientes previo acuerdo con el beneficiario. \\
  \hline
  11 Procesar informe de estado & El beneficiario ejecuta las acciones finales tras la recepción del informe de estado: actualización del estado final del registro SRTP, preparación del pago SRTP conciliación, etc. \\
  \hline
  12 Generar solicitud de actualización de estado & El beneficiario y el proveedor de servicios SRTP del beneficiario pueden enviar una Solicitud de Actualización de Estado si no se ha recibido respuesta hasta la Fecha/Hora de Expiración. \\
  \hline
  13 Enrutar la solicitud de actualización de estado & La solicitud de actualización de estado al proveedor de servicios SRTP del pagador se enruta a través de la misma vía utilizada para el SRTP original basándose en los mecanismos de enrutamiento establecidos. \\
  \hline
  14 Validar solicitud de actualización de estado & Tras la recepción de la solicitud de actualización de estado, el Proveedor de Servicios SRTP del pagador comprueba la validez de la Solicitud. \\
  \hline
  14B Respuesta a la solicitud de actualización de estado & El Proveedor de Servicios SRTP del pagador responde al proveedor de servicios SRTP del beneficiario y, si procede (a través del proveedor de servicios SRTP del beneficiario), al beneficiario (por ejemplo, respuesta del SRTP original no recibida, el pagador aún no ha respondido, etc.). \\
  \hline
  15 Enrutar la solicitud de actualización de estado & En caso de que el pagador aún no haya respondido al SRTP inicial, el proveedor de servicios SRTP del pagador puede enviar la solicitud de actualización de estado al Pagador. \\
  \hline
\end{longtable}

Hay algunos detalles acerca del esquema que conviene aclarar:
\begin{enumerate}
  \item \textbf{Rechazo de un SRTP o una solicitud de cancelación (reject)} \\
        Un \textit{reject} se produce cuando un SRTP o una Solicitud de Cancelación no es aceptada antes de ser enviada al siguiente participante en la cadena de pago. El mensaje de rechazo sigue la misma ruta que el SRTP original sin modificar ningún dato, y se incluye un registro con los detalles necesarios para asegurar un rastro de auditoría. Además, el mensaje de rechazo lleva un código de motivo que explica la razón del rechazo. La identificación del SRTP original se hace mediante la referencia única incluida por el proveedor de servicios del receptor. Los rechazos se envían de manera instantánea por el proveedor de servicios SRTP que no puede procesar la solicitud, y estos rechazos pueden ser generados automáticamente en función de comprobaciones técnicas o comerciales, sin intervención del pagador.

  \item \textbf{Respuestas a un SRTP (positiva o negativa)} \\
        Cuando un pagador responde a un SRTP, puede aceptar (respuesta positiva) o rechazarlo (respuesta negativa). En ambos casos, el mensaje sigue la misma ruta que el SRTP original, sin alterar los datos, y se envía instantáneamente entre los proveedores de servicios SRTP. Las respuestas negativas incluyen un código de motivo que especifica la razón del rechazo, mientras que las respuestas positivas simplemente confirman la aceptación de la solicitud. Como en el caso de los rechazos, se mantiene un registro detallado de los datos relevantes para asegurar la trazabilidad del proceso y la transparencia en la comunicación entre los proveedores de servicios.

  \item \textbf{Solicitud de cancelación del SRTP} \\
        Una “Request for cancelation” RfC puede ser iniciada por el y se transmite al pagador a través de los proveedores de servicios SRTP. La solicitud sigue la misma ruta que el SRTP original, sin modificar los datos, y debe incluir un código de motivo que justifique la cancelación. Esta solicitud puede realizarse hasta la fecha de expiración del SRTP, a menos que ya haya sido rechazado, cancelado o expirado. El proveedor de servicios SRTP del pagador verifica la validez de la solicitud antes de reenviarla, y si no se puede procesar, envía una respuesta negativa. Si la cancelación se ejecuta correctamente, el proveedor del pagador envía una respuesta positiva de manera instantánea, manteniendo siempre un registro para garantizar la trazabilidad del proceso.
\end{enumerate}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Casos de uso representativos.}
El \textbf{SRTP} se concibió como un servicio versátil, capaz de cubrir desde pagos cotidianos de bajo valor hasta cobros empresariales complejos. No obstante, el caso de uso considerado más transformador y sobre el que se centra este TFG es la sustitución del SDD. Aun así, existen otros escenarios relevantes que merece la pena describir para contextualizar el alcance potencial de SRTP.

\begin{enumerate}
    \item \textbf{Punto de venta físico}
    \begin{itemize}
        \item \textbf{Descripción:} este caso de uso de RTP se emplea en tiendas físicas, donde el beneficiario (el comercio) envía una solicitud de pago al pagador (el cliente) utilizando un código QR o una tecnología \textit{Near Field Communication(NFC)}. Al escanear el código QR con su móvil o usar NFC en la terminal de pago, el cliente es redirigido a su aplicación bancaria para autorizar el pago de manera inmediata.
        \item \textbf{Proceso de identificación:}
        \begin{itemize}
            \item \textit{Identificación del pagador:} el pagador se autentica directamente en su aplicación bancaria, generalmente mediante su número de cuenta bancaria, número de tarjeta, o métodos de autenticación biométrica o PIN, según lo permita la aplicación del banco.
            \item \textit{Identificación del beneficiario:} el beneficiario está identificado en el sistema mediante un ID de comercio asociado a la terminal de pago o al código QR/NFC escaneado por el cliente. Estos elementos proporcionan los datos necesarios para vincular la solicitud de pago al comercio correspondiente.
        \end{itemize}
        \item \textbf{Proceso de pago:}
        \begin{itemize}
            \item El cliente escanea el código QR o se conecta mediante NFC a la terminal de pago.
            \item La aplicación bancaria del cliente recibe la solicitud de pago con el monto y la referencia.
            \item El cliente revisa la información y autoriza el pago, un proceso rápido y conveniente, crucial en entornos físicos donde la velocidad es esencial.
        \end{itemize}
        \item \textbf{Diferencias frente a otros casos de uso:}
        \begin{itemize}
            \item La rapidez y conveniencia son fundamentales en este caso de uso. El proceso de identificación y autorización es sencillo y rápido, requiriendo solo la confirmación del cliente a través de su banco, típicamente con autenticación biométrica o PIN.
            \item Es ideal para transacciones de bajo valor donde la experiencia del cliente es un factor determinante.
        \end{itemize}
    \end{itemize}

    \item \textbf{Comercio electrónico (\textit{E-commerce})}
    \begin{itemize}
        \item \textbf{Descripción:} en este caso, el beneficiario (el comercio electrónico) envía una solicitud de pago al pagador (el cliente) durante el proceso de \textit{checkout} o mediante un enlace de pago enviado a través de una aplicación bancaria o correo electrónico. El cliente es redirigido a su aplicación bancaria, donde debe autenticarse y revisar los detalles antes de aprobar el pago.
        \item \textbf{Proceso de identificación:}
        \begin{itemize}
            \item \textit{Identificación del pagador:} la identificación implica un proceso de autenticación multifactor (por ejemplo, contraseña, \textit{token} de seguridad o autenticación biométrica) para garantizar la seguridad de la transacción, realizado en la aplicación bancaria o la página de pago del comercio.
            \item \textit{Identificación del beneficiario:} el beneficiario se identifica mediante un ID de comercio electrónico que incluye su nombre comercial, identificador fiscal, número de cuenta o un identificador único en la plataforma de pagos.
        \end{itemize}
        \item \textbf{Proceso de pago:}
        \begin{itemize}
            \item El cliente recibe la solicitud de pago a través de un enlace en el checkout o en su aplicación bancaria.
            \item El cliente se autentica en su aplicación bancaria, revisa el monto, la referencia y los detalles del comerciante, y aprueba el pago.
            \item Una vez validada, el dinero se transfiere de manera segura.
        \end{itemize}
        \item \textbf{Diferencias frente a otros casos de uso:}
        \begin{itemize}
            \item A diferencia del punto de venta físico, el proceso en comercio electrónico es más lento debido a la autenticación adicional y la revisión en línea.
            \item La seguridad es prioritaria, dado el mayor riesgo de fraude en transacciones digitales.
        \end{itemize}
    \end{itemize}

    \item \textbf{Facturación electrónica (\textit{E-invoicing})}
    \begin{itemize}
        \item \textbf{Descripción:} común en empresas que envían facturas electrónicas, el beneficiario (la empresa emisora) envía una solicitud de pago con los detalles de la factura al pagador (el cliente). El cliente recibe la solicitud en su correo electrónico o aplicación bancaria, pudiendo revisar los detalles antes de decidir cuándo pagar.
        \item \textbf{Proceso de identificación:}
        \begin{itemize}
            \item \textit{Identificación del pagador:} el pagador se identifica mediante su número de cliente, correo electrónico o número de cuenta bancaria vinculado a la empresa emisora.
            \item \textit{Identificación del beneficiario:} el beneficiario se identifica por su NIF (Número de Identificación Fiscal) o un ID de facturación electrónica único, asegurando la verificación de la entidad receptora.
        \end{itemize}
        \item \textbf{Proceso de pago:}
        \begin{itemize}
            \item El cliente recibe la factura y la solicitud de pago por correo o notificación bancaria.
            \item Tras validar la información, autoriza el pago a través de su aplicación bancaria, completando la transacción.
        \end{itemize}
        \item \textbf{Diferencias frente a otros casos de uso:}
        \begin{itemize}
            \item Ofrece flexibilidad, permitiendo al cliente revisar la factura antes de pagar.
            \item La identificación del payee incluye detalles fiscales, incrementando la seguridad en la validación.
        \end{itemize}
    \end{itemize}

    \item \textbf{Pagos recurrentes}
    \begin{itemize}
        \item \textbf{Descripción:} ideal para suscripciones o pagos periódicos (streaming, software en la nube, gimnasios), el payor autoriza la primera transacción para suscribirse. Los pagos posteriores se gestionan automáticamente según la periodicidad acordada, sin intervención adicional.
        \item \textbf{Proceso de identificación:}
        \begin{itemize}
            \item \textit{Identificación del pagador:} el pagador autoriza la primera transacción con autenticación en su aplicación bancaria (cuenta, contraseña o biométrica).
            \item \textit{Identificación del beneficiario:} el beneficiario se identifica por su ID de suscripción y número de cuenta para configurar los pagos recurrentes.
        \end{itemize}
        \item \textbf{Proceso de pago:}
        \begin{itemize}
            \item El cliente autoriza el pago inicial.
            \item Los cobros posteriores se realizan automáticamente según la periodicidad (mensual, anual, etc.).
        \end{itemize}
        \item \textbf{Diferencias frente a otros casos de uso:}
        \begin{itemize}
            \item Se distingue por la automatización tras la autorización inicial, reduciendo la intervención del cliente.
            \item La comodidad y la automatización son sus principales ventajas.
        \end{itemize}
    \end{itemize}

    \item \textbf{Pagos de grandes montos}
    \begin{itemize}
        \item \textbf{Descripción:} utilizado en transacciones de alto valor (compras importantes, bienes de gran valor), este caso requiere métodos adicionales de autenticación para garantizar la seguridad.
        \item \textbf{Proceso de identificación:}
        \begin{itemize}
            \item \textit{Identificación del pagador:} el pagador usa autenticación robusta (OTP, \textit{tokens} de seguridad o multifactor como PIN y biométrica) para validar la transacción.
            \item \textit{Identificación del beneficiario:} el beneficiario es una entidad registrada con un identificador único (ID de comerciante), asegurando el destinatario correcto.
        \end{itemize}
        \item \textbf{Proceso de pago:}
        \begin{itemize}
            \item El pagador revisa el monto y autoriza el pago con autenticación adicional.
            \item Tras verificar la identidad, el pago se completa.
        \end{itemize}
        \item \textbf{Diferencias frente a otros casos de uso:}
        \begin{itemize}
            \item Requiere autenticación más fuerte debido al alto riesgo de fraude en grandes sumas.
            \item La seguridad es el factor más crítico, priorizando la protección contra fraudes y errores.
        \end{itemize}
    \end{itemize}
\end{enumerate}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{RTP dentro del ecosistema de pagos: arquitectura en capas}
\label{subsec:cubo-pagos}

El ecosistema de pagos SEPA se puede describir mediante capas jerárquicas, desde los usuarios finales hasta las infraestructuras financieras que ejecutan las transacciones. A continuación se detallan las principales capas del modelo actual de pagos SEPA presente en la figura \ref{fig:Esquema por capas}:

\begin{description}[itemsep=15pt, parsep=0pt]
  \item[\textbf{Capa de usuarios finales.}] 
    En la capa más alta se encuentran el \emph{pagador} y el \emph{beneficiario}. Son quienes inician y reciben los pagos, respectivamente, ya sea personas o empresas involucradas en una transacción.
  \item[\textbf{Capa de iniciación o interacción.}] 
    Es donde se produce la solicitud o autorización del pago a través de algún canal o interfaz. Por ejemplo, en pagos SEPA tradicionales el pagador suele autorizar una transferencia mediante la banca online o una aplicación móvil. En entornos de comercio electrónico o físico, esta capa correspondería al proceso de \emph{checkout} (por ejemplo, introduciendo datos en una pasarela de pago online o mediante un TPV/POS en tienda).
  \item[\textbf{Capa de proveedores de servicios de pago (PSP).}] 
    Aquí actúan las entidades financieras o PSP de cada parte. Típicamente, el banco del pagador y el banco del beneficiario son quienes ofrecen las cuentas bancarias y servicios de pago a sus clientes. Estas entidades facilitan la emisión y recepción de órdenes de pago en nombre de los usuarios finales.
  \item[\textbf{Capa de esquemas de pago SP.}] 
    Es el conjunto de reglas y estándares comunes que permiten la interoperabilidad entre todos los PSP. En SEPA, por ejemplo, existen los esquemas de transferencia crediticia SCT o SCT Inst y adeudo directo SDD, definidos por el EPC (explicados anteriormente). Cada esquema asegura que, independientemente del banco involucrado, un pago en euros siga las mismas normas y formatos. Un esquema de pago no es el movimiento del dinero en sí, sino el conjunto de reglas, mensajes e infraestructura técnica que orquesta cómo se inician y gestionan esos pagos.
  \item[\textbf{Capa de infraestructuras de compensación.}] 
    Son las plataformas interbancarias que procesan las transacciones según las reglas del esquema. Estas infraestructuras se encargan de intercambiar las órdenes de pago entre el banco emisor y el banco receptor, aplicando compensación multilateral si procede.
  \item[\textbf{Capa de liquidación.}] 
    Es la capa más baja, donde se realiza la liquidación final de fondos entre bancos. Normalmente ocurre en los bancos centrales u organismos de compensación: por ejemplo, las obligaciones netas resultantes de muchas transacciones SEPA pueden liquidarse en TARGET2 (sistema del Banco Central Europeo). En pagos inmediatos, la liquidación suele ser casi en tiempo real (por ejemplo, mediante TIPS \cite{ECB_TIPS} que liquida cada operación al momento en cuentas del banco central).
\end{description}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.5\textwidth]{Imagenes/esq1.png}
  \caption{Esquema por capas}
  \label{fig:Esquema por capas}
\end{figure}

Esta arquitectura por capas garantiza que un pago iniciado por un usuario en un banco pueda llegar a otro usuario en distinto banco de forma segura, eficiente e interoperable en toda la zona euro. Cada capa agrega funciones específicas: los usuarios generan órdenes, los PSP las gestionan, los esquemas proporcionan las reglas comunes, y las infraestructuras las ejecutan y asientan los fondos en última instancia.

RTP es un nuevo servicio incorporado en la arquitectura SEPA que se sitúa principalmente en la capa de esquema de pago, actuando como una capa adicional de mensajería sobre los instrumentos de pago existentes.

%----------------------------------------------------------------------
\subsection*{Ejemplo comparado: pago con tarjeta vs.\ RTP}

Como muestra el esquema comparativo de la figura \ref{fig:Esquema por capas comparación} los pagos con tarjeta (ej.\ Visa/Mastercard) históricamente han operado con una arquitectura de funciones similar a la de SEPA, pero con diferencias en los actores y procesos de cada capa:

\begin{description}
  \item[\textbf{Usuarios (pagador/beneficiario).}]
    En tarjetas, el pagador es el \emph{titular de la tarjeta} y el beneficiario es el \emph{comercio} que recibe el pago. En esencia es equivalente al ordenante y beneficiario de una transferencia, con la diferencia de que el pagador utiliza un instrumento distinto (su tarjeta en lugar de una cuenta bancaria directa).

  \item[\textbf{PSP / entidades.}]
    En el modelo de cuatro partes de las tarjetas interviene el \emph{banco emisor} (emite la tarjeta al pagador) y el \emph{banco adquirente} (procesa pagos para el comerciante). Estos roles son análogos a la entidad del pagador y del beneficiario en SEPA, pero en el mundo tarjeta suelen implicar acuerdos específicos (p.\,ej.\,el comerciante contrata un adquirente para aceptar Visa/Mastercard). En cambio, en SEPA cualquier banco puede enviar o recibir transferencias para un cliente sin acuerdos individuales con cada comercio, ya que todos siguen el esquema común.

  \item[\textbf{Esquema de pago.}]
    Las tarjetas operan bajo esquemas propietarios como Visa, Mastercard, etc., que definen reglas, formatos de mensajes (p.\,ej.\ mensajes de autorización y liquidación) y que actúan también como redes de procesamiento. Son equivalentes a los esquemas SEPA en cuanto a que proveen interoperabilidad, pero controlados por empresas particulares. El esquema Visa/Mastercard indica cómo se autoriza una compra, cómo se liquida posteriormente y fija también aspectos comerciales como las tasas de intercambio entre emisor y adquirente. En SEPA, el esquema SRTP + SCT Inst provee una funcionalidad comparable de solicitud y pago, pero dentro de un marco colaborativo paneuropeo.
  \item[\textbf{Infraestructura de compensación.}]
    En los pagos con tarjeta, la red del esquema (p.\,ej.\ VisaNet) se encarga de la autorización instantánea de la transacción y de la compensación/\textit{clearing} de las transacciones entre emisores y adquirentes. Visa o Mastercard centralizan el intercambio de mensajes financieros. En SEPA, por el contrario, las compensaciones suelen realizarse a través de múltiples infraestructuras (por ejemplo, cámaras como STEP2 o servicios inmediatos como TIPS) que no pertenecen a una sola empresa sino que son parte del ecosistema colaborativo europeo. Con RTP, la mensajería de solicitud viaja por la red designada (p.\,ej.\ la plataforma R2P de EBA Clearing) y el pago resultante se compensa a través de los \emph{rails} SEPA existentes (p.\,ej.\ RT1/TIPS para instantáneas).

  \item[\textbf{Liquidación final.}]
    En ambos casos, finalmente hay un traspaso de fondos entre bancos. En las tarjetas, las marcas de tarjeta calculan las obligaciones netas entre cada banco emisor y adquirente y típicamente las liquidan al final del día a través de cuentas en un banco central u otros mecanismos interbancarios. En SEPA, cada transferencia individual (especialmente si es instantánea) puede liquidarse inmediatamente en el banco central. Desde el punto de vista de capas, ambos mundos terminan convergiendo en la necesidad de que el dinero se ajuste entre las cuentas de los bancos participantes.
\end{description}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\textwidth]{Imagenes/LayerComp.png}
  \caption{LayerComp}
  \label{fig:Esquema por capas comparación}
\end{figure}

\bigskip

\noindent\textbf{¿Qué simplifica o elimina RTP respecto al modelo de tarjetas?}

Principalmente, elimina intermediarios dedicados y procesos redundantes. Por ejemplo, en un pago SRTP + SCT Inst no es necesario un procesador específico ni una red de tarjetas propietaria, ya que los propios bancos de pagador y beneficiario se comunican directamente mediante el esquema común. Esto puede reducir costes de aceptación para el comercio (evitando comisiones elevadas de tarjetas) y simplifica la integración: el comercio recibe el dinero directamente en su cuenta bancaria vía SEPA, sin pasos intermedios de recibir fondos a través de entidades de tarjeta y luego liquidarlos. Además, no se requiere que el pagador proporcione datos sensibles como el PAN de tarjeta o incluso su IBAN al comercio; la solicitud llega por canales bancarios seguros y el cliente simplemente autoriza en su entorno bancario. En resumen, RTP se apoya en la infraestructura bancaria existente (cuentas y pagos inmediatos) para ofrecer una experiencia similar a la de tarjeta, pero con menos capas propietarias, aprovechando la red SEPA ya desplegada en toda Europa.


%----------------------------------------------------------------------
% FIN DE BLOQUE
%----------------------------------------------------------------------



# END FILE CONTENTS


# File: backend/requirements.txt

Flask==2.2.2
Flask-SQLAlchemy==3.0.2


# END FILE CONTENTS


# File: MemoriaTFG/main.out

\BOOKMARK [1][-]{section*.1}{Agradecimientos}{}% 1
\BOOKMARK [1][-]{section*.3}{Resumen}{}% 2
\BOOKMARK [1][-]{chapter*.8}{Lista de acr\363nimos}{}% 3
\BOOKMARK [0][-]{chapter.1}{Introducci\363n}{}% 4
\BOOKMARK [1][-]{section.1.1}{Motivaci\363n}{chapter.1}% 5
\BOOKMARK [2][-]{subsection.1.1.1}{Ineficiencias operativas detectadas}{section.1.1}% 6
\BOOKMARK [2][-]{subsection.1.1.2}{Oportunidad de un esquema RTP}{section.1.1}% 7
\BOOKMARK [1][-]{section.1.2}{Objetivos fundamentales}{chapter.1}% 8
\BOOKMARK [1][-]{section.1.3}{Fases y M\351todos}{chapter.1}% 9
\BOOKMARK [0][-]{chapter.2}{Antecedentes y estado del arte}{}% 10
\BOOKMARK [1][-]{section.2.1}{Evoluci\363n de los medios de pago hacia SEPA}{chapter.2}% 11
\BOOKMARK [1][-]{section.2.2}{El papel del EPC en la estandarizaci\363n y el surgimiento de Request-to-Pay}{chapter.2}% 12
\BOOKMARK [1][-]{section.2.3}{Funcionamiento t\351cnico de SEPA Request-to-Pay \(SRTP\)}{chapter.2}% 13
\BOOKMARK [1][-]{section.2.4}{RTP dentro del ecosistema de pagos: arquitectura en capas}{chapter.2}% 14
\BOOKMARK [0][-]{chapter.3}{Dise\361o}{}% 15
\BOOKMARK [1][-]{section.3.1}{Objetivos t\351cnicos}{chapter.3}% 16
\BOOKMARK [1][-]{section.3.2}{Actores y alcance}{chapter.3}% 17
\BOOKMARK [1][-]{section.3.3}{Requisitos}{chapter.3}% 18
\BOOKMARK [2][-]{subsection.3.3.1}{Requisitos funcionales \(RF\)}{section.3.3}% 19
\BOOKMARK [2][-]{subsection.3.3.2}{Requisitos no funcionales \(RNF\)}{section.3.3}% 20
\BOOKMARK [1][-]{section.3.4}{Casos de uso}{chapter.3}% 21
\BOOKMARK [2][-]{subsection.3.4.1}{CU-01 Crear solicitud RTP}{section.3.4}% 22
\BOOKMARK [2][-]{subsection.3.4.2}{CU-02: Decidir solicitud RTP}{section.3.4}% 23
\BOOKMARK [1][-]{section.3.5}{Modelo de datos}{chapter.3}% 24
\BOOKMARK [1][-]{section.3.6}{Arquitectura l\363gica}{chapter.3}% 25
\BOOKMARK [2][-]{subsection.3.6.1}{Componentes principales}{section.3.6}% 26
\BOOKMARK [2][-]{subsection.3.6.2}{Flujo de interacci\363n l\363gico}{section.3.6}% 27
\BOOKMARK [1][-]{section.3.7}{Emulaci\363n del flujo RTP}{chapter.3}% 28
\BOOKMARK [2][-]{subsection.3.7.1}{M\341quina de estados del objeto RTP}{section.3.7}% 29
\BOOKMARK [2][-]{subsection.3.7.2}{Transiciones y reglas de negocio}{section.3.7}% 30
\BOOKMARK [2][-]{subsection.3.7.3}{Condiciones excepcionales y timeouts}{section.3.7}% 31
\BOOKMARK [0][-]{chapter.4}{Implementaci\363n}{}% 32
\BOOKMARK [1][-]{section.4.1}{Visi\363n general de la arquitectura y organizaci\363n del c\363digo}{chapter.4}% 33
\BOOKMARK [2][-]{subsection.4.1.1}{Componentes del servidor}{section.4.1}% 34
\BOOKMARK [2][-]{subsection.4.1.2}{Estructura de directorios}{section.4.1}% 35
\BOOKMARK [2][-]{subsection.4.1.3}{Satisfacci\363n de requisitos}{section.4.1}% 36
\BOOKMARK [1][-]{section.4.2}{Persistencia y modelos ORM}{chapter.4}% 37
\BOOKMARK [1][-]{section.4.3}{Servicios de dominio}{chapter.4}% 38
\BOOKMARK [1][-]{section.4.4}{API REST y WebSocket}{chapter.4}% 39
\BOOKMARK [1][-]{section.4.5}{Blueprints y su prop\363sito}{chapter.4}% 40
\BOOKMARK [1][-]{section.4.6}{Endpoints REST}{chapter.4}% 41
\BOOKMARK [1][-]{section.4.7}{Frontend y notificaciones}{chapter.4}% 42
\BOOKMARK [1][-]{section.4.8}{Despliegue y configuraci\363n}{chapter.4}% 43
\BOOKMARK [2][-]{subsection.4.8.1}{Ejecuci\363n del sistema}{section.4.8}% 44
\BOOKMARK [2][-]{subsection.4.8.2}{Conclusi\363n}{section.4.8}% 45
\BOOKMARK [0][-]{chapter.5}{Validacion}{}% 46
\BOOKMARK [1][-]{section.5.1}{Entorno de pruebas}{chapter.5}% 47
\BOOKMARK [1][-]{section.5.2}{Metodolog\355a}{chapter.5}% 48
\BOOKMARK [1][-]{section.5.3}{Flujo happy path}{chapter.5}% 49
\BOOKMARK [1][-]{section.5.4}{Escenarios de error}{chapter.5}% 50
\BOOKMARK [1][-]{section.5.5}{Conclusiones}{chapter.5}% 51
\BOOKMARK [0][-]{chapter.6}{Conclusiones}{}% 52
\BOOKMARK [0][-]{chapter.7}{L\355neas futuras}{}% 53
\BOOKMARK [1][-]{chapter*.28}{\315ndice de Figuras}{chapter.7}% 54
\BOOKMARK [1][-]{chapter*.29}{\315ndice de Tablas}{chapter.7}% 55
\BOOKMARK [1][-]{chapter*.30}{\315ndice de Listados}{chapter.7}% 56


# END FILE CONTENTS


# File: MemoriaTFG/src/resultados.tex

\chapter{Resultados y discusión}
\label{sec:ResultadosDiscusion}
Esta sección presenta los resultados obtenidos y su análisis...

\section{Presentación de los resultados}
\label{subsec:PresentacionResultados}
\subsection{Comparativa con los estándares del EPC}
\label{subsubsec:ComparativaEPC}
La implementación cumple con los requisitos establecidos por el EPC...

\subsection{Análisis de casos de uso}
\label{subsubsec:AnalisisCasosUso}
Se analizaron casos de uso reales para evaluar el comportamiento del sistema...

\section{Discusión de los resultados}
\label{subsec:DiscusionResultados}
Se discuten las implicaciones de los resultados y las limitaciones encontradas...


# END FILE CONTENTS


# File: backend/routes.py

from flask import Blueprint, request, jsonify
from services import (
    crear_rtp_service,
    validar_beneficiario_service,
    enrutar_rtp_service,
    validar_payer_service,
    decision_payer_service
)
from utils_roles import role_required
from models import Actor, db
from flask import request

rtp_blueprint = Blueprint('rtp', __name__)

# 1. Creación del RTP
@rtp_blueprint.route('/rtp', methods=['POST'])
@role_required('beneficiary')
def crear_rtp():
    data = request.get_json()
    # ID del beneficiario que está logueado
    beneficiary_id = data.get('actor_id')
    # El IBAN del pagador
    payer_iban = data.get('payer_iban')
    # Monto
    amount = data.get('amount')

    if not payer_iban:
        return jsonify({"error": "Falta iban"}), 400
    
    if not amount:
        return jsonify({"error": "Falta amount"}), 400

    # Llamamos a la lógica de creación en services
    result = crear_rtp_service(data)
    status = 201 if "error" not in result else 400
    return jsonify(result), status

# 2. Validación Beneficiario
@rtp_blueprint.route('/rtp/<int:rtp_id>/validate-beneficiary', methods=['POST'])
@role_required('psp_beneficiary')
def validar_beneficiario(rtp_id):
    result = validar_beneficiario_service(rtp_id)
    status = 200 if "error" not in result else 400
    return jsonify(result), status

# 3. Enrutar al PSP del pagador
@rtp_blueprint.route('/rtp/<int:rtp_id>/route', methods=['POST'])
@role_required('psp_beneficiary')
def enrutar_rtp(rtp_id):
    result = enrutar_rtp_service(rtp_id)
    status = 200 if "error" not in result else 400
    return jsonify(result), status

# 4. Validación del Payer
@rtp_blueprint.route('/rtp/<int:rtp_id>/validate-payer', methods=['POST'])
@role_required('psp_payer')
def validar_payer(rtp_id):
    result = validar_payer_service(rtp_id)
    status = 200 if "error" not in result else 400
    return jsonify(result), status

# 5. Decisión final
@rtp_blueprint.route('/rtp/<int:rtp_id>/decision', methods=['POST'])
@role_required('payer')
def decision_payer(rtp_id):
    data = request.get_json()
    result = decision_payer_service(rtp_id, data)
    status = 200 if "error" not in result else 400
    return jsonify(result), status

# Ver logs
@rtp_blueprint.route('/logs', methods=['GET'])
def obtener_logs():
    from models import Log
    logs = Log.query.all()
    result = [log.to_dict() for log in logs]
    return jsonify(result)

# Crear Actor
@rtp_blueprint.route('/actors', methods=['POST'])
def create_actor():
    data = request.get_json()
    name = data.get('name')
    role = data.get('role')

    if not name or not role:
        return jsonify({"error": "Faltan campos requeridos: name, role"}), 400

    valid_roles = ['beneficiary', 'psp_beneficiary', 'psp_payer', 'payer']
    if role not in valid_roles:
        return jsonify({"error": f"Rol '{role}' no válido"}), 400

    actor = Actor(name=name, role=role)
    db.session.add(actor)
    db.session.commit()

    return jsonify({"message": "Actor creado", "id": actor.id, "role": actor.role}), 201


@rtp_blueprint.route('/actors_info/<int:actor_id>', methods=['GET'])
def get_actor_info(actor_id):
    from models import Actor
    actor = Actor.query.get(actor_id)
    if not actor:
        return jsonify({"error": "Actor no encontrado"}), 404
    return jsonify(actor.to_dict())


#auth_blueprint = Blueprint('auth', __name__)

@rtp_blueprint.route('/login', methods=['POST'])
def login():
    data = request.get_json()
    username = data.get('username')
    password = data.get('password')
    if not username or not password:
        return jsonify({"error": "Faltan credenciales"}), 400
    
    actor = Actor.query.filter_by(username=username).first()
    if not actor:
        return jsonify({"error": "Usuario no existe"}), 404
    
    if actor.password != password:
        return jsonify({"error": "Contraseña incorrecta"}), 401
    
    # Login exitoso
    return jsonify({
        "message": "Login correcto",
        "actor_id": actor.id,
        "role": actor.role,
        "name": actor.name
    })

@rtp_blueprint.route('/profile/<int:actor_id>', methods=['GET'])
def get_profile(actor_id):
    actor = Actor.query.get(actor_id)
    if not actor:
        return jsonify({"error": "Actor no encontrado"}), 404
    # Si quieres restringir a payer: verifícalo con su rol, etc.
    return jsonify(actor.to_dict()), 200


@rtp_blueprint.route('/profile', methods=['POST'])
@role_required('payer')
def update_profile():
    data = request.get_json() or {}
    actor_id = data.get('actor_id')
    actor = Actor.query.get(actor_id)
    if not actor:
        return jsonify({"error": "Actor no encontrado"}), 404

    # Campos opcionales
    new_photo = data.get('photo_url')
    new_iban = data.get('iban')
    new_balance = data.get('balance')

    if new_photo is not None:
        actor.photo_url = new_photo
    if new_iban is not None:
        actor.iban = new_iban
    if new_balance is not None:
        actor.balance = float(new_balance)

    db.session.commit()
    return jsonify({"message": "Perfil actualizado", "actor": actor.to_dict()})


# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/MAQUINAESTADOS.svg

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="STATE" height="466px" preserveAspectRatio="none" style="width:1053px;height:466px;background:#FFFFFF;" version="1.1" viewBox="0 0 1053 466" width="1053px" zoomAndPan="magnify"><defs/><g><ellipse cx="830.81" cy="16" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1;"/><g id="Creado"><rect fill="#D3D3D3" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:2;" width="70.1758" x="795.72" y="55"/><line style="stroke:#181818;stroke-width:2;" x1="795.72" x2="865.8958" y1="81.2969" y2="81.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.1758" x="805.72" y="72.9951">Creado</text></g><g id="Validado_Beneficiario"><rect fill="#D3D3D3" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:2;" width="170.7529" x="564.44" y="134"/><line style="stroke:#181818;stroke-width:2;" x1="564.44" x2="735.1929" y1="160.2969" y2="160.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.7529" x="574.44" y="151.9951">Validado_Beneficiario</text></g><g id="Enrutado"><rect fill="#D3D3D3" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:2;" width="83.8682" x="433.88" y="213"/><line style="stroke:#181818;stroke-width:2;" x1="433.88" x2="517.7482" y1="239.2969" y2="239.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.8682" x="443.88" y="230.9951">Enrutado</text></g><g id="Validado_Pagador"><rect fill="#D3D3D3" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:2;" width="145.5488" x="247.04" y="292"/><line style="stroke:#181818;stroke-width:2;" x1="247.04" x2="392.5888" y1="318.2969" y2="318.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.5488" x="257.04" y="309.9951">Validado_Pagador</text></g><g id="Aceptado"><rect fill="#D3D3D3" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:2;" width="86.2949" x="63.66" y="371"/><line style="stroke:#181818;stroke-width:2;" x1="63.66" x2="149.9549" y1="397.2969" y2="397.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.2949" x="73.66" y="388.9951">Aceptado</text></g><g id="Rechazado"><rect fill="#D3D3D3" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:2;" width="96.8701" x="174.38" y="371"/><line style="stroke:#181818;stroke-width:2;" x1="174.38" x2="271.2501" y1="397.2969" y2="397.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.8701" x="184.38" y="388.9951">Rechazado</text></g><g id="Cancelado"><rect fill="#D3D3D3" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:2;" width="93.459" x="501.08" y="371"/><line style="stroke:#181818;stroke-width:2;" x1="501.08" x2="594.539" y1="397.2969" y2="397.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.459" x="511.08" y="388.9951">Cancelado</text></g><g class="entity" data-entity="GMN2" data-source-line="22" data-uid="ent0003" id="entity_GMN2"><path d="M846.75,148.18 L846.75,169.8206 A0,0 0 0 0 846.75,169.8206 L1046.8662,169.8206 A0,0 0 0 0 1046.8662,169.8206 L1046.8662,158.18 L1036.8662,148.18 L935.54,148.18 L866.25,104.52 L927.54,148.18 L846.75,148.18 A0,0 0 0 0 846.75,148.18" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M1036.8662,148.18 L1036.8662,158.18 L1046.8662,158.18 L1036.8662,148.18" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="179.1162" x="852.75" y="162.4622">Solicitud iniciada por el Beneficiario</text></g><g class="entity" data-entity="GMN5" data-source-line="25" data-uid="ent0006" id="entity_GMN5"><path d="M642.71,227.18 L642.71,248.8206 A0,0 0 0 0 642.71,248.8206 L810.9219,248.8206 A0,0 0 0 0 810.9219,248.8206 L810.9219,237.18 L800.9219,227.18 L720.51,227.18 L674.18,184.36 L712.51,227.18 L642.71,227.18 A0,0 0 0 0 642.71,227.18" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M800.9219,227.18 L800.9219,237.18 L810.9219,237.18 L800.9219,227.18" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="147.2119" x="648.71" y="241.4622">Validada por PSP Beneficiario</text></g><g class="entity" data-entity="GMN8" data-source-line="28" data-uid="ent0009" id="entity_GMN8"><path d="M466.47,306.18 L466.47,327.8206 A0,0 0 0 0 466.47,327.8206 L611.1614,327.8206 A0,0 0 0 0 611.1614,327.8206 L611.1614,316.18 L601.1614,306.18 L534.38,306.18 L495.75,263.36 L526.38,306.18 L466.47,306.18 A0,0 0 0 0 466.47,306.18" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M601.1614,306.18 L601.1614,316.18 L611.1614,316.18 L601.1614,306.18" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="123.6914" x="472.47" y="320.4622">Enrutada al PSP Pagador</text></g><g class="entity" data-entity="GMN11" data-source-line="31" data-uid="ent0012" id="entity_GMN11"><path d="M281.71,385.18 L281.71,406.8206 A0,0 0 0 0 281.71,406.8206 L431.919,406.8206 A0,0 0 0 0 431.919,406.8206 L431.919,395.18 L421.919,385.18 L355.86,385.18 L331.52,342.36 L347.86,385.18 L281.71,385.18 A0,0 0 0 0 281.71,385.18" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M421.919,385.18 L421.919,395.18 L431.919,395.18 L421.919,385.18" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="129.209" x="287.71" y="399.4622">Validada por PSP Pagador</text></g><g class="entity" data-entity="GMN14" data-source-line="34" data-uid="ent0015" id="entity_GMN14"><path d="M6,438 L6,459.6406 A0,0 0 0 0 6,459.6406 L151.624,459.6406 A0,0 0 0 0 151.624,459.6406 L151.624,448 L141.624,438 L88.24,438 L93.47,421.22 L80.24,438 L6,438 A0,0 0 0 0 6,438" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M141.624,438 L141.624,448 L151.624,448 L141.624,438" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="124.624" x="12" y="452.2822">Aprobada por el Pagador</text></g><g class="entity" data-entity="GMN17" data-source-line="37" data-uid="ent0018" id="entity_GMN17"><path d="M161.73,438 L161.73,459.6406 A0,0 0 0 0 161.73,459.6406 L313.9019,459.6406 A0,0 0 0 0 313.9019,459.6406 L313.9019,448 L303.9019,438 L238.91,438 L229.96,421.22 L230.91,438 L161.73,438 A0,0 0 0 0 161.73,438" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M303.9019,438 L303.9019,448 L313.9019,448 L303.9019,438" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="131.1719" x="167.73" y="452.2822">Rechazada por el Pagador</text></g><g class="entity" data-entity="GMN20" data-source-line="40" data-uid="ent0021" id="entity_GMN20"><path d="M461.89,438 L461.89,459.6406 A0,0 0 0 0 461.89,459.6406 L633.7298,459.6406 A0,0 0 0 0 633.7298,459.6406 L633.7298,448 L623.7298,438 L551.81,438 L547.81,421.22 L543.81,438 L461.89,438 A0,0 0 0 0 461.89,438" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M623.7298,438 L623.7298,448 L633.7298,448 L623.7298,438" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="150.8398" x="467.89" y="452.2822">Cancelada por cualquier actor</text></g><!--link *start* to Creado--><g class="link" data-entity-1=".start." data-entity-2="Creado" data-source-line="10" data-uid="lnk4" id="link_.start._Creado"><path d="M830.81,26.42 C830.81,33.94 830.81,38.82 830.81,48.74" fill="none" id="*start*-to-Creado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="830.81,54.74,834.81,45.74,830.81,49.74,826.81,45.74,830.81,54.74" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="26.001" x="831.81" y="44.2822">crear</text></g><!--link Creado to Validado_Beneficiario--><g class="link" data-entity-1="Creado" data-entity-2="Validado_Beneficiario" data-source-line="11" data-uid="lnk6" id="link_Creado_Validado_Beneficiario"><path d="M795.3,89.18 C774.08,94.66 746.84,102.76 723.81,113 C710.9,118.74 702.5906,123.1802 690.7906,130.4902" fill="none" id="Creado-to-Validado_Beneficiario" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="685.69,133.65,695.4474,132.3107,689.9405,131.0169,691.2344,125.51,685.69,133.65" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="97.8906" x="724.81" y="123.2822">validar_beneficiario</text></g><!--link Validado_Beneficiario to Enrutado--><g class="link" data-entity-1="Validado_Beneficiario" data-entity-2="Enrutado" data-source-line="12" data-uid="lnk8" id="link_Validado_Beneficiario_Enrutado"><path d="M594.76,184.36 C569.97,195.33 546.6463,205.6509 523.5863,215.8609" fill="none" id="Validado_Beneficiario-to-Enrutado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="518.1,218.29,527.9488,218.3039,522.6719,216.2657,524.71,210.9888,518.1,218.29" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="37.0996" x="574.81" y="202.2822">enrutar</text></g><!--link Enrutado to Validado_Pagador--><g class="link" data-entity-1="Enrutado" data-entity-2="Validado_Pagador" data-source-line="13" data-uid="lnk10" id="link_Enrutado_Validado_Pagador"><path d="M433.41,242.21 C393.26,246.21 337.06,254.61 322.81,271 C317.88,276.67 316.3505,278.4212 316.2005,285.8912" fill="none" id="Enrutado-to-Validado_Pagador" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="316.08,291.89,320.2599,282.9721,316.1804,286.891,312.2615,282.8115,316.08,291.89" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="80.7178" x="323.81" y="281.2822">validar_pagador</text></g><!--link Validado_Pagador to Aceptado--><g class="link" data-entity-1="Validado_Pagador" data-entity-2="Aceptado" data-source-line="14" data-uid="lnk12" id="link_Validado_Pagador_Aceptado"><path d="M246.57,342.03 C238.87,344.67 231.17,347.36 223.81,350 C199.33,358.78 177.7986,366.9865 155.8386,375.5665" fill="none" id="Validado_Pagador-to-Aceptado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="150.25,377.75,160.0886,378.2004,154.9072,375.9304,157.1772,370.749,150.25,377.75" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="38.2861" x="224.81" y="360.2822">aceptar</text></g><!--link Validado_Pagador to Rechazado--><g class="link" data-entity-1="Validado_Pagador" data-entity-2="Rechazado" data-source-line="15" data-uid="lnk14" id="link_Validado_Pagador_Rechazado"><path d="M289.12,342.36 C277.8,351.35 269.6681,357.798 258.3381,366.798" fill="none" id="Validado_Pagador-to-Rechazado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="253.64,370.53,263.1752,368.0641,257.5551,367.42,258.1992,361.8,253.64,370.53" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="43.7158" x="278.81" y="360.2822">rechazar</text></g><!--link Creado to Cancelado--><g class="link" data-entity-1="Creado" data-entity-2="Cancelado" data-source-line="16" data-uid="lnk16" id="link_Creado_Cancelado"><path d="M830.81,105.28 C830.81,120.43 830.81,140.35 830.81,158 C830.81,158 830.81,158 830.81,318 C830.81,366.31 681.31,384.8203 600.84,391.4103" fill="none" id="Creado-to-Cancelado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="594.86,391.9,604.1565,395.1521,599.8433,391.4919,603.5035,387.1788,594.86,391.9" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="42.6318" x="831.81" y="241.7822">cancelar</text></g><!--link Validado_Beneficiario to Cancelado--><g class="link" data-entity-1="Validado_Beneficiario" data-entity-2="Cancelado" data-source-line="17" data-uid="lnk17" id="link_Validado_Beneficiario_Cancelado"><path d="M643.98,184.48 C641.92,193.43 639.67,203.65 637.81,213 C626.5,270.05 645.66,292.08 615.81,342 C609.21,353.05 604.1089,358.9699 593.9489,366.8599" fill="none" id="Validado_Beneficiario-to-Cancelado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="589.21,370.54,598.7717,368.1791,593.1591,367.4733,593.8649,361.8606,589.21,370.54" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="42.6318" x="634.81" y="281.2822">cancelar</text></g><!--link Enrutado to Cancelado--><g class="link" data-entity-1="Enrutado" data-entity-2="Cancelado" data-source-line="18" data-uid="lnk18" id="link_Enrutado_Cancelado"><path d="M439.92,263.33 C431.02,271.32 422.65,281.02 417.81,292 C408.85,312.33 405.41,323.56 417.81,342 C436.24,369.41 465.7189,381.3665 494.8989,387.7565" fill="none" id="Enrutado-to-Cancelado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="500.76,389.04,492.824,383.2073,495.8757,387.9704,491.1127,391.0222,500.76,389.04" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="42.6318" x="418.81" y="320.7822">cancelar</text></g><!--link Validado_Pagador to Cancelado--><g class="link" data-entity-1="Validado_Pagador" data-entity-2="Cancelado" data-source-line="19" data-uid="lnk19" id="link_Validado_Pagador_Cancelado"><path d="M339.12,342.16 C347.02,351.38 355.53,360.33 360.81,363 C391.12,378.33 403.28,365.62 436.81,371 C457.93,374.38 475.2373,377.8889 494.9073,382.3289" fill="none" id="Validado_Pagador-to-Cancelado" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="500.76,383.65,492.8616,377.7665,495.8827,382.5491,491.1001,385.5702,500.76,383.65" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="42.6318" x="361.81" y="360.2822">cancelar</text></g><!--SRC=[ZL9DJyCm3BtdLrZYXZG942SEIDi4vuaXBWXDNk9rKTkuk2c8_NhIJwLROJlrzVcz5pjEcLfNe60EEJlMU-6Sm4j5gXmgfKTF2nP3yhgtEdLKbd1t8a2T9iALCqlEME0giydU9u8_nyfdTdvj3mItzr79SLov6LKCbLICIK6Ndf0emjznY7g__e3Px16MGcWO7a078AhxhIjlc5aJVZOBShIpsgBOMlZLyBBPHhIQ5jSnJqugtnv13HGrKADZLfY4ZqGd52sZJYIrRwwfw7AnWN_eNaZlyT0AfSMZCPVeD6NT7RHO_XbdKZuQwF_0gBL9eQhN3LlsddFWNRSV1R3cBFJXAmFMrGqPX2BaK0PnZugSQLxCSSxaH26suzkmrNfrMLe_S0Ze809cZRyRy7mZlN2YXtCP_Uw3Tru8RwFBE6STdaFmzlXYyx2nOEvnQzOLPf-L9GcFqKS9lm00]--></g></svg>

# END FILE CONTENTS


# File: MemoriaTFG/main.fdb_latexmk

# Fdb version 3
["biber main"] 1750745653 "main.bcf" "main.bbl" "main" 1751295696
  "bibliografia.bib" 1750672684 7413 a5436213b03bd47cfcbefee585e66dfe ""
  "main.bcf" 1751295696 102688 02744d98b3ed2c33a8d59050cd2f154c "pdflatex"
  (generated)
  "main.blg"
  "main.bbl"
["pdflatex"] 1751295691 "/home/alonso/SEPA_RTP/MemoriaTFG/main.tex" "main.pdf" "main" 1751295696
  "../backend/app.py" 1747923269 2386 1eae8b42298a3f45206ca8e26d333918 ""
  "../backend/config.py" 1747463500 199 cf2270c53485a7df791b7bcf6720e37a ""
  "../backend/models.py" 1747463500 2719 3628bb85b87bcd8bc146a349a392e515 ""
  "../backend/requirements.txt" 1747463500 37 614c75e3dacfca397920217b322c1f66 ""
  "../backend/routes.py" 1747932593 5126 1989d138a085c771beae276c3797cd7b ""
  "../backend/services.py" 1747932587 4411 d2e4c0d666b79da1a81fa8a4af347750 ""
  "../backend/utils.py" 1750511762 1812 9e9fd3fab7977714563dbea0099e837b ""
  "../frontend/RTP.js" 1747932644 12600 a1ea3b65811cb039db262e72d5ff1055 ""
  "/etc/texmf/web2c/texmf.cnf" 1747463238 475 c0e671620eb5563b2130f56340a5fde8 ""
  "/home/alonso/SEPA_RTP/MemoriaTFG/main.tex" 1751294368 6790 2c64d184898721d0abdd54185b80f9b2 ""
  "/usr/share/texlive/texmf-dist/fonts/map/fontname/texfonts.map" 1577235249 3524 cb3e574dea2d1052e39280babc910dc8 ""
  "/usr/share/texlive/texmf-dist/fonts/type1/public/amsfonts/cm/cmmi10.pfb" 1248133631 36299 5f9df58c2139e7edcf37c8fca4bd384d ""
  "/usr/share/texlive/texmf-dist/fonts/type1/public/amsfonts/cm/cmsy10.pfb" 1248133631 32569 5e5ddc8df908dea60932f3c484a54c0d ""
  "/usr/share/texlive/texmf-dist/tex/context/base/mkii/supp-pdf.mkii" 1461363279 71627 94eb9990bed73c364d7f53f960cc8c5b ""
  "/usr/share/texlive/texmf-dist/tex/generic/atbegshi/atbegshi.sty" 1575674566 24708 5584a51a7101caf7e6bbf1fc27d8f7b1 ""
  "/usr/share/texlive/texmf-dist/tex/generic/babel-english/english.ldf" 1496785618 7008 9ff5fdcc865b01beca2b0fe4a46231d4 ""
  "/usr/share/texlive/texmf-dist/tex/generic/babel-spanish/spanish.ldf" 1456955205 26223 0286ca123141cff8dd4956c4576d2ef4 ""
  "/usr/share/texlive/texmf-dist/tex/generic/babel/babel.def" 1581719732 87344 ec128793fb5196bbcc1741e5366ddac1 ""
  "/usr/share/texlive/texmf-dist/tex/generic/babel/babel.sty" 1581719732 18844 909add1631725af40d27125357ea816e ""
  "/usr/share/texlive/texmf-dist/tex/generic/babel/switch.def" 1581719732 15529 e761dc130df77f0ce9717a25d1b52a95 ""
  "/usr/share/texlive/texmf-dist/tex/generic/babel/txtbabel.def" 1580769195 5220 42a6518b499d20676051f269c61f4d9a ""
  "/usr/share/texlive/texmf-dist/tex/generic/bigintcalc/bigintcalc.sty" 1576625341 40635 c40361e206be584d448876bba8a64a3b ""
  "/usr/share/texlive/texmf-dist/tex/generic/bitset/bitset.sty" 1576016050 33961 6b5c75130e435b2bfdb9f480a09a39f9 ""
  "/usr/share/texlive/texmf-dist/tex/generic/etexcmds/etexcmds.sty" 1576625273 7734 b98cbb34c81f667027c1e3ebdbfce34b ""
  "/usr/share/texlive/texmf-dist/tex/generic/gettitlestring/gettitlestring.sty" 1576625223 8371 9d55b8bd010bc717624922fb3477d92e ""
  "/usr/share/texlive/texmf-dist/tex/generic/iftex/iftex.sty" 1573336935 6902 30fdaf7dc5636b8e3afa306210c45cae ""
  "/usr/share/texlive/texmf-dist/tex/generic/iftex/ifvtex.sty" 1572645307 1057 525c2192b5febbd8c1f662c9468335bb ""
  "/usr/share/texlive/texmf-dist/tex/generic/infwarerr/infwarerr.sty" 1575499628 8356 7bbb2c2373aa810be568c29e333da8ed ""
  "/usr/share/texlive/texmf-dist/tex/generic/intcalc/intcalc.sty" 1576625065 31769 002a487f55041f8e805cfbf6385ffd97 ""
  "/usr/share/texlive/texmf-dist/tex/generic/kvdefinekeys/kvdefinekeys.sty" 1576878844 5412 d5a2436094cd7be85769db90f29250a6 ""
  "/usr/share/texlive/texmf-dist/tex/generic/kvsetkeys/kvsetkeys.sty" 1576624944 13807 952b0226d4efca026f0e19dd266dcc22 ""
  "/usr/share/texlive/texmf-dist/tex/generic/ltxcmds/ltxcmds.sty" 1576624883 18552 1e1cc7b75da0dfaacce7cdcb27d306bf ""
  "/usr/share/texlive/texmf-dist/tex/generic/pdfescape/pdfescape.sty" 1576015897 19007 15924f7228aca6c6d184b115f4baa231 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcore.code.tex" 1557692582 992 fb3cda354707a54fda62787a411c7c22 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorearrows.code.tex" 1546728038 43820 bc6cf5aa959817914ace33f5c6232161 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoreexternal.code.tex" 1557692582 19324 c9a64402f22bd8d81821141a357af653 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoregraphicstate.code.tex" 1546728038 6038 d639d02574be9a72f3c602c2a3510e02 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoreimage.code.tex" 1546728038 6948 284bbe3c9a7ca0a826c1c03895e69b9f ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorelayers.code.tex" 1546728038 4883 a6f3eb1f71d8c4affaf43a169828b043 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoreobjects.code.tex" 1546728038 2544 3b1b198fd49f01e328adc9162a07b213 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorepathconstruct.code.tex" 1576793519 44189 1fd6229dad4c898883516c032f2ca5d2 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorepathprocessing.code.tex" 1546728038 17311 3092579be20ef0f229c42ad3f09da85c ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorepathusage.code.tex" 1546728038 21302 d6c4b340248adbe650ebf6ca76bdccca ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorepatterns.code.tex" 1562964315 9690 7585efa5a591822837f837bc5bc35621 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorepoints.code.tex" 1576793519 33335 942ccafe284041918d36e54696b98aa7 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorequick.code.tex" 1546728038 2965 502761b60f43ab2de5ecb2f4625163ae ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorerdf.code.tex" 1546728038 5196 f8c5c775d4d6e2cb050392127cabda72 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorescopes.code.tex" 1576793519 20726 ed6ec1d6f0f35e7a93de4e79af83dbce ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoreshade.code.tex" 1557692582 35249 144a6b9c4df4644618bb3a0a40472608 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoretransformations.code.tex" 1546728038 21989 266e83c51fe41eb8b8d5e6896dc71cc1 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoretransparency.code.tex" 1546728038 8842 5cc856e132fac404805c6da091779283 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/frontendlayer/tikz/libraries/tikzlibrarytopaths.code.tex" 1576793519 11544 2a5d66a3270abf4ef673e8a0b7734a90 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/frontendlayer/tikz/tikz.code.tex" 1576967981 187592 7922ceab1864698dec4c84978d5b182f ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/libraries/pgflibraryplothandlers.code.tex" 1546728038 32995 a4d54c043ae5274ceaaddeb36ad43a6f ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfint.code.tex" 1557692582 3063 8c415c68a0f3394e45cfeca0b65f6ee6 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmath.code.tex" 1557692582 521 c70cf6ad609de83a27ee7929eb356332 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathcalc.code.tex" 1557692582 13391 933cab19c6d27039dbfc487330d1005a ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfloat.code.tex" 1557692582 104938 15f2d8bdabd6bf9ca70f62cd8e3d4940 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.base.code.tex" 1557692582 10157 218d58ab074e5bd0d027de45ec64cc00 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.basic.code.tex" 1576793519 28176 568b081ec39645f2db1a29fbd0c635e2 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.code.tex" 1562964315 9054 388d21239a1b6df2cc8beaae31c976b0 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.comparison.code.tex" 1557692582 3865 cddf7ddc80f018587c55afdcc79fc333 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.integerarithmetics.code.tex" 1557692582 3177 27d85c44fbfe09ff3b2cf2879e3ea434 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.misc.code.tex" 1557692582 10925 df50b8a6e5660a585e3a2bf55726dcc8 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.random.code.tex" 1562964315 7787 1750fc3f164703caf31fc8ea9218c67e ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.round.code.tex" 1557692582 3379 cbd0948a550bd7a495a160ca6beee9ed ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.trigonometric.code.tex" 1557692582 92405 bba89470858d7b0788a9c09331c39653 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathparser.code.tex" 1576793519 36526 453db1f8626a56b5ebb0fad496d6a39f ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathutil.code.tex" 1576793519 8471 b18959397c76e1e582402ab9f592ed9f ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/modules/pgfmodulematrix.code.tex" 1576793519 21201 46a4dded6619f990ac7347f99fbaac9f ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/modules/pgfmoduleplot.code.tex" 1557692582 16121 9e240115374a8d489f2f786115df83a9 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/modules/pgfmoduleshapes.code.tex" 1576793519 43259 3e05ba63539916af2eaca603c2eda780 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/pgf.revision.tex" 1578520427 465 1f401ab1e7fc6cb7ede39e96c66531fd ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgf.cfg" 1557692582 926 70ff613fabeb70f5d1673dc0c93987bd ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsys-common-pdf.def" 1557692582 5546 3586827e6032c95512b2a6682d2979a3 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsys-pdftex.def" 1562964315 12603 c02869ea216d842c29d52fae8738264e ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsys.code.tex" 1557692582 60269 e86bc0081af83a4ad47e4500ee09a2e4 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsysprotocol.code.tex" 1557692582 1896 82c274ff520f9e450ccea4e3ef4edc12 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsyssoftpath.code.tex" 1557692582 7778 a25a32a10ca820357491d4c7b3ac02ea ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgffor.code.tex" 1562964315 23777 cb6c8f02f87d86d621f5cb92c44f4998 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfkeys.code.tex" 1576793519 36815 f7f1772c398f07af2cb741992963045c ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfkeysfiltered.code.tex" 1562964315 37439 bd44d50aef702b03193f731207931834 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfrcs.code.tex" 1557692582 4494 7e5ace0ccf59408f2cf63219a5d36927 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfutil-common-lists.tex" 1557692582 7250 03b2b9fb5fa38e7ca5cc3c45860fb210 ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfutil-common.tex" 1576793519 28309 488ccc6c701bbdd1bf671f708757aa5c ""
  "/usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfutil-latex.def" 1562964315 6286 1bd76fc45da9929ab2a64f51cba3ab6f ""
  "/usr/share/texlive/texmf-dist/tex/generic/uniquecounter/uniquecounter.sty" 1576624663 7008 f92eaa0a3872ed622bbf538217cd2ab7 ""
  "/usr/share/texlive/texmf-dist/tex/generic/xkeyval/xkeyval.tex" 1417732693 19231 26434a5656c684f5ffb1f26f98006baa ""
  "/usr/share/texlive/texmf-dist/tex/generic/xkeyval/xkvutils.tex" 1403829539 7677 6f5ce7c1124cad7ec57d05b2562bd8fe ""
  "/usr/share/texlive/texmf-dist/tex/generic/xstring/xstring.sty" 1544223003 123 a302f2c651a95033260db60e51527ae8 ""
  "/usr/share/texlive/texmf-dist/tex/generic/xstring/xstring.tex" 1549403660 47762 87512aefe2c24c8c3ff58ba167aba4d9 ""
  "/usr/share/texlive/texmf-dist/tex/latex/acronym/acronym.sty" 1574030308 20662 e2f7532ed9fe79d6390d43ae8f7eed2d ""
  "/usr/share/texlive/texmf-dist/tex/latex/adjustbox/adjcalc.sty" 1523308468 5608 e823b3adfbc2ea70e453a21ea6e2ee12 ""
  "/usr/share/texlive/texmf-dist/tex/latex/adjustbox/adjustbox.sty" 1546638522 55974 e90ddd9a6114a7008a6915da904f2847 ""
  "/usr/share/texlive/texmf-dist/tex/latex/adjustbox/tc-pdftex.def" 1546638522 4061 aa67e478bd1a58a42e026c354f10b158 ""
  "/usr/share/texlive/texmf-dist/tex/latex/adjustbox/trimclip.sty" 1523308468 7142 42aaa49a4afcdc52e9d95e3b19f439be ""
  "/usr/share/texlive/texmf-dist/tex/latex/amsmath/amsgen.sty" 1523134290 4161 7f6eb9092061a11f87d08ed13515b48d ""
  "/usr/share/texlive/texmf-dist/tex/latex/amsmath/amstext.sty" 1523134290 2432 8ff93b1137020e8f21930562a874ae66 ""
  "/usr/share/texlive/texmf-dist/tex/latex/atveryend/atveryend.sty" 1576191570 19336 ce7ae9438967282886b3b036cfad1e4d ""
  "/usr/share/texlive/texmf-dist/tex/latex/auxhook/auxhook.sty" 1576625391 3935 57aa3c3e203a5c2effb4d2bd2efbc323 ""
  "/usr/share/texlive/texmf-dist/tex/latex/base/bk10.clo" 1580683321 8286 94a4316308950c5d5a69b423dbd190ac ""
  "/usr/share/texlive/texmf-dist/tex/latex/base/book.cls" 1580683321 23147 87043b6c3ff70b5e5185aee55d462dd7 ""
  "/usr/share/texlive/texmf-dist/tex/latex/base/ifthen.sty" 1580683321 5159 892429808d9e0e2b3548aaefd9a06ed0 ""
  "/usr/share/texlive/texmf-dist/tex/latex/base/inputenc.sty" 1580683321 5050 8933a39ad74377accd18991c5eb90c58 ""
  "/usr/share/texlive/texmf-dist/tex/latex/biblatex/bbx/alphabetic.bbx" 1566680006 1731 ebd75bda3dd71a7cbd30fde6e3bb6391 ""
  "/usr/share/texlive/texmf-dist/tex/latex/biblatex/bbx/standard.bbx" 1566680006 25703 d3ef9d5e51205b85b7c5803f5bc4945e ""
  "/usr/share/texlive/texmf-dist/tex/latex/biblatex/biblatex.cfg" 1342308459 69 249fa6df04d948e51b6d5c67bea30c42 ""
  "/usr/share/texlive/texmf-dist/tex/latex/biblatex/biblatex.def" 1575845417 89825 5be42972936c98326631c47686cd5b70 ""
  "/usr/share/texlive/texmf-dist/tex/latex/biblatex/biblatex.sty" 1575845417 487938 f1cb8a63882acf2a1f1b144d32b407d6 ""
  "/usr/share/texlive/texmf-dist/tex/latex/biblatex/blx-compat.def" 1566680006 13136 44dd5518476508a5daf59afd6ef412e0 ""
  "/usr/share/texlive/texmf-dist/tex/latex/biblatex/blx-dm.def" 1575845417 32965 817e7da9f6f53e5072a4c2e8f56c4aa9 ""
  "/usr/share/texlive/texmf-dist/tex/latex/biblatex/cbx/alphabetic.cbx" 1510525977 4261 a05ff2d7f15400c462523859a171f7b4 ""
  "/usr/share/texlive/texmf-dist/tex/latex/biblatex/lbx/english.lbx" 1566680006 38102 0107e531be1e2d63345edc3b268e7658 ""
  "/usr/share/texlive/texmf-dist/tex/latex/biblatex/lbx/spanish.lbx" 1541279461 47003 29d8a8938c1fb30ecd0264a437d2db7e ""
  "/usr/share/texlive/texmf-dist/tex/latex/bigfoot/suffix.sty" 1414965027 3090 223874a03a08cecb9fb79bd86e5dcf97 ""
  "/usr/share/texlive/texmf-dist/tex/latex/booktabs/booktabs.sty" 1579038678 6078 f1cb470c9199e7110a27851508ed7a5c ""
  "/usr/share/texlive/texmf-dist/tex/latex/collectbox/collectbox.sty" 1337644648 9116 495d44b5a3e7be0c46c5d1f053f457f0 ""
  "/usr/share/texlive/texmf-dist/tex/latex/enumitem/enumitem.sty" 1561238569 51697 f8f08183cd2080d9d18a41432d651dfb ""
  "/usr/share/texlive/texmf-dist/tex/latex/epstopdf-pkg/epstopdf-base.sty" 1579991033 13886 d1306dcf79a944f6988e688c1785f9ce ""
  "/usr/share/texlive/texmf-dist/tex/latex/etoolbox/etoolbox.sty" 1569190624 45259 743c52a37a6e5ed83cfe0e128b2da10d ""
  "/usr/share/texlive/texmf-dist/tex/latex/float/float.sty" 1137110151 6749 16d2656a1984957e674b149555f1ea1d ""
  "/usr/share/texlive/texmf-dist/tex/latex/footmisc/footmisc.sty" 1312311212 25776 d28bd6d82f168f8cb2268584b67a2a98 ""
  "/usr/share/texlive/texmf-dist/tex/latex/geometry/geometry.sty" 1578002852 41601 9cf6c5257b1bc7af01a58859749dd37a ""
  "/usr/share/texlive/texmf-dist/tex/latex/graphics-cfg/color.cfg" 1459978653 1213 620bba36b25224fa9b7e1ccb4ecb76fd ""
  "/usr/share/texlive/texmf-dist/tex/latex/graphics-cfg/graphics.cfg" 1465944070 1224 978390e9c2234eab29404bc21b268d1e ""
  "/usr/share/texlive/texmf-dist/tex/latex/graphics-def/pdftex.def" 1515537368 17334 520b9b85ad8a2a48eda3f643e27a5179 ""
  "/usr/share/texlive/texmf-dist/tex/latex/graphics/color.sty" 1580683321 7107 12f1c5ba3c6e4a1dde3cb5a3ae4b2cd1 ""
  "/usr/share/texlive/texmf-dist/tex/latex/graphics/graphics.sty" 1580683321 16932 04729abe63b66ec59ea56edcd722b058 ""
  "/usr/share/texlive/texmf-dist/tex/latex/graphics/graphicx.sty" 1580683321 9067 1b996612394a52e1efe89c8bfe8a5892 ""
  "/usr/share/texlive/texmf-dist/tex/latex/graphics/keyval.sty" 1580683321 2590 e3b24ff953e5b58d924f163d25380312 ""
  "/usr/share/texlive/texmf-dist/tex/latex/graphics/trig.sty" 1580683321 3976 d7fa7d81d2870d509d25b17d0245e735 ""
  "/usr/share/texlive/texmf-dist/tex/latex/hycolor/hycolor.sty" 1580250785 17914 4c28a13fc3d975e6e81c9bea1d697276 ""
  "/usr/share/texlive/texmf-dist/tex/latex/hyperref/hpdftex.def" 1579642962 50630 3d9728faf8630190cf601ce2cbe470d9 ""
  "/usr/share/texlive/texmf-dist/tex/latex/hyperref/hyperref.sty" 1579642962 238752 60dd338d71b6a4ab2192131f73dc908b ""
  "/usr/share/texlive/texmf-dist/tex/latex/hyperref/nameref.sty" 1579642962 13244 0070bcab7b5a88187847128d22faf4d8 ""
  "/usr/share/texlive/texmf-dist/tex/latex/hyperref/pd1enc.def" 1579642962 14134 32b36577d311ddb6522413c7581ee968 ""
  "/usr/share/texlive/texmf-dist/tex/latex/ifoddpage/ifoddpage.sty" 1461535682 2148 0426cd8bb94163c1e23726d0c15e2c21 ""
  "/usr/share/texlive/texmf-dist/tex/latex/kvoptions/kvoptions.sty" 1575152344 22520 c4c2dab203104295e1e618be7e5c0f5b ""
  "/usr/share/texlive/texmf-dist/tex/latex/l3backend/l3backend-pdfmode.def" 1580854751 25404 9d60f463a00d154207ec0048dee27cf0 ""
  "/usr/share/texlive/texmf-dist/tex/latex/l3kernel/expl3.sty" 1581719662 4381 04628f3002bdd1d9c43ef984fd60ae18 ""
  "/usr/share/texlive/texmf-dist/tex/latex/l3packages/l3keys2e/l3keys2e.sty" 1581719662 4603 36e20d23ad4e5fdd8990f0c8ded4c131 ""
  "/usr/share/texlive/texmf-dist/tex/latex/l3packages/xparse/xparse.sty" 1581719662 81717 e93576ac4b24ce6e121ebd6ec6cf2893 ""
  "/usr/share/texlive/texmf-dist/tex/latex/latexconfig/epstopdf-sys.cfg" 1279039959 678 4792914a8f45be57bb98413425e4c7af ""
  "/usr/share/texlive/texmf-dist/tex/latex/letltxmacro/letltxmacro.sty" 1575499565 5766 13a9e8766c47f30327caf893ece86ac8 ""
  "/usr/share/texlive/texmf-dist/tex/latex/lipsum/lipsum.ltd.tex" 1546728170 98047 c6fa29828cc60471827afe275c8bd77f ""
  "/usr/share/texlive/texmf-dist/tex/latex/lipsum/lipsum.sty" 1546638616 18060 8cf65af2c4529eed91b5d364b50d3ada ""
  "/usr/share/texlive/texmf-dist/tex/latex/listings/listings.cfg" 1568236792 1830 bbaba8afaf42cc048ec4d4ff73467521 ""
  "/usr/share/texlive/texmf-dist/tex/latex/listings/listings.sty" 1568236792 80511 830f3f1d3ab7448dd84233e9c2f6462c ""
  "/usr/share/texlive/texmf-dist/tex/latex/listings/lstlang1.sty" 1568236792 204271 6a0ce6b8dafb6c4a13b9036ab1717c77 ""
  "/usr/share/texlive/texmf-dist/tex/latex/listings/lstmisc.sty" 1568236792 77022 32914f01b528131c47be2a1040d3856d ""
  "/usr/share/texlive/texmf-dist/tex/latex/logreq/logreq.def" 1284153563 1620 fb1c32b818f2058eca187e5c41dfae77 ""
  "/usr/share/texlive/texmf-dist/tex/latex/logreq/logreq.sty" 1284153563 6187 b27afc771af565d3a9ff1ca7d16d0d46 ""
  "/usr/share/texlive/texmf-dist/tex/latex/makecell/makecell.sty" 1249334690 15773 2dd7dde1ec1c2a3d0c85bc3b273e04d8 ""
  "/usr/share/texlive/texmf-dist/tex/latex/mdwtools/footnote.sty" 1137110333 6005 dcbae7bf04efc282d256f60986bb2c15 ""
  "/usr/share/texlive/texmf-dist/tex/latex/microtype/microtype-pdftex.def" 1574121697 49144 f65726c0bb1ab4ed492745853eff47bf ""
  "/usr/share/texlive/texmf-dist/tex/latex/microtype/microtype.cfg" 1574121697 24293 cbbba0a351268f01b03f4a3b8b367d3c ""
  "/usr/share/texlive/texmf-dist/tex/latex/microtype/microtype.sty" 1574121697 71539 3e8331ef062d90caeae5fc7360dcd5bf ""
  "/usr/share/texlive/texmf-dist/tex/latex/microtype/mt-cmr.cfg" 1570829597 22870 ec010715141eabee449fb667c425a676 ""
  "/usr/share/texlive/texmf-dist/tex/latex/ms/everysel.sty" 1320274502 4623 936bfb87af7b91b6496a2317f80db16b ""
  "/usr/share/texlive/texmf-dist/tex/latex/ms/everyshi.sty" 1177890616 3878 6aa7c08ff2621006e0603349e40a30a8 ""
  "/usr/share/texlive/texmf-dist/tex/latex/pdftexcmds/pdftexcmds.sty" 1574631863 19963 36fd8e818f9f0f32e2db8413d4970122 ""
  "/usr/share/texlive/texmf-dist/tex/latex/pgf/basiclayer/pgf.sty" 1546728038 1090 d20f587ea9464d1841bd0d13d3ff9856 ""
  "/usr/share/texlive/texmf-dist/tex/latex/pgf/basiclayer/pgfcore.sty" 1288312291 410 5bf12ea7330e5f12c445332a4fe9a263 ""
  "/usr/share/texlive/texmf-dist/tex/latex/pgf/compatibility/pgfcomp-version-0-65.sty" 1546728038 21013 e98e1aaaf40d31632787c2bd25d24b57 ""
  "/usr/share/texlive/texmf-dist/tex/latex/pgf/compatibility/pgfcomp-version-1-18.sty" 1546728038 989 2cf3da8e8ec55131c49389428d565e37 ""
  "/usr/share/texlive/texmf-dist/tex/latex/pgf/frontendlayer/tikz.sty" 1203877327 339 592cf35cba3d400082b8a9a5d0199d70 ""
  "/usr/share/texlive/texmf-dist/tex/latex/pgf/math/pgfmath.sty" 1393459310 306 0796eafca5e159e6ec2167a6d22d81b1 ""
  "/usr/share/texlive/texmf-dist/tex/latex/pgf/systemlayer/pgfsys.sty" 1393459310 443 0b2e781830192df35c0fd357cf13e26e ""
  "/usr/share/texlive/texmf-dist/tex/latex/pgf/utilities/pgffor.sty" 1393459310 348 8927fde343487e003b01a4c2ca34073b ""
  "/usr/share/texlive/texmf-dist/tex/latex/pgf/utilities/pgfkeys.sty" 1203727794 274 4cad6e665cc93ac2ac979039a94fa1e1 ""
  "/usr/share/texlive/texmf-dist/tex/latex/pgf/utilities/pgfrcs.sty" 1203877327 325 2bcd023400636339210573e2b3ee298b ""
  "/usr/share/texlive/texmf-dist/tex/latex/ragged2e/ragged2e.sty" 1564521318 9974 f2895af67a8ceb11ae60d6efbed7dc62 ""
  "/usr/share/texlive/texmf-dist/tex/latex/refcount/refcount.sty" 1576624809 9878 9e94e8fa600d95f9c7731bb21dfb67a4 ""
  "/usr/share/texlive/texmf-dist/tex/latex/rerunfilecheck/rerunfilecheck.sty" 1575674187 9715 b051d5b493d9fe5f4bc251462d039e5f ""
  "/usr/share/texlive/texmf-dist/tex/latex/siunitx/siunitx-abbreviations.cfg" 1579124948 4745 793d4d5a808c37a7085f620706b56fe1 ""
  "/usr/share/texlive/texmf-dist/tex/latex/siunitx/siunitx.sty" 1579124948 277221 4016d94a4b6827ec1ad2f76abfb692bc ""
  "/usr/share/texlive/texmf-dist/tex/latex/threeparttable/threeparttable.sty" 1267981840 13506 a4e71a27db1a69b6fabada5beebf0844 ""
  "/usr/share/texlive/texmf-dist/tex/latex/tools/array.sty" 1580683321 12560 ce3f59ceae9d9a27bfe037d6bf1d903c ""
  "/usr/share/texlive/texmf-dist/tex/latex/tools/longtable.sty" 1580683321 12133 b1e3e65b69714dbfcc5e6c0b19d66b50 ""
  "/usr/share/texlive/texmf-dist/tex/latex/tools/tabularx.sty" 1580683321 7148 4ba718200276533b3a293c311a9349e0 ""
  "/usr/share/texlive/texmf-dist/tex/latex/translator/translator-basic-dictionary-English.dict" 1512078926 3435 0a4d096dde3f8fe682c2aedd33b8137d ""
  "/usr/share/texlive/texmf-dist/tex/latex/translator/translator.sty" 1559339174 8691 e154b4b39c7cd1cfa9301a391c44afdd ""
  "/usr/share/texlive/texmf-dist/tex/latex/url/url.sty" 1388531844 12796 8edb7d69a20b857904dd0ea757c14ec9 ""
  "/usr/share/texlive/texmf-dist/tex/latex/varwidth/varwidth.sty" 1238697683 10894 d359a13923460b2a73d4312d613554c8 ""
  "/usr/share/texlive/texmf-dist/tex/latex/xcolor/xcolor.sty" 1463002160 55589 34128738f682d033422ca125f82e5d62 ""
  "/usr/share/texlive/texmf-dist/tex/latex/xkeyval/xkeyval.sty" 1417732693 4962 9c1069474ff71dbc47d5006555e352d3 ""
  "/usr/share/texlive/texmf-dist/web2c/texmf.cnf" 1581979058 38841 ce3692aa899bb693b90b87eaa5d4d84e ""
  "/usr/share/texmf/fonts/enc/dvips/lm/lm-mathit.enc" 1254938640 2405 5dcf2c1b967ee25cc46c58cd52244aed ""
  "/usr/share/texmf/fonts/enc/dvips/lm/lm-mathsy.enc" 1254938640 2840 216e6e45ad352e2456e1149f28885bee ""
  "/usr/share/texmf/fonts/enc/dvips/lm/lm-rm.enc" 1254938640 2327 9d6df24f9c4f7368395224341a95523a ""
  "/usr/share/texmf/fonts/enc/dvips/lm/lm-rmsc.enc" 1254938640 2355 3e74b90173fc699673a5163cee277702 ""
  "/usr/share/texmf/fonts/enc/dvips/lm/lm-rmtt.enc" 1254938640 2359 de53213020575850c8f8debc35095765 ""
  "/usr/share/texmf/fonts/enc/dvips/lm/lm-ts1.enc" 1254938640 3031 6c4d3515bf7115d8518af1c9ab97ca44 ""
  "/usr/share/texmf/fonts/tfm/public/lm/lmex10.tfm" 1254938640 992 ce925c9346c7613270a79afbee98c070 ""
  "/usr/share/texmf/fonts/tfm/public/lm/lmmi10.tfm" 1254938640 1528 6d36b2385e0ca062a654de6ac59cb34f ""
  "/usr/share/texmf/fonts/tfm/public/lm/lmmi12.tfm" 1254938640 1524 753b192b18f2991794f9d41a8228510b ""
  "/usr/share/texmf/fonts/tfm/public/lm/lmmi5.tfm" 1254938640 1508 198f5b7b99b5769126de3a533f6fc334 ""
  "/usr/share/texmf/fonts/tfm/public/lm/lmmi6.tfm" 1254938640 1512 94a3fd88c6f27dbd9ecb46987e297a4e ""
  "/usr/share/texmf/fonts/tfm/public/lm/lmmi7.tfm" 1254938640 1528 d5b028dd23da623848ef0645c96a1ed7 ""
  "/usr/share/texmf/fonts/tfm/public/lm/lmmi8.tfm" 1254938640 1520 a3fe5596932db2db2cbda300920dd4e9 ""
  "/usr/share/texmf/fonts/tfm/public/lm/lmsy10.tfm" 1254938640 1308 02cc510f9dd6012e5815d0c0ffbf6869 ""
  "/usr/share/texmf/fonts/tfm/public/lm/lmsy5.tfm" 1254938640 1296 54ed1a711e2303d5282575278e3620b0 ""
  "/usr/share/texmf/fonts/tfm/public/lm/lmsy6.tfm" 1254938640 1300 b0605d44c16c22d99dc001808e4f24ea ""
  "/usr/share/texmf/fonts/tfm/public/lm/lmsy7.tfm" 1254938640 1304 32f22a15acc296b2a4e15698403dcb88 ""
  "/usr/share/texmf/fonts/tfm/public/lm/lmsy8.tfm" 1254938640 1304 cdc9a17df9ef0d2dc320eff37bbab1c4 ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmbx10.tfm" 1254938640 11880 35fcf136a2198418dfc53c83e9e2a07f ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmbx12.tfm" 1254938640 11880 ea60d06924270684e6f852f3141c992b ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmbxi10.tfm" 1254938640 17000 ee24f610e440d069ed0693c37a39a025 ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmcsc10.tfm" 1254938640 11088 74137ed57ef5d28227a6f78692896bed ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmr10.tfm" 1254938640 11868 4f81e9b6033c032bdaf9884f4d7ef412 ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmr12.tfm" 1254938640 11888 6841b91e46b65cf41a49b160e6e74130 ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmr17.tfm" 1254938640 11948 fa976674f030491ad35532a8a1e37325 ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmr5.tfm" 1254938640 11804 aefb10c002e6492c25236524a447f969 ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmr6.tfm" 1254938640 11836 e3b6ce3e601aec94f64a536e7f4224d5 ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmr7.tfm" 1254938640 11852 5a9022f105fd1ee2797df861e79ae9a0 ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmr8.tfm" 1254938640 11864 309fd7f43e4a0ba39f6f7644d76e8edf ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmri10.tfm" 1254938640 16968 1b588d0f410bd67a83eaecf8c64b2a43 ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmri8.tfm" 1254938640 16976 7228e7c7bc486e2318fc496e0de33875 ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmro10.tfm" 1254938640 12016 5fd5ddca8271bb43b0a1d696493463db ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmss10.tfm" 1254938640 10976 59d4d2acacc56ba9abc92645023932ec ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmss12.tfm" 1254938640 11024 7a83ae8920360cd8bd5d0289069119dc ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmss8.tfm" 1254938640 10976 d5243dcaf5ba5ee7825c8438c6b7a7ea ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmtk10.tfm" 1254938640 1336 cd5d5949a1a8258ba2142355fab78e6f ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmtt10.tfm" 1254938640 1340 adaa94f9add991a099a6fc98bbb5f02c ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmtt12.tfm" 1254938640 1336 3f1d3798f35e35601b79a222d795ee97 ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmtt8.tfm" 1254938640 1348 e9ce72e654d76f23fb9e1b8842e0576a ""
  "/usr/share/texmf/fonts/tfm/public/lm/rm-lmtti10.tfm" 1254938640 1340 7042fba54e6301adc4002664af965e60 ""
  "/usr/share/texmf/fonts/tfm/public/lm/ts1-lmr10.tfm" 1254938640 1556 b86d923e6b2f9aab2e313098a95cb0b8 ""
  "/usr/share/texmf/fonts/tfm/public/lm/ts1-lmri10.tfm" 1254938640 1764 bd63b6aa2f40108e63ad65c1421568c6 ""
  "/usr/share/texmf/fonts/tfm/public/lm/ts1-lmtt8.tfm" 1254938640 1320 73ec22b35fea352b761e2a3baa7af759 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmbx10.pfb" 1254938640 121021 1bf809ce4a594679006bd72263eba59b ""
  "/usr/share/texmf/fonts/type1/public/lm/lmbx12.pfb" 1254938640 116908 1fca96723793882c2e0160350c192fc8 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmbxi10.pfb" 1254938640 112766 bdd4fa8b13a0d7dd137624085bd31d40 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmcsc10.pfb" 1254938640 116427 4a5b1ccaa7cce719091920a86b58608d ""
  "/usr/share/texmf/fonts/type1/public/lm/lmmi10.pfb" 1254938640 30388 702fae6a5f0e6e9c48a1d872b442ffcf ""
  "/usr/share/texmf/fonts/type1/public/lm/lmmi12.pfb" 1254938640 30696 2654571912f9cd384da9f7cb8a60c568 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmr10.pfb" 1254938640 119235 f35b44530a1d90eb90fe15d9cba67ea0 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmr12.pfb" 1254938640 113634 f99c44d58bae0863375faf0e1d74d612 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmr5.pfb" 1254938640 120387 212cad1e763d510fc9c3ce2466274a57 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmr6.pfb" 1254938640 123394 d390152bb30feeb496aaaa93299ee9ba ""
  "/usr/share/texmf/fonts/type1/public/lm/lmr7.pfb" 1254938640 121145 68312a933e2c689ed40ec0aba373e279 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmr8.pfb" 1254938640 122174 a7a08406857c9530a0320a2517f60370 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmri10.pfb" 1254938640 112593 fda2373ba4420af33949610de4c28fe8 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmri8.pfb" 1254938640 109952 3dd76c0c5c680d519bb6d59a066c0826 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmro10.pfb" 1254938640 131205 e6b9f0f008cce138627a5f401db34a3b ""
  "/usr/share/texmf/fonts/type1/public/lm/lmsy10.pfb" 1254938640 27863 09ce3735688ffde955e72da27c95b61a ""
  "/usr/share/texmf/fonts/type1/public/lm/lmtk10.pfb" 1254938640 117319 7f8361f845845ce6d5b36cbd9f9cf377 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmtt10.pfb" 1254938640 113227 1010e11451afc2822c95dae77c390042 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmtt8.pfb" 1254938640 115291 2ae7034c644e971beb573b1e6606f863 ""
  "/usr/share/texmf/fonts/type1/public/lm/lmtti10.pfb" 1254938640 98822 859130196f7a6d2d1173200c66afbcff ""
  "/usr/share/texmf/tex/latex/lm/lmodern.sty" 1256929440 1606 c17281c7cff2bbd7ff0173e1433487ec ""
  "/usr/share/texmf/tex/latex/lm/omllmm.fd" 1256929440 888 44447a3a3af84a22454ef89500942d93 ""
  "/usr/share/texmf/tex/latex/lm/omllmr.fd" 1256929440 1014 b44f996e1fb8d1548178b60325f9547d ""
  "/usr/share/texmf/tex/latex/lm/omslmsy.fd" 1256929440 805 af340a8260c447aa315cfc740ff0152f ""
  "/usr/share/texmf/tex/latex/lm/omxlmex.fd" 1256929440 566 a94661f7b66063f191960bb7935b6ba2 ""
  "/usr/share/texmf/tex/latex/lm/ot1lmr.fd" 1256929440 1880 bae7b659316f7344a86218ad38b01d91 ""
  "/usr/share/texmf/tex/latex/lm/ot1lmss.fd" 1256929440 1655 27274ffd69942383838a2081fd5be3d1 ""
  "/usr/share/texmf/tex/latex/lm/ot1lmtt.fd" 1256929440 2712 a8a977c98484ccc2dbc768e5509e3790 ""
  "/usr/share/texmf/tex/latex/lm/ts1lmr.fd" 1256929440 1912 6435298ac30b512714b02d4c8c9e923c ""
  "/usr/share/texmf/tex/latex/lm/ts1lmtt.fd" 1256929440 2738 60cde6308634ac88dfb85e181fc1b345 ""
  "/usr/share/texmf/web2c/texmf.cnf" 1581979058 38841 ce3692aa899bb693b90b87eaa5d4d84e ""
  "/var/lib/texmf/fonts/map/pdftex/updmap/pdftex.map" 1747636751 4770781 1ed1abab22da9c3e2cc82e4db562318b ""
  "/var/lib/texmf/web2c/pdftex/pdflatex.fmt" 1747636791 8261603 1c85122e359aa323074522c22efd9c61 ""
  "Imagenes/4CornerModel.pdf" 1750672384 63582 89f14148bcb0ddd1c620ebb2c29615a8 ""
  "Imagenes/CU01.pdf" 1750259771 22206 d857f8d742d5cb5ce5c17c68e8b5c0ab ""
  "Imagenes/CU02.pdf" 1750260145 20397 51e41521b4a116d720a8d4e395984fff ""
  "Imagenes/DiagComp.pdf" 1750267318 19660 92b7a76306add23d4295c15c0b5aa27c ""
  "Imagenes/DiagEstado.pdf" 1750270172 14418 f3c47c8a1c84d0e9912d2e4269f39568 ""
  "Imagenes/ER.pdf" 1750263467 15527 df62377381215d9a25f54718e1df6948 ""
  "Imagenes/Flujo.png" 1747643727 152127 0e5e6db490066f1b617b658ca73e4c12 ""
  "Imagenes/LayerComp.png" 1747657663 248665 f17096a60763ce57bbf5942256f1867d ""
  "Imagenes/MiAPITFG.png" 1747988117 79719 e3feaae3e447abb63f475cbd8c1fd7a8 ""
  "Imagenes/RunResults.png" 1747988364 20500 6a6c7a65697b8d645b774fec326941c1 ""
  "Imagenes/Universidad-de-Valladolid.png" 1747463500 377181 e5435b42191d958792aa7e62566b8e6f ""
  "Imagenes/baseURL.png" 1747986371 10399 1a8576f9ba99e37844505f67c2a5a7bf ""
  "Imagenes/crearActor.png" 1747986519 30151 cea6e5961f667dcde3334d4c44aeb523 ""
  "Imagenes/crearActorResponse.png" 1747986547 19374 79698f32debff36fe201779d1fd6cd30 ""
  "Imagenes/crearRTP.png" 1747986742 34915 20940f47edc2019bb72eb31f007c26a2 ""
  "Imagenes/crearRTPResponse.png" 1747986767 18927 dc74c256f756eddf6fec9a87ebf39782 ""
  "Imagenes/decision.png" 1747986931 29353 931c2c903762f76a801285aa27d94d1d ""
  "Imagenes/decisionResponse.png" 1747986943 17816 f1a17eb47bf00d620e35837c6f12cba9 ""
  "Imagenes/enrutarBenef.png" 1747986849 27268 83188c502760eb8998319c7cbb007a55 ""
  "Imagenes/enrutarBenefResponse.png" 1747986864 18036 26e7108636158c956c6fc17e32bf276e ""
  "Imagenes/error1.png" 1748163488 53506 85d71e10ed095b67e816db40c75d1c1c ""
  "Imagenes/error2_1.png" 1748163963 53865 b302d8ea7e560808a2703eccbccc04a3 ""
  "Imagenes/error2_2.png" 1748163979 47626 c988dee8bbb0dccee5955d9761f0a305 ""
  "Imagenes/error3.png" 1748164137 52268 2348fb47442b6c7a4ba067a1833ce26e ""
  "Imagenes/esq1.png" 1747666064 1818098 bb5a6525b0bdce0ae368e284c128c047 ""
  "Imagenes/treeB.pdf" 1750320739 26930 ad24ca3ae294c6e7782454a2cc4f5c05 ""
  "Imagenes/validarBenef.png" 1747986804 29397 02aa851626586502fad7d183703edd33 ""
  "Imagenes/validarBenefResponse.png" 1747986820 17940 fbaa14c09f58920dc1401959f4717a34 ""
  "Imagenes/validarPayer.png" 1747986891 28865 88daa650bfba05b22fae65edf3cea0b5 ""
  "Imagenes/validarPayerResponse.png" 1747986908 17989 c0f84707a0cc7dcb5f7c1af5ea5eb29b ""
  "main.aux" 1751295695 28379 22fffcd74303d154b982a9b2f351ad7e "pdflatex"
  "main.bbl" 1750745654 28603 76a5cc463c2ecd6b7b432d14d613f816 "biber main"
  "main.lof" 1751295696 3174 4bba4540511753d1bc17497071933005 "pdflatex"
  "main.lol" 1751295696 2378 bd21821faabba92776961e819a1d6ac2 "pdflatex"
  "main.lot" 1751295696 966 0ae482d7298cd897e7df7a5ca882a2e9 "pdflatex"
  "main.out" 1751295696 4016 1d44fee8b3f3414a352065946ac85dff "pdflatex"
  "main.run.xml" 1751295696 2344 9e226b29ec5b0ada463b1b8ae1dd73d9 "pdflatex"
  "main.tex" 1751294368 6790 2c64d184898721d0abdd54185b80f9b2 ""
  "main.toc" 1751295696 5399 4748d7a5e1695e1d30d310494c30aa8f "pdflatex"
  "src/agradecimientos.tex" 1751294085 692 14596afbcda21763caedd6dfe56e0c23 ""
  "src/codigos.tex" 1751295186 3917 05a8a62097bd6367ae5543f89ee834f5 ""
  "src/conclusiones.tex" 1751293062 4990 8b7290ddb67059837135b313ca2b771a ""
  "src/diseño.tex" 1751295690 34553 d82573b6f137592114e53bab35c091e9 ""
  "src/estado_arte.tex" 1751295033 36743 4c7319c4244147da47de7ac5f6aa476f ""
  "src/implementacion.tex" 1751293103 48219 7bf95f9418f89085de0726da8caa4060 ""
  "src/introduccion.tex" 1751293103 18805 929bec729657fba3ca69797df91c2aa8 ""
  "src/resumen.tex" 1751293062 2816 f1aace894187449e10aec407f587e9c3 ""
  "src/validacion.tex" 1751293092 10274 0b9efb2634fb491aab4fe817f8dfc16f ""
  (generated)
  "main.pdf"
  "main.lot"
  "main.out"
  "main.run.xml"
  "main.toc"
  "main.lol"
  "main.bcf"
  "main.aux"
  "main.log"
  "main.lof"


# END FILE CONTENTS


# File: MemoriaTFG/main.fls

PWD /home/alonso/SEPA_RTP/MemoriaTFG
INPUT /etc/texmf/web2c/texmf.cnf
INPUT /usr/share/texmf/web2c/texmf.cnf
INPUT /usr/share/texlive/texmf-dist/web2c/texmf.cnf
INPUT /var/lib/texmf/web2c/pdftex/pdflatex.fmt
INPUT /home/alonso/SEPA_RTP/MemoriaTFG/main.tex
OUTPUT main.log
INPUT /usr/share/texlive/texmf-dist/tex/latex/base/book.cls
INPUT /usr/share/texlive/texmf-dist/tex/latex/base/book.cls
INPUT /usr/share/texlive/texmf-dist/tex/latex/base/bk10.clo
INPUT /usr/share/texlive/texmf-dist/tex/latex/base/bk10.clo
INPUT /usr/share/texlive/texmf-dist/tex/latex/ragged2e/ragged2e.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/ragged2e/ragged2e.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/ms/everysel.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/ms/everysel.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics/graphicx.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics/graphicx.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics/keyval.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics/keyval.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics/graphics.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics/graphics.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics/trig.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics/trig.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics-cfg/graphics.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics-cfg/graphics.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics-def/pdftex.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics-def/pdftex.def
INPUT /usr/share/texlive/texmf-dist/tex/generic/babel/babel.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/babel/babel.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/babel/switch.def
INPUT /usr/share/texlive/texmf-dist/tex/generic/babel-spanish/spanish.ldf
INPUT /usr/share/texlive/texmf-dist/tex/generic/babel-spanish/spanish.ldf
INPUT /usr/share/texlive/texmf-dist/tex/generic/babel/babel.def
INPUT /usr/share/texlive/texmf-dist/tex/generic/babel/txtbabel.def
INPUT /usr/share/texlive/texmf-dist/tex/generic/babel-english/english.ldf
INPUT /usr/share/texlive/texmf-dist/tex/generic/babel-english/english.ldf
INPUT /usr/share/texlive/texmf-dist/tex/latex/hyperref/hyperref.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/hyperref/hyperref.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/ltxcmds/ltxcmds.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/ltxcmds/ltxcmds.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/iftex/iftex.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/iftex/iftex.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pdftexcmds/pdftexcmds.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pdftexcmds/pdftexcmds.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/infwarerr/infwarerr.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/infwarerr/infwarerr.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/kvsetkeys/kvsetkeys.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/kvsetkeys/kvsetkeys.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/kvdefinekeys/kvdefinekeys.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/kvdefinekeys/kvdefinekeys.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/pdfescape/pdfescape.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/pdfescape/pdfescape.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/hycolor/hycolor.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/hycolor/hycolor.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/letltxmacro/letltxmacro.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/letltxmacro/letltxmacro.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/auxhook/auxhook.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/auxhook/auxhook.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/kvoptions/kvoptions.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/kvoptions/kvoptions.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/hyperref/pd1enc.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/hyperref/pd1enc.def
INPUT /usr/share/texlive/texmf-dist/tex/generic/intcalc/intcalc.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/intcalc/intcalc.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/etexcmds/etexcmds.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/etexcmds/etexcmds.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/url/url.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/url/url.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/bitset/bitset.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/bitset/bitset.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/bigintcalc/bigintcalc.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/bigintcalc/bigintcalc.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/atbegshi/atbegshi.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/atbegshi/atbegshi.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/hyperref/hpdftex.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/hyperref/hpdftex.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/atveryend/atveryend.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/atveryend/atveryend.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/rerunfilecheck/rerunfilecheck.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/rerunfilecheck/rerunfilecheck.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/uniquecounter/uniquecounter.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/uniquecounter/uniquecounter.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/biblatex.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/biblatex.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/etoolbox/etoolbox.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/etoolbox/etoolbox.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/logreq/logreq.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/logreq/logreq.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/logreq/logreq.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/logreq/logreq.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/base/ifthen.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/base/ifthen.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/blx-dm.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/blx-dm.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/blx-compat.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/blx-compat.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/biblatex.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/biblatex.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/bbx/alphabetic.bbx
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/bbx/alphabetic.bbx
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/bbx/standard.bbx
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/bbx/standard.bbx
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/cbx/alphabetic.cbx
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/cbx/alphabetic.cbx
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/biblatex.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/biblatex.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/lbx/spanish.lbx
INPUT /usr/share/texlive/texmf-dist/tex/latex/makecell/makecell.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/makecell/makecell.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/tools/array.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/tools/array.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/listings/listings.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/listings/listings.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/listings/lstmisc.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/listings/lstmisc.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/listings/listings.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/listings/listings.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics/color.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics/color.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics-cfg/color.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics-cfg/color.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/enumitem/enumitem.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/enumitem/enumitem.sty
INPUT /usr/share/texmf/tex/latex/lm/lmodern.sty
INPUT /usr/share/texmf/tex/latex/lm/lmodern.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/microtype/microtype.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/microtype/microtype.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/microtype/microtype-pdftex.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/microtype/microtype-pdftex.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/microtype/microtype.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/microtype/microtype.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/microtype/microtype.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/float/float.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/float/float.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/tools/tabularx.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/tools/tabularx.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/siunitx/siunitx.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/siunitx/siunitx.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/l3kernel/expl3.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/l3kernel/expl3.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/l3backend/l3backend-pdfmode.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/l3backend/l3backend-pdfmode.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/l3packages/xparse/xparse.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/l3packages/xparse/xparse.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/amsmath/amstext.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/amsmath/amstext.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/amsmath/amsgen.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/amsmath/amsgen.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/l3packages/l3keys2e/l3keys2e.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/l3packages/l3keys2e/l3keys2e.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/translator/translator.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/translator/translator.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/translator/translator.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/booktabs/booktabs.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/booktabs/booktabs.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/mdwtools/footnote.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/mdwtools/footnote.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/base/inputenc.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/base/inputenc.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/threeparttable/threeparttable.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/threeparttable/threeparttable.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/frontendlayer/tikz.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/frontendlayer/tikz.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/basiclayer/pgf.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/basiclayer/pgf.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/utilities/pgfrcs.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/utilities/pgfrcs.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfutil-common.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfutil-common-lists.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfutil-latex.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/ms/everyshi.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/ms/everyshi.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfrcs.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfrcs.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/pgf.revision.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/pgf.revision.tex
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/basiclayer/pgfcore.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/basiclayer/pgfcore.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/systemlayer/pgfsys.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/systemlayer/pgfsys.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsys.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsys.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfkeys.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfkeysfiltered.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgf.cfg
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsys-pdftex.def
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsys-pdftex.def
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsys-common-pdf.def
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsyssoftpath.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsyssoftpath.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsysprotocol.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/systemlayer/pgfsysprotocol.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/latex/xcolor/xcolor.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/xcolor/xcolor.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics-cfg/color.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/graphics-cfg/color.cfg
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcore.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcore.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmath.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathcalc.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathutil.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathparser.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.basic.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.trigonometric.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.random.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.comparison.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.base.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.round.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.misc.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfunctions.integerarithmetics.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmathfloat.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfint.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorepoints.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorepathconstruct.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorepathusage.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorescopes.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoregraphicstate.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoretransformations.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorequick.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoreobjects.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorepathprocessing.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorearrows.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoreshade.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoreimage.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoreexternal.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorelayers.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcoretransparency.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorepatterns.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/basiclayer/pgfcorerdf.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/modules/pgfmoduleshapes.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/modules/pgfmoduleplot.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/compatibility/pgfcomp-version-0-65.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/compatibility/pgfcomp-version-0-65.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/compatibility/pgfcomp-version-1-18.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/compatibility/pgfcomp-version-1-18.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/utilities/pgffor.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/utilities/pgffor.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/utilities/pgfkeys.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/utilities/pgfkeys.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfkeys.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgfkeys.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/math/pgfmath.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/pgf/math/pgfmath.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmath.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmath.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgffor.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/utilities/pgffor.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/math/pgfmath.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/frontendlayer/tikz/tikz.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/frontendlayer/tikz/tikz.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/libraries/pgflibraryplothandlers.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/libraries/pgflibraryplothandlers.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/modules/pgfmodulematrix.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/frontendlayer/tikz/libraries/tikzlibrarytopaths.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/pgf/frontendlayer/tikz/libraries/tikzlibrarytopaths.code.tex
INPUT /usr/share/texlive/texmf-dist/tex/latex/footmisc/footmisc.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/footmisc/footmisc.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/adjustbox/adjustbox.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/adjustbox/adjustbox.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/xkeyval/xkeyval.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/xkeyval/xkeyval.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/xkeyval/xkeyval.tex
INPUT /usr/share/texlive/texmf-dist/tex/generic/xkeyval/xkvutils.tex
INPUT /usr/share/texlive/texmf-dist/tex/latex/adjustbox/adjcalc.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/adjustbox/adjcalc.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/adjustbox/trimclip.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/adjustbox/trimclip.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/collectbox/collectbox.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/collectbox/collectbox.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/adjustbox/tc-pdftex.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/adjustbox/tc-pdftex.def
INPUT /usr/share/texlive/texmf-dist/tex/latex/ifoddpage/ifoddpage.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/ifoddpage/ifoddpage.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/ifoddpage/ifoddpage.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/varwidth/varwidth.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/varwidth/varwidth.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/varwidth/varwidth.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/acronym/acronym.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/acronym/acronym.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/bigfoot/suffix.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/bigfoot/suffix.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/xstring/xstring.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/xstring/xstring.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/xstring/xstring.tex
INPUT /usr/share/texlive/texmf-dist/tex/latex/tools/longtable.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/tools/longtable.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/geometry/geometry.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/geometry/geometry.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/iftex/ifvtex.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/iftex/ifvtex.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/lipsum/lipsum.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/lipsum/lipsum.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/lipsum/lipsum.ltd.tex
INPUT /usr/share/texlive/texmf-dist/tex/latex/lipsum/lipsum.ltd.tex
INPUT main.aux
INPUT main.aux
OUTPUT main.aux
INPUT /usr/share/texmf/tex/latex/lm/ot1lmr.fd
INPUT /usr/share/texmf/tex/latex/lm/ot1lmr.fd
INPUT /usr/share/texlive/texmf-dist/fonts/map/fontname/texfonts.map
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmr10.tfm
INPUT /usr/share/texlive/texmf-dist/tex/context/base/mkii/supp-pdf.mkii
INPUT /usr/share/texlive/texmf-dist/tex/context/base/mkii/supp-pdf.mkii
INPUT /usr/share/texlive/texmf-dist/tex/latex/epstopdf-pkg/epstopdf-base.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/epstopdf-pkg/epstopdf-base.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/latexconfig/epstopdf-sys.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/latexconfig/epstopdf-sys.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/hyperref/nameref.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/hyperref/nameref.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/refcount/refcount.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/refcount/refcount.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/gettitlestring/gettitlestring.sty
INPUT /usr/share/texlive/texmf-dist/tex/generic/gettitlestring/gettitlestring.sty
INPUT main.out
INPUT main.out
INPUT main.out
INPUT main.out
OUTPUT main.pdf
INPUT ./main.out
INPUT ./main.out
OUTPUT main.out
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/lbx/english.lbx
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/lbx/english.lbx
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/lbx/spanish.lbx
INPUT /usr/share/texlive/texmf-dist/tex/latex/biblatex/lbx/spanish.lbx
OUTPUT main.bcf
INPUT main.bbl
INPUT main.bbl
INPUT main.bbl
INPUT /usr/share/texlive/texmf-dist/tex/latex/microtype/mt-cmr.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/microtype/mt-cmr.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/translator/translator-basic-dictionary-English.dict
INPUT /usr/share/texlive/texmf-dist/tex/latex/translator/translator-basic-dictionary-English.dict
INPUT /usr/share/texlive/texmf-dist/tex/latex/siunitx/siunitx-abbreviations.cfg
INPUT /usr/share/texlive/texmf-dist/tex/latex/siunitx/siunitx-abbreviations.cfg
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmr7.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmr5.tfm
INPUT /usr/share/texmf/tex/latex/lm/omllmm.fd
INPUT /usr/share/texmf/tex/latex/lm/omllmm.fd
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmmi10.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmmi7.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmmi5.tfm
INPUT /usr/share/texmf/tex/latex/lm/omslmsy.fd
INPUT /usr/share/texmf/tex/latex/lm/omslmsy.fd
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmsy10.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmsy7.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmsy5.tfm
INPUT /usr/share/texmf/tex/latex/lm/omxlmex.fd
INPUT /usr/share/texmf/tex/latex/lm/omxlmex.fd
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmex10.tfm
INPUT /usr/share/texmf/tex/latex/lm/ot1lmss.fd
INPUT /usr/share/texmf/tex/latex/lm/ot1lmss.fd
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmss10.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmss8.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmss8.tfm
INPUT /usr/share/texmf/tex/latex/lm/ot1lmtt.fd
INPUT /usr/share/texmf/tex/latex/lm/ot1lmtt.fd
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmtt10.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmtt8.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmtt8.tfm
INPUT Imagenes/Universidad-de-Valladolid.png
INPUT ./Imagenes/Universidad-de-Valladolid.png
INPUT ./Imagenes/Universidad-de-Valladolid.png
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmbx10.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmbx12.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmbxi10.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmbxi10.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmcsc10.tfm
INPUT /var/lib/texmf/fonts/map/pdftex/updmap/pdftex.map
INPUT src/agradecimientos.tex
INPUT src/agradecimientos.tex
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmr17.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmbx12.tfm
INPUT src/resumen.tex
INPUT src/resumen.tex
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmri10.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmro10.tfm
INPUT main.toc
INPUT main.toc
OUTPUT main.toc
INPUT src/introduccion.tex
INPUT src/introduccion.tex
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmr17.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmbx12.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmr12.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmr12.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmbx12.tfm
INPUT /usr/share/texmf/tex/latex/lm/ts1lmr.fd
INPUT /usr/share/texmf/tex/latex/lm/ts1lmr.fd
INPUT /usr/share/texmf/fonts/tfm/public/lm/ts1-lmr10.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmr8.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmr6.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmmi8.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmmi6.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmsy8.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmsy6.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmss8.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmss8.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmtt8.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmtt8.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmri8.tfm
INPUT src/estado_arte.tex
INPUT src/estado_arte.tex
INPUT /usr/share/texmf/fonts/tfm/public/lm/ts1-lmri10.tfm
INPUT Imagenes/4CornerModel.pdf
INPUT ./Imagenes/4CornerModel.pdf
INPUT ./Imagenes/4CornerModel.pdf
INPUT Imagenes/Flujo.png
INPUT ./Imagenes/Flujo.png
INPUT ./Imagenes/Flujo.png
INPUT Imagenes/esq1.png
INPUT ./Imagenes/esq1.png
INPUT ./Imagenes/esq1.png
INPUT Imagenes/LayerComp.png
INPUT ./Imagenes/LayerComp.png
INPUT ./Imagenes/LayerComp.png
INPUT src/diseño.tex
INPUT src/diseño.tex
INPUT Imagenes/CU01.pdf
INPUT ./Imagenes/CU01.pdf
INPUT ./Imagenes/CU01.pdf
INPUT Imagenes/CU02.pdf
INPUT ./Imagenes/CU02.pdf
INPUT ./Imagenes/CU02.pdf
INPUT Imagenes/ER.pdf
INPUT ./Imagenes/ER.pdf
INPUT ./Imagenes/ER.pdf
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmtti10.tfm
INPUT Imagenes/DiagComp.pdf
INPUT ./Imagenes/DiagComp.pdf
INPUT ./Imagenes/DiagComp.pdf
INPUT Imagenes/DiagEstado.pdf
INPUT ./Imagenes/DiagEstado.pdf
INPUT ./Imagenes/DiagEstado.pdf
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmtk10.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmbxi10.tfm
INPUT src/implementacion.tex
INPUT src/implementacion.tex
INPUT Imagenes/treeB.pdf
INPUT ./Imagenes/treeB.pdf
INPUT ./Imagenes/treeB.pdf
INPUT /usr/share/texmf/tex/latex/lm/omllmr.fd
INPUT /usr/share/texmf/tex/latex/lm/omllmr.fd
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmmi12.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/lmsy10.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmss12.tfm
INPUT /usr/share/texmf/fonts/tfm/public/lm/rm-lmtt12.tfm
INPUT src/validacion.tex
INPUT src/validacion.tex
INPUT Imagenes/baseURL.png
INPUT ./Imagenes/baseURL.png
INPUT ./Imagenes/baseURL.png
INPUT Imagenes/crearActor.png
INPUT ./Imagenes/crearActor.png
INPUT ./Imagenes/crearActor.png
INPUT Imagenes/crearActorResponse.png
INPUT ./Imagenes/crearActorResponse.png
INPUT ./Imagenes/crearActorResponse.png
INPUT Imagenes/MiAPITFG.png
INPUT ./Imagenes/MiAPITFG.png
INPUT ./Imagenes/MiAPITFG.png
INPUT Imagenes/RunResults.png
INPUT ./Imagenes/RunResults.png
INPUT ./Imagenes/RunResults.png
INPUT Imagenes/crearRTP.png
INPUT ./Imagenes/crearRTP.png
INPUT ./Imagenes/crearRTP.png
INPUT Imagenes/crearRTPResponse.png
INPUT ./Imagenes/crearRTPResponse.png
INPUT ./Imagenes/crearRTPResponse.png
INPUT Imagenes/validarBenef.png
INPUT ./Imagenes/validarBenef.png
INPUT ./Imagenes/validarBenef.png
INPUT Imagenes/validarBenefResponse.png
INPUT ./Imagenes/validarBenefResponse.png
INPUT ./Imagenes/validarBenefResponse.png
INPUT Imagenes/enrutarBenef.png
INPUT ./Imagenes/enrutarBenef.png
INPUT ./Imagenes/enrutarBenef.png
INPUT Imagenes/enrutarBenefResponse.png
INPUT ./Imagenes/enrutarBenefResponse.png
INPUT ./Imagenes/enrutarBenefResponse.png
INPUT Imagenes/validarPayer.png
INPUT ./Imagenes/validarPayer.png
INPUT ./Imagenes/validarPayer.png
INPUT Imagenes/validarPayerResponse.png
INPUT ./Imagenes/validarPayerResponse.png
INPUT ./Imagenes/validarPayerResponse.png
INPUT Imagenes/decision.png
INPUT ./Imagenes/decision.png
INPUT ./Imagenes/decision.png
INPUT Imagenes/decisionResponse.png
INPUT ./Imagenes/decisionResponse.png
INPUT ./Imagenes/decisionResponse.png
INPUT Imagenes/error1.png
INPUT ./Imagenes/error1.png
INPUT ./Imagenes/error1.png
INPUT Imagenes/error2_1.png
INPUT ./Imagenes/error2_1.png
INPUT ./Imagenes/error2_1.png
INPUT Imagenes/error2_2.png
INPUT ./Imagenes/error2_2.png
INPUT ./Imagenes/error2_2.png
INPUT Imagenes/error3.png
INPUT ./Imagenes/error3.png
INPUT ./Imagenes/error3.png
INPUT src/conclusiones.tex
INPUT src/conclusiones.tex
INPUT src/codigos.tex
INPUT src/codigos.tex
INPUT /usr/share/texlive/texmf-dist/tex/latex/listings/lstlang1.sty
INPUT /usr/share/texlive/texmf-dist/tex/latex/listings/lstlang1.sty
INPUT ../backend/services.py
INPUT ../backend/services.py
INPUT ../backend/services.py
INPUT ../backend/routes.py
INPUT ../backend/routes.py
INPUT ../backend/routes.py
INPUT ../frontend/RTP.js
INPUT ../frontend/RTP.js
INPUT ../frontend/RTP.js
INPUT ../backend/services.py
INPUT ../backend/services.py
INPUT ../backend/services.py
INPUT ../backend/routes.py
INPUT ../backend/routes.py
INPUT ../backend/routes.py
INPUT ../backend/utils.py
INPUT ../backend/utils.py
INPUT ../backend/utils.py
INPUT ../frontend/RTP.js
INPUT ../frontend/RTP.js
INPUT ../frontend/RTP.js
INPUT /usr/share/texmf/tex/latex/lm/ts1lmtt.fd
INPUT /usr/share/texmf/tex/latex/lm/ts1lmtt.fd
INPUT /usr/share/texmf/fonts/tfm/public/lm/ts1-lmtt8.tfm
INPUT ../backend/services.py
INPUT ../backend/services.py
INPUT ../backend/services.py
INPUT ../backend/routes.py
INPUT ../backend/routes.py
INPUT ../backend/routes.py
INPUT ../frontend/RTP.js
INPUT ../frontend/RTP.js
INPUT ../frontend/RTP.js
INPUT ../backend/services.py
INPUT ../backend/services.py
INPUT ../backend/services.py
INPUT ../backend/routes.py
INPUT ../backend/routes.py
INPUT ../backend/routes.py
INPUT ../frontend/RTP.js
INPUT ../frontend/RTP.js
INPUT ../frontend/RTP.js
INPUT ../backend/services.py
INPUT ../backend/services.py
INPUT ../backend/services.py
INPUT ../frontend/RTP.js
INPUT ../frontend/RTP.js
INPUT ../frontend/RTP.js
INPUT ../backend/utils.py
INPUT ../backend/utils.py
INPUT ../backend/utils.py
INPUT ../backend/models.py
INPUT ../backend/models.py
INPUT ../backend/models.py
INPUT ../backend/config.py
INPUT ../backend/config.py
INPUT ../backend/config.py
INPUT ../backend/requirements.txt
INPUT ../backend/requirements.txt
INPUT ../backend/requirements.txt
INPUT ../backend/app.py
INPUT ../backend/app.py
INPUT ../backend/app.py
INPUT ../backend/models.py
INPUT ../backend/models.py
INPUT ../backend/models.py
INPUT ../backend/models.py
INPUT ../backend/models.py
INPUT ../backend/models.py
INPUT ../backend/models.py
INPUT ../backend/models.py
INPUT ../backend/models.py
INPUT main.lof
INPUT main.lof
OUTPUT main.lof
INPUT main.lot
INPUT main.lot
OUTPUT main.lot
INPUT main.lol
INPUT main.lol
OUTPUT main.lol
INPUT main.aux
INPUT ./main.out
INPUT ./main.out
INPUT main.run.xml
OUTPUT main.run.xml
INPUT /usr/share/texmf/fonts/enc/dvips/lm/lm-ts1.enc
INPUT /usr/share/texmf/fonts/enc/dvips/lm/lm-rmtt.enc
INPUT /usr/share/texmf/fonts/enc/dvips/lm/lm-rm.enc
INPUT /usr/share/texmf/fonts/enc/dvips/lm/lm-mathit.enc
INPUT /usr/share/texmf/fonts/enc/dvips/lm/lm-mathsy.enc
INPUT /usr/share/texmf/fonts/enc/dvips/lm/lm-rmsc.enc
INPUT /usr/share/texlive/texmf-dist/fonts/type1/public/amsfonts/cm/cmmi10.pfb
INPUT /usr/share/texlive/texmf-dist/fonts/type1/public/amsfonts/cm/cmsy10.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmbx10.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmbx12.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmbxi10.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmcsc10.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmmi10.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmmi12.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmr10.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmr12.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmr5.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmr6.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmr7.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmr8.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmri10.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmri8.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmro10.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmsy10.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmtk10.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmtt10.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmtt8.pfb
INPUT /usr/share/texmf/fonts/type1/public/lm/lmtti10.pfb


# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/DIAGRAMA.svg

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="500px" preserveAspectRatio="none" style="width:505px;height:500px;background:#FFFFFF;" version="1.1" viewBox="0 0 505 500" width="505px" zoomAndPan="magnify"><defs/><g><!--cluster Prototipo SRTP--><g class="cluster" data-entity="Prototipo SRTP" data-source-line="1" data-uid="ent0002" id="cluster_Prototipo SRTP"><path d="M8.5,6 L129.2725,6 A3.75,3.75 0 0 1 131.7725,8.5 L138.7725,28.2969 L452.5,28.2969 A2.5,2.5 0 0 1 455,30.7969 L455,490.69 A2.5,2.5 0 0 1 452.5,493.19 L8.5,493.19 A2.5,2.5 0 0 1 6,490.69 L6,8.5 A2.5,2.5 0 0 1 8.5,6" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="138.7725" y1="28.2969" y2="28.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="119.7725" x="10" y="20.9951">Prototipo SRTP</text></g><!--entity Gateway REST--><g class="entity" data-entity="Gateway REST" data-source-line="4" data-uid="ent0003" id="entity_Gateway REST"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142.3066" x="239.85" y="41"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="362.1566" y="46"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="360.1566" y="48"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="360.1566" y="52"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102.3066" x="254.85" y="73.9951">Gateway REST</text></g><!--entity Service RTP--><g class="entity" data-entity="Service RTP" data-source-line="4" data-uid="ent0004" id="entity_Service RTP"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.9131" x="178.54" y="148.3"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="281.4531" y="153.3"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="279.4531" y="155.3"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="279.4531" y="159.3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.9131" x="193.54" y="181.2951">Service RTP</text></g><!--entity Base de Datos SQLite--><g class="entity" data-entity="Base de Datos SQLite" data-source-line="5" data-uid="ent0006" id="entity_Base de Datos SQLite"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="191.3477" x="22.33" y="289.6"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="193.6777" y="294.6"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="191.6777" y="296.6"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="191.6777" y="300.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.3477" x="37.33" y="322.5951">Base de Datos SQLite</text></g><!--entity Notification Hub--><g class="entity" data-entity="Notification Hub" data-source-line="6" data-uid="ent0008" id="entity_Notification Hub"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153.0664" x="248.47" y="289.6"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="381.5364" y="294.6"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="379.5364" y="296.6"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="379.5364" y="300.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.0664" x="263.47" y="322.5951">Notification Hub</text></g><!--entity Actores--><g class="entity" data-entity="Actores" data-source-line="7" data-uid="ent0010" id="entity_Actores"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92.9922" x="281.5" y="430.89"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="354.4922" y="435.89"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="352.4922" y="437.89"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="352.4922" y="441.89"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.9922" x="296.5" y="463.8851">Actores</text></g><!--link Gateway REST to Service RTP--><g class="link" data-entity-1="Gateway REST" data-entity-2="Service RTP" data-source-line="4" data-uid="lnk5" id="link_Gateway REST_Service RTP"><path d="M295.77,87.74 C283.79,105.51 270.5334,125.1646 258.5634,142.9246" fill="none" id="Gateway REST-to-Service RTP" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="255.21,147.9,263.557,142.6724,258.0045,143.7538,256.9231,138.2013,255.21,147.9" style="stroke:#181818;stroke-width:1;"/></g><!--link Service RTP to Base de Datos SQLite--><g class="link" data-entity-1="Service RTP" data-entity-2="Base de Datos SQLite" data-source-line="5" data-uid="lnk7" id="link_Service RTP_Base de Datos SQLite"><path d="M220.4,194.83 C197.63,220.82 164.2536,258.9368 141.5036,284.9068" fill="none" id="Service RTP-to-Base de Datos SQLite" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="137.55,289.42,146.4892,285.2859,140.8447,285.659,140.4716,280.0145,137.55,289.42" style="stroke:#181818;stroke-width:1;"/></g><!--link Service RTP to Notification Hub--><g class="link" data-entity-1="Service RTP" data-entity-2="Notification Hub" data-source-line="6" data-uid="lnk9" id="link_Service RTP_Notification Hub"><path d="M253.66,194.83 C269.52,220.82 292.4043,258.3285 308.2543,284.2985" fill="none" id="Service RTP-to-Notification Hub" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="311.38,289.42,310.1057,279.6539,308.7752,285.1521,303.277,283.8216,311.38,289.42" style="stroke:#181818;stroke-width:1;"/></g><!--link Notification Hub to Actores--><g class="link" data-entity-1="Notification Hub" data-entity-2="Actores" data-source-line="7" data-uid="lnk11" id="link_Notification Hub_Actores"><path d="M306.84,336.26 C300.9,344.99 295.04,355.4 292,365.89 C287.67,380.83 287.37,386.04 292,400.89 C295.31,411.5 298.0377,417.0393 304.4477,425.6893" fill="none" id="Notification Hub-to-Actores" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="308.02,430.51,305.8753,420.8975,305.0431,426.4928,299.4478,425.6606,308.02,430.51" style="stroke:#181818;stroke-width:1;"/></g><!--link Notification Hub to Actores--><g class="link" data-entity-1="Notification Hub" data-entity-2="Actores" data-source-line="16" data-uid="lnk13" id="link_Notification Hub_Actores"><path d="M324.64,336.32 C324.45,353.92 324.37,378.96 325,400.89 C325.28,410.59 325.4782,415.3015 326.0482,424.4815" fill="none" id="Notification Hub-to-Actores-1" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="326.42,430.47,329.8546,421.2394,326.1101,425.4796,321.8699,421.7352,326.42,430.47" style="stroke:#181818;stroke-width:1;"/><path d="M330,370.89 L330,395.89 L424,395.89 L424,380.89 L414,370.89 L330,370.89" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M414,370.89 L414,380.89 L424,380.89 L414,370.89" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73.0806" x="336" y="387.9569">WebSocket</text></g><!--link Gateway REST to Actores--><g class="link" data-entity-1="Gateway REST" data-entity-2="Actores" data-source-line="10" data-uid="lnk12" id="link_Gateway REST_Actores"><path d="M320.5,87.69 C336.14,124.32 368.8,198.78 401,259.6 C408.28,273.34 413.51,275.05 419,289.6 C431.18,321.85 429.88,331.56 433,365.89 C434.41,381.38 441.2,387.67 433,400.89 C420.19,421.57 402.1026,432.2879 380.4426,439.9979" fill="none" id="Gateway REST-to-Actores" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="374.79,442.01,384.6102,442.7603,379.5005,440.3333,381.9275,435.2235,374.79,442.01" style="stroke:#181818;stroke-width:1;"/><path d="M406,229.6 L406,254.6 L498,254.6 L498,239.6 L488,229.6 L406,229.6" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M488,229.6 L488,239.6 L498,239.6 L488,229.6" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.3159" x="412" y="246.6669">HTTP/REST</text></g><!--SRC=[XOzDIWD148NtESKZc-WYoGq4nM0M8kFqW8imYqgd8iqqtKDtvGyHF8Fty1JUn9FOam4Td4YWDg_uUFLLJRgYPyOm2rwycDf3vKKsnCjW08o-tjxRGSwMjF6E8-fWd3OrMOw9MToHy8uEo6UgA34UNs6XE6oDPgIcia6wkILkA39MZ5iI7w4UxutmF-X3qbeRJPAkOxvP7h7UicMljVZ0iVmZFtD9dZ4lYcpQQE92U2yUwmq7QZGimNv-EARB_aUJIRSOS5uOwQerhaeHlxKfiLiTWTC2JxnKNbSiPmJwtvsL-AdkIhn-0m00]--></g></svg>

# END FILE CONTENTS


# File: backend/utils.py

import hashlib
from models import Log

def cambiar_estado_rtp(db, rtp_obj, new_status):
    old_status = rtp_obj.status
    rtp_obj.status = new_status
    db.session.commit()

    # Generar un hash
    hash_input = f"{rtp_obj.id}{rtp_obj.iban}{rtp_obj.amount}{old_status}{new_status}".encode('utf-8')
    hash_value = hashlib.sha256(hash_input).hexdigest()

    nuevo_log = Log(
        rtp_id=rtp_obj.id,
        old_status=old_status,
        new_status=new_status,
        hash_value=hash_value
    )
    db.session.add(nuevo_log)
    db.session.commit()

    return {
        "message": f"RTP {rtp_obj.id} actualizado de {old_status} a {new_status}"
    }

def rechazar_rtp(db, rtp_obj, motivo):
    return cambiar_estado_rtp(db, rtp_obj, "rechazado")

import string

def validar_iban(iban: str) -> bool:
    """
    Valida un IBAN (ISO 13616) usando el algoritmo de
    “módulo 97 = 1”.

    Parámetros
    ----------
    iban : str
        IBAN en cualquier formato (con o sin espacios).

    Retorna
    -------
    bool
        True si el IBAN es sintácticamente correcto, False en caso contrario.
    """
    if not iban:
        return False

    # 1) Limpiar y normalizar
    iban = iban.replace(" ", "").upper()
    if len(iban) < 15 or len(iban) > 34 or not iban.isalnum():
        return False

    # 2) Reorganizar: los cuatro primeros caracteres al final
    rearranged = iban[4:] + iban[:4]

    # 3) Convertir letras a números (A=10, B=11, …, Z=35)
    digits = []
    for ch in rearranged:
        if ch.isdigit():
            digits.append(ch)
        elif ch.isalpha():
            digits.append(str(10 + string.ascii_uppercase.index(ch)))
        else:
            return False
    numeric_iban = int("".join(digits))

    # 4) Comprobar resto
    return numeric_iban % 97 == 1



# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/CU01.svg

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="505px" preserveAspectRatio="none" style="width:564px;height:505px;background:#FFFFFF;" version="1.1" viewBox="0 0 564 505" width="564px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="250.6719" style="stroke:#000000;stroke-width:1.5;" width="547.1226" x="10" y="156.5625"/><g><title>Beneficiario</title><rect fill="#000000" fill-opacity="0.00000" height="342.9375" width="8" x="60.4497" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="64" x2="64" y1="81.2969" y2="424.2344"/></g><g><title>PSP Beneficiario</title><rect fill="#000000" fill-opacity="0.00000" height="342.9375" width="8" x="178.46" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="181.8994" x2="181.8994" y1="81.2969" y2="424.2344"/></g><g><title>PSP Pagador</title><rect fill="#000000" fill-opacity="0.00000" height="342.9375" width="8" x="309.3354" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="312.377" x2="312.377" y1="81.2969" y2="424.2344"/></g><g><title>Sistema</title><rect fill="#000000" fill-opacity="0.00000" height="342.9375" width="8" x="507.9277" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="511.7329" x2="511.7329" y1="81.2969" y2="424.2344"/></g><g class="participant participant-head" data-participant="Beneficiario"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.8994" x="20" y="77.9951">Beneficiario</text><ellipse cx="64.4497" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M64.4497,21.5 L64.4497,48.5 M51.4497,29.5 L77.4497,29.5 M64.4497,48.5 L51.4497,63.5 M64.4497,48.5 L77.4497,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Beneficiario"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.8994" x="20" y="436.2295">Beneficiario</text><ellipse cx="64.4497" cy="448.0313" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M64.4497,456.0313 L64.4497,483.0313 M51.4497,464.0313 L77.4497,464.0313 M64.4497,483.0313 L51.4497,498.0313 M64.4497,483.0313 L77.4497,498.0313" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="PSPB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.1211" x="118.8994" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.1211" x="125.8994" y="69.9951">PSP Beneficiario</text></g><g class="participant participant-tail" data-participant="PSPB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.1211" x="118.8994" y="423.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.1211" x="125.8994" y="443.2295">PSP Beneficiario</text></g><g class="participant participant-head" data-participant="PSPP"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.917" x="262.377" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.917" x="269.377" y="69.9951">PSP Pagador</text></g><g class="participant participant-tail" data-participant="PSPP"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.917" x="262.377" y="423.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.917" x="269.377" y="443.2295">PSP Pagador</text></g><g class="participant participant-head" data-participant="Sistema"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70.3896" x="476.7329" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56.3896" x="483.7329" y="69.9951">Sistema</text></g><g class="participant participant-tail" data-participant="Sistema"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70.3896" x="476.7329" y="423.2344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56.3896" x="483.7329" y="443.2295">Sistema</text></g><g class="message" data-participant-1="Beneficiario" data-participant-2="Sistema"><polygon fill="#181818" points="499.9277,108.4297,509.9277,112.4297,499.9277,116.4297,503.9277,112.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="64.4497" x2="505.9277" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240.7539" x="71.4497" y="107.3638">POST /rtp {IBAN, importe, concepto}</text></g><g class="message" data-participant-1="Sistema" data-participant-2="PSPB"><polygon fill="#181818" points="193.46,137.5625,183.46,141.5625,193.46,145.5625,189.46,141.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="187.46" x2="510.9277" y1="141.5625" y2="141.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.0762" x="199.46" y="136.4966">Validar solicitud</text></g><path d="M10,156.5625 L74.4429,156.5625 L74.4429,163.6953 L64.4429,173.6953 L10,173.6953 L10,156.5625" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="250.6719" style="stroke:#000000;stroke-width:1.5;" width="547.1226" x="10" y="156.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="169.6294">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="105.5903" x="89.4429" y="168.7729">[Solicitud v&#225;lida]</text><g class="message" data-participant-1="PSPB" data-participant-2="PSPP"><polygon fill="#181818" points="301.3354,190.8281,311.3354,194.8281,301.3354,198.8281,305.3354,194.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="182.46" x2="307.3354" y1="194.8281" y2="194.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.8755" x="189.46" y="189.7622">Enrutar solicitud</text></g><g class="message" data-participant-1="PSPP" data-participant-2="Sistema"><polygon fill="#181818" points="499.9277,219.9609,509.9277,223.9609,499.9277,227.9609,503.9277,223.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="313.3354" x2="505.9277" y1="223.9609" y2="223.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.5923" x="320.3354" y="218.895">Confirmaci&#243;n de recepci&#243;n</text></g><g class="message" data-participant-1="Sistema" data-participant-2="Beneficiario"><polygon fill="#181818" points="75.4497,249.0938,65.4497,253.0938,75.4497,257.0938,71.4497,253.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="69.4497" x2="510.9277" y1="253.0938" y2="253.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.5664" x="81.4497" y="248.0278">RTP creado con &#233;xito</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="10" x2="557.1226" y1="262.0938" y2="262.0938"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93.2476" x="15" y="272.3042">[IBAN inv&#225;lido]</text><g class="message" data-participant-1="PSPB" data-participant-2="Sistema"><polygon fill="#181818" points="499.9277,293.0313,509.9277,297.0313,499.9277,301.0313,503.9277,297.0313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="182.46" x2="505.9277" y1="297.0313" y2="297.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.77" x="189.46" y="291.9653">Error de validaci&#243;n</text></g><g class="message" data-participant-1="Sistema" data-participant-2="Beneficiario"><polygon fill="#181818" points="75.4497,322.1641,65.4497,326.1641,75.4497,330.1641,71.4497,326.1641" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="69.4497" x2="510.9277" y1="326.1641" y2="326.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.6099" x="81.4497" y="321.0981">RTP no creado con &#233;xito (IBAN inv&#225;lido)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="10" x2="557.1226" y1="335.1641" y2="335.1641"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="176.9453" x="15" y="345.3745">[PSP Pagador no disponible]</text><g class="message" data-participant-1="PSPB" data-participant-2="Sistema"><polygon fill="#181818" points="499.9277,366.1016,509.9277,370.1016,499.9277,374.1016,503.9277,370.1016" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="182.46" x2="505.9277" y1="370.1016" y2="370.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.1646" x="189.46" y="365.0356">Error de enrutamiento</text></g><g class="message" data-participant-1="Sistema" data-participant-2="Beneficiario"><polygon fill="#181818" points="75.4497,395.2344,65.4497,399.2344,75.4497,403.2344,71.4497,399.2344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="69.4497" x2="510.9277" y1="399.2344" y2="399.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324.3906" x="81.4497" y="394.1685">RTP no creado con &#233;xito (Pagador no encontrado)</text></g><!--SRC=[dP71IiGm48RlUOfXJmehtdiGhEp1onhiudrCPsMWpOHfTX74X_7esKVeYvbqMsbHKCmfoVp__DyawA8ebEHfpuvHMKn0ZMaVq4TOsSekgYl03j9b-LrcyGbhqKbX5ugAkqWj6ZDl1XTNKw40UrVju59ZW9VRydgx1cw3QAGrEF6EGfHNCugpBpCKy80DrwZGIPDwnaDji4bXqmcE_LiM64WhEqQdBM3ZzH0Npb5Z5rGtulUiBJhkFppK14g9PJWDXXdHVB82xdSMd59waSmF_VipHm53JKUGvmFs9pXPm7q5RrJJnwJ0up3Y7nEz_11wjimxFq7ClYpRQkw2U7viw1SU6XwkPV9H_WiqooMV2b5nuFBr9m00]--></g></svg>

# END FILE CONTENTS


# File: MemoriaTFG/Imagenes/CU02.svg:Zone.Identifier



# END FILE CONTENTS


# File: backend/ext_socketio.py

# ext_socketio.py
from flask_socketio import SocketIO, join_room, emit

socketio = SocketIO()


# END FILE CONTENTS


# File: MemoriaTFG/src/codigos.tex

\lstinputlisting[language=Python, style=custom, caption={RF-01 Crear Solicitud RTP services.py}, label={lst:1}, firstline=6, lastline=52]{../backend/services.py}
\lstinputlisting[language=Python, style=custom, caption={RF-01 Crear Solicitud RTP routes.py}, label={lst:2}, firstline=14, lastline=37]{../backend/routes.py}
\lstinputlisting[language=Python, style=custom, caption={RF-01 Crear Solicitud RTP RTP.js}, label={lst:3}, firstline=40, lastline=71]{../frontend/RTP.js}

\lstinputlisting[language=Python, style=custom, caption={RF-02 Validar y enrutar RTP services.py}, label={lst:4}, firstline=53, lastline=74]{../backend/services.py}
\lstinputlisting[language=Python, style=custom, caption={RF-02 Validar y enrutar RTP routes.py}, label={lst:5}, firstline=37, lastline=53]{../backend/routes.py}
\lstinputlisting[language=Python, style=custom, caption={RF-02 Validar y enrutar RTP utils.py}, label={lst:6}, firstline=30, lastline=70]{../backend/utils.py}
\lstinputlisting[language=Python, style=custom, caption={RF-02 Validar y enrutar RTP RTP.js}, label={lst:7}, firstline=71, lastline=117]{../frontend/RTP.js}

\lstinputlisting[language=Python, style=custom, caption={RF-03 Validación pagador services.py}, label={lst:8}, firstline=74, lastline=102]{../backend/services.py}
\lstinputlisting[language=Python, style=custom, caption={RF-03 Validación pagador routes.py}, label={lst:9}, firstline=54, lastline=61]{../backend/routes.py}
\lstinputlisting[language=Python, style=custom, caption={RF-03 Validación pagador RTP.js}, label={lst:10}, firstline=117, lastline=140]{../frontend/RTP.js}

\lstinputlisting[language=Python, style=custom, caption={RF-04 Decisión final services.py}, label={lst:11}, firstline=103, lastline=137]{../backend/services.py}
\lstinputlisting[language=Python, style=custom, caption={RF-04 Decisión final routes.py}, label={lst:12}, firstline=62, lastline=70]{../backend/routes.py}
\lstinputlisting[language=Python, style=custom, caption={RF-04 Decisión final RTP.js}, label={lst:13}, firstline=141, lastline=167]{../frontend/RTP.js}



\begin{lstlisting}[language=Python, style=custom, caption={RF-05 Notificación ext\_socketio.py}, label={lst:14}]
    # ext_socketio.py
    from flask_socketio import SocketIO, join_room, emit

    socketio = SocketIO()
\end{lstlisting}


\lstinputlisting[language=Python, style=custom, caption={RF-05 Notificación services.py}, label={lst:15}, firstline=131, lastline=134]{../backend/services.py}
\lstinputlisting[language=Python, style=custom, caption={RF-05 Notificación RTP.js}, label={lst:16}, firstline=333, lastline=362]{../frontend/RTP.js}

%AQUI IRÍA RF-06

%RNF-01 no codigo necesario

%RNF-02 Depende de dockerfile

\lstinputlisting[language=Python, style=custom, caption={RNF-02 Seguridad y trazabilidad utils.py}, label={lst:17}, firstline=3, lastline=25]{../backend/utils.py}
\lstinputlisting[language=Python, style=custom, caption={RNF-02 Seguridad y trazabilidad models.py}, label={lst:18}, firstline=58, lastline=77]{../backend/models.py}

\lstinputlisting[language=Python, style=custom, caption={RNF-03 Portabilidad  config.py}, label={lst:19}, firstline=1, lastline=8]{../backend/config.py}
\lstinputlisting[language=Python, style=custom, caption={RNF-03 Portabilidad  requirements.txt}, label={lst:20}, firstline=1, lastline=3]{../backend/requirements.txt}
\lstinputlisting[language=Python, style=custom, caption={RNF-03 Portabilidad  app.py}, label={lst:21}, firstline=1, lastline=55]{../backend/app.py}

%RNF-05


\lstinputlisting[language=Python, style=custom, caption={clase Actor}, label={lst:22}, firstline=5, lastline=32]{../backend/models.py}
\lstinputlisting[language=Python, style=custom, caption={clase RTP}, label={lst:23}, firstline=34, lastline=57]{../backend/models.py}
\lstinputlisting[language=Python, style=custom, caption={clase Log}, label={lst:24}, firstline=59, lastline=76]{../backend/models.py}



# END FILE CONTENTS


# File: MemoriaTFG/main.lol

\contentsline {lstlisting}{\numberline {7.1}RF-01 Crear Solicitud RTP services.py}{65}{lstlisting.7.1}%
\contentsline {lstlisting}{\numberline {7.2}RF-01 Crear Solicitud RTP routes.py}{65}{lstlisting.7.2}%
\contentsline {lstlisting}{\numberline {7.3}RF-01 Crear Solicitud RTP RTP.js}{66}{lstlisting.7.3}%
\contentsline {lstlisting}{\numberline {7.4}RF-02 Validar y enrutar RTP services.py}{66}{lstlisting.7.4}%
\contentsline {lstlisting}{\numberline {7.5}RF-02 Validar y enrutar RTP routes.py}{67}{lstlisting.7.5}%
\contentsline {lstlisting}{\numberline {7.6}RF-02 Validar y enrutar RTP utils.py}{67}{lstlisting.7.6}%
\contentsline {lstlisting}{\numberline {7.7}RF-02 Validar y enrutar RTP RTP.js}{68}{lstlisting.7.7}%
\contentsline {lstlisting}{\numberline {7.8}RF-03 Validación pagador services.py}{69}{lstlisting.7.8}%
\contentsline {lstlisting}{\numberline {7.9}RF-03 Validación pagador routes.py}{69}{lstlisting.7.9}%
\contentsline {lstlisting}{\numberline {7.10}RF-03 Validación pagador RTP.js}{70}{lstlisting.7.10}%
\contentsline {lstlisting}{\numberline {7.11}RF-04 Decisión final services.py}{70}{lstlisting.7.11}%
\contentsline {lstlisting}{\numberline {7.12}RF-04 Decisión final routes.py}{71}{lstlisting.7.12}%
\contentsline {lstlisting}{\numberline {7.13}RF-04 Decisión final RTP.js}{71}{lstlisting.7.13}%
\contentsline {lstlisting}{\numberline {7.14}RF-05 Notificación ext\_socketio.py}{71}{lstlisting.7.14}%
\contentsline {lstlisting}{\numberline {7.15}RF-05 Notificación services.py}{72}{lstlisting.7.15}%
\contentsline {lstlisting}{\numberline {7.16}RF-05 Notificación RTP.js}{72}{lstlisting.7.16}%
\contentsline {lstlisting}{\numberline {7.17}RNF-02 Seguridad y trazabilidad utils.py}{72}{lstlisting.7.17}%
\contentsline {lstlisting}{\numberline {7.18}RNF-02 Seguridad y trazabilidad models.py}{73}{lstlisting.7.18}%
\contentsline {lstlisting}{\numberline {7.19}RNF-03 Portabilidad config.py}{73}{lstlisting.7.19}%
\contentsline {lstlisting}{\numberline {7.20}RNF-03 Portabilidad requirements.txt}{73}{lstlisting.7.20}%
\contentsline {lstlisting}{\numberline {7.21}RNF-03 Portabilidad app.py}{73}{lstlisting.7.21}%
\contentsline {lstlisting}{\numberline {7.22}clase Actor}{74}{lstlisting.7.22}%
\contentsline {lstlisting}{\numberline {7.23}clase RTP}{75}{lstlisting.7.23}%
\contentsline {lstlisting}{\numberline {7.24}clase Log}{75}{lstlisting.7.24}%


# END FILE CONTENTS


# File: MemoriaTFG/main.bbl

% $ biblatex auxiliary file $
% $ biblatex bbl format version 3.1 $
% Do not modify the above lines!
%
% This is an auxiliary file used by the 'biblatex' package.
% This file may safely be deleted. It will be recreated by
% biber as required.
%
\begingroup
\makeatletter
\@ifundefined{ver@biblatex.sty}
  {\@latex@error
     {Missing 'biblatex' package}
     {The bibliography requires the 'biblatex' package.}
      \aftergroup\endinput}
  {}
\endgroup


\refsection{0}
  \datalist[entry]{nyt/global//global/global}
    \entry{ECB_TIPS}{misc}{}
      \name{author}{1}{}{%
        {{hash=4e9fffc9229d54983a35e60a61cb5da4}{%
           family={Bank},
           familyi={B\bibinitperiod},
           given={European\bibnamedelima Central},
           giveni={E\bibinitperiod\bibinitdelim C\bibinitperiod}}}%
      }
      \strng{namehash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{fullhash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{bibnamehash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{authorbibnamehash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{authornamehash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{authorfullhash}{4e9fffc9229d54983a35e60a61cb5da4}
      \field{extraname}{1}
      \field{labelalpha}{Ban18}
      \field{sortinit}{B}
      \field{sortinithash}{8de16967003c7207dae369d874f1456e}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{Online}
      \field{note}{Consultado el 23-06-2025}
      \field{title}{{TARGET Instant Payment Settlement (TIPS)}}
      \field{year}{2018}
      \verb{urlraw}
      \verb https://www.ecb.europa.eu/paym/target/tips/html/index.en.html
      \endverb
      \verb{url}
      \verb https://www.ecb.europa.eu/paym/target/tips/html/index.en.html
      \endverb
    \endentry
    \entry{ECB_ERPB}{misc}{}
      \name{author}{1}{}{%
        {{hash=4e9fffc9229d54983a35e60a61cb5da4}{%
           family={Bank},
           familyi={B\bibinitperiod},
           given={European\bibnamedelima Central},
           giveni={E\bibinitperiod\bibinitdelim C\bibinitperiod}}}%
      }
      \strng{namehash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{fullhash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{bibnamehash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{authorbibnamehash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{authornamehash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{authorfullhash}{4e9fffc9229d54983a35e60a61cb5da4}
      \field{extraname}{2}
      \field{labelalpha}{Ban20}
      \field{sortinit}{B}
      \field{sortinithash}{8de16967003c7207dae369d874f1456e}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{PDF}
      \field{note}{Consultado el 23-06-2025}
      \field{title}{{Euro Retail Payments Board (ERPB) – SEPA Request-to-Pay status update}}
      \field{year}{2020}
      \verb{urlraw}
      \verb https://www.ecb.europa.eu/paym/groups/erpb/shared/pdf/14th-ERPB-meeting/Status_update_on_the_SEPA_request-to-pay_scheme.pdf
      \endverb
      \verb{url}
      \verb https://www.ecb.europa.eu/paym/groups/erpb/shared/pdf/14th-ERPB-meeting/Status_update_on_the_SEPA_request-to-pay_scheme.pdf
      \endverb
    \endentry
    \entry{ecb_sepa}{misc}{}
      \name{author}{1}{}{%
        {{hash=4e9fffc9229d54983a35e60a61cb5da4}{%
           family={Bank},
           familyi={B\bibinitperiod},
           given={European\bibnamedelima Central},
           giveni={E\bibinitperiod\bibinitdelim C\bibinitperiod}}}%
      }
      \strng{namehash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{fullhash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{bibnamehash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{authorbibnamehash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{authornamehash}{4e9fffc9229d54983a35e60a61cb5da4}
      \strng{authorfullhash}{4e9fffc9229d54983a35e60a61cb5da4}
      \field{extraname}{3}
      \field{labelalpha}{Ban23}
      \field{sortinit}{B}
      \field{sortinithash}{8de16967003c7207dae369d874f1456e}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{Online}
      \field{title}{{Single Euro Payments Area (SEPA) – Overview}}
      \field{year}{2023}
      \verb{urlraw}
      \verb https://www.ecb.europa.eu/paym/integration/retail/sepa/html/index.en.html
      \endverb
      \verb{url}
      \verb https://www.ecb.europa.eu/paym/integration/retail/sepa/html/index.en.html
      \endverb
    \endentry
    \entry{EBA_RT1}{misc}{}
      \name{author}{1}{}{%
        {{hash=25be8a200f984571c2e98a03d6451a2a}{%
           family={Clearing},
           familyi={C\bibinitperiod},
           given={EBA},
           giveni={E\bibinitperiod}}}%
      }
      \strng{namehash}{25be8a200f984571c2e98a03d6451a2a}
      \strng{fullhash}{25be8a200f984571c2e98a03d6451a2a}
      \strng{bibnamehash}{25be8a200f984571c2e98a03d6451a2a}
      \strng{authorbibnamehash}{25be8a200f984571c2e98a03d6451a2a}
      \strng{authornamehash}{25be8a200f984571c2e98a03d6451a2a}
      \strng{authorfullhash}{25be8a200f984571c2e98a03d6451a2a}
      \field{labelalpha}{Cle17}
      \field{sortinit}{C}
      \field{sortinithash}{4c244ceae61406cdc0cc2ce1cb1ff703}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{Online}
      \field{note}{Consultado el 23-06-2025}
      \field{title}{{RT1 – Pan-European Real-Time Gross Settlement System}}
      \field{year}{2017}
      \verb{urlraw}
      \verb https://www.ebaclearing.eu/services-instant-payments/rt1/
      \endverb
      \verb{url}
      \verb https://www.ebaclearing.eu/services-instant-payments/rt1/
      \endverb
    \endentry
    \entry{EU_IBAN_2001}{misc}{}
      \name{author}{1}{}{%
        {{hash=a9bee3ff64e0ef4f06532e455eb1658f}{%
           family={Commission},
           familyi={C\bibinitperiod},
           given={European},
           giveni={E\bibinitperiod}}}%
      }
      \strng{namehash}{a9bee3ff64e0ef4f06532e455eb1658f}
      \strng{fullhash}{a9bee3ff64e0ef4f06532e455eb1658f}
      \strng{bibnamehash}{a9bee3ff64e0ef4f06532e455eb1658f}
      \strng{authorbibnamehash}{a9bee3ff64e0ef4f06532e455eb1658f}
      \strng{authornamehash}{a9bee3ff64e0ef4f06532e455eb1658f}
      \strng{authorfullhash}{a9bee3ff64e0ef4f06532e455eb1658f}
      \field{labelalpha}{Com01}
      \field{sortinit}{C}
      \field{sortinithash}{4c244ceae61406cdc0cc2ce1cb1ff703}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{Online}
      \field{note}{Consultado el 23-06-2025}
      \field{title}{{Commission Recommendation 2001/609/EC on the use of the IBAN}}
      \field{year}{2001}
      \verb{urlraw}
      \verb https://eur-lex.europa.eu/eli/reco/2001/609/oj
      \endverb
      \verb{url}
      \verb https://eur-lex.europa.eu/eli/reco/2001/609/oj
      \endverb
    \endentry
    \entry{fourcorner_wiki}{misc}{}
      \name{author}{1}{}{%
        {{hash=e2ceeea38f8620383cfbd3e99c5c0cd8}{%
           family={contributors},
           familyi={c\bibinitperiod},
           given={Wikipedia},
           giveni={W\bibinitperiod}}}%
      }
      \strng{namehash}{e2ceeea38f8620383cfbd3e99c5c0cd8}
      \strng{fullhash}{e2ceeea38f8620383cfbd3e99c5c0cd8}
      \strng{bibnamehash}{e2ceeea38f8620383cfbd3e99c5c0cd8}
      \strng{authorbibnamehash}{e2ceeea38f8620383cfbd3e99c5c0cd8}
      \strng{authornamehash}{e2ceeea38f8620383cfbd3e99c5c0cd8}
      \strng{authorfullhash}{e2ceeea38f8620383cfbd3e99c5c0cd8}
      \field{labelalpha}{con25}
      \field{sortinit}{c}
      \field{sortinithash}{4c244ceae61406cdc0cc2ce1cb1ff703}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{Online}
      \field{note}{Consultado el 23-06-2025}
      \field{title}{{Four Corners Model for Payment Security}}
      \field{year}{2025}
      \verb{urlraw}
      \verb https://en.wikipedia.org/wiki/Four_Corners_Model_for_Payment_Security
      \endverb
      \verb{url}
      \verb https://en.wikipedia.org/wiki/Four_Corners_Model_for_Payment_Security
      \endverb
    \endentry
    \entry{epc098_2021}{misc}{}
      \name{author}{1}{}{%
        {{hash=ea98b1a37c0d13b9bc31c061f6b41258}{%
           family={Council},
           familyi={C\bibinitperiod},
           given={European\bibnamedelima Payments},
           giveni={E\bibinitperiod\bibinitdelim P\bibinitperiod}}}%
      }
      \strng{namehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{fullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{bibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorbibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authornamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorfullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \field{extraname}{1}
      \field{labelalpha}{Cou21}
      \field{sortinit}{C}
      \field{sortinithash}{4c244ceae61406cdc0cc2ce1cb1ff703}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{PDF}
      \field{note}{Consultado el 23-06-2025}
      \field{title}{{EDS – EPC Directory Service Rulebook v1.0}}
      \field{year}{2021}
      \verb{urlraw}
      \verb https://www.europeanpaymentscouncil.eu/document-library/rulebooks/epc098-21-eds-directory-service-rulebook-version-10
      \endverb
      \verb{url}
      \verb https://www.europeanpaymentscouncil.eu/document-library/rulebooks/epc098-21-eds-directory-service-rulebook-version-10
      \endverb
    \endentry
    \entry{epc137}{misc}{}
      \name{author}{1}{}{%
        {{hash=ea98b1a37c0d13b9bc31c061f6b41258}{%
           family={Council},
           familyi={C\bibinitperiod},
           given={European\bibnamedelima Payments},
           giveni={E\bibinitperiod\bibinitdelim P\bibinitperiod}}}%
      }
      \strng{namehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{fullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{bibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorbibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authornamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorfullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \field{extraname}{2}
      \field{labelalpha}{Cou23}
      \field{sortinit}{C}
      \field{sortinithash}{4c244ceae61406cdc0cc2ce1cb1ff703}
      \field{extraalpha}{1}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{title}{{EPC137 - SRTP Implementation Guidelines}}
      \field{year}{2023}
      \true{nocite}
      \verb{urlraw}
      \verb https://www.europeanpaymentscouncil.eu/document-library/implementation-guidelines/sepa-request-pay-implementation-guidelines-version-30
      \endverb
      \verb{url}
      \verb https://www.europeanpaymentscouncil.eu/document-library/implementation-guidelines/sepa-request-pay-implementation-guidelines-version-30
      \endverb
    \endentry
    \entry{epc164}{misc}{}
      \name{author}{1}{}{%
        {{hash=ea98b1a37c0d13b9bc31c061f6b41258}{%
           family={Council},
           familyi={C\bibinitperiod},
           given={European\bibnamedelima Payments},
           giveni={E\bibinitperiod\bibinitdelim P\bibinitperiod}}}%
      }
      \strng{namehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{fullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{bibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorbibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authornamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorfullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \field{extraname}{3}
      \field{labelalpha}{Cou23}
      \field{sortinit}{C}
      \field{sortinithash}{4c244ceae61406cdc0cc2ce1cb1ff703}
      \field{extraalpha}{2}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{title}{{EPC164 - API Security Framework}}
      \field{year}{2023}
      \true{nocite}
      \verb{urlraw}
      \verb https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2024-10/EPC164-22%20v2.0%20API%20Security%20Framework.pdf
      \endverb
      \verb{url}
      \verb https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2024-10/EPC164-22%20v2.0%20API%20Security%20Framework.pdf
      \endverb
    \endentry
    \entry{epc125_2023}{misc}{}
      \name{author}{1}{}{%
        {{hash=ea98b1a37c0d13b9bc31c061f6b41258}{%
           family={Council},
           familyi={C\bibinitperiod},
           given={European\bibnamedelima Payments},
           giveni={E\bibinitperiod\bibinitdelim P\bibinitperiod}}}%
      }
      \strng{namehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{fullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{bibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorbibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authornamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorfullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \field{extraname}{4}
      \field{labelalpha}{Cou23}
      \field{sortinit}{C}
      \field{sortinithash}{4c244ceae61406cdc0cc2ce1cb1ff703}
      \field{extraalpha}{3}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{PDF}
      \field{note}{Consultado el 23-06-2025}
      \field{title}{{SEPA Credit Transfer Scheme Rulebook v1.1}}
      \field{year}{2023}
      \verb{urlraw}
      \verb https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2023-11/EPC125-05%202023%20SCT%20Rulebook%20version%201.1_1.pdf
      \endverb
      \verb{url}
      \verb https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2023-11/EPC125-05%202023%20SCT%20Rulebook%20version%201.1_1.pdf
      \endverb
    \endentry
    \entry{epc_sdd_2025}{misc}{}
      \name{author}{1}{}{%
        {{hash=ea98b1a37c0d13b9bc31c061f6b41258}{%
           family={Council},
           familyi={C\bibinitperiod},
           given={European\bibnamedelima Payments},
           giveni={E\bibinitperiod\bibinitdelim P\bibinitperiod}}}%
      }
      \strng{namehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{fullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{bibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorbibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authornamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorfullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \field{extraname}{5}
      \field{labelalpha}{Cou24}
      \field{sortinit}{C}
      \field{sortinithash}{4c244ceae61406cdc0cc2ce1cb1ff703}
      \field{extraalpha}{1}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{PDF}
      \field{title}{{2025 SEPA Direct Debit Core Rulebook v1.0}}
      \field{year}{2024}
      \verb{urlraw}
      \verb https://www.europeanpaymentscouncil.eu/document-library/rulebooks/2025-sepa-direct-debit-core-rulebook-version-10
      \endverb
      \verb{url}
      \verb https://www.europeanpaymentscouncil.eu/document-library/rulebooks/2025-sepa-direct-debit-core-rulebook-version-10
      \endverb
    \endentry
    \entry{epc_sctinst_2025}{misc}{}
      \name{author}{1}{}{%
        {{hash=ea98b1a37c0d13b9bc31c061f6b41258}{%
           family={Council},
           familyi={C\bibinitperiod},
           given={European\bibnamedelima Payments},
           giveni={E\bibinitperiod\bibinitdelim P\bibinitperiod}}}%
      }
      \strng{namehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{fullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{bibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorbibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authornamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorfullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \field{extraname}{6}
      \field{labelalpha}{Cou24}
      \field{sortinit}{C}
      \field{sortinithash}{4c244ceae61406cdc0cc2ce1cb1ff703}
      \field{extraalpha}{2}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{PDF}
      \field{title}{{2025 SEPA Instant Credit Transfer Rulebook v1.0}}
      \field{year}{2024}
      \verb{urlraw}
      \verb https://www.europeanpaymentscouncil.eu/document-library/rulebooks/2025-sepa-instant-credit-transfer-rulebook-version-10
      \endverb
      \verb{url}
      \verb https://www.europeanpaymentscouncil.eu/document-library/rulebooks/2025-sepa-instant-credit-transfer-rulebook-version-10
      \endverb
    \endentry
    \entry{EPC_official}{misc}{}
      \name{author}{1}{}{%
        {{hash=ea98b1a37c0d13b9bc31c061f6b41258}{%
           family={Council},
           familyi={C\bibinitperiod},
           given={European\bibnamedelima Payments},
           giveni={E\bibinitperiod\bibinitdelim P\bibinitperiod}}}%
      }
      \strng{namehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{fullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{bibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorbibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authornamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorfullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \field{extraname}{7}
      \field{labelalpha}{Cou25}
      \field{sortinit}{C}
      \field{sortinithash}{4c244ceae61406cdc0cc2ce1cb1ff703}
      \field{extraalpha}{1}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{Online}
      \field{note}{Consultado el 23-06-2025}
      \field{title}{{European Payments Council (EPC) – Official Website}}
      \field{year}{2025}
      \verb{urlraw}
      \verb https://www.europeanpaymentscouncil.eu/
      \endverb
      \verb{url}
      \verb https://www.europeanpaymentscouncil.eu/
      \endverb
    \endentry
    \entry{epc016}{misc}{}
      \name{author}{1}{}{%
        {{hash=ea98b1a37c0d13b9bc31c061f6b41258}{%
           family={Council},
           familyi={C\bibinitperiod},
           given={European\bibnamedelima Payments},
           giveni={E\bibinitperiod\bibinitdelim P\bibinitperiod}}}%
      }
      \strng{namehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{fullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{bibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorbibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authornamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorfullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \field{extraname}{8}
      \field{labelalpha}{Cou25}
      \field{sortinit}{C}
      \field{sortinithash}{4c244ceae61406cdc0cc2ce1cb1ff703}
      \field{extraalpha}{2}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{PDF}
      \field{title}{{SEPA Direct Debit Core Scheme Rulebook v1.0}}
      \field{year}{2025}
      \verb{urlraw}
      \verb https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2024-11/EPC016-06%202025%20SDD%20Core%20Rulebook%20version%201.0.pdf
      \endverb
      \verb{url}
      \verb https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2024-11/EPC016-06%202025%20SDD%20Core%20Rulebook%20version%201.0.pdf
      \endverb
    \endentry
    \entry{epc014}{misc}{}
      \name{author}{1}{}{%
        {{hash=ea98b1a37c0d13b9bc31c061f6b41258}{%
           family={Council},
           familyi={C\bibinitperiod},
           given={European\bibnamedelima Payments},
           giveni={E\bibinitperiod\bibinitdelim P\bibinitperiod}}}%
      }
      \strng{namehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{fullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{bibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorbibnamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authornamehash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \strng{authorfullhash}{ea98b1a37c0d13b9bc31c061f6b41258}
      \field{extraname}{9}
      \field{labelalpha}{Cou25}
      \field{sortinit}{C}
      \field{sortinithash}{4c244ceae61406cdc0cc2ce1cb1ff703}
      \field{extraalpha}{3}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{title}{{SRTP Scheme Rulebook v4.0}}
      \field{year}{2025}
      \verb{urlraw}
      \verb https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2024-11/EPC014-20%20v4.0%20SEPA%20RTP%20Scheme%20Rulebook.pdf
      \endverb
      \verb{url}
      \verb https://www.europeanpaymentscouncil.eu/sites/default/files/kb/file/2024-11/EPC014-20%20v4.0%20SEPA%20RTP%20Scheme%20Rulebook.pdf
      \endverb
    \endentry
    \entry{EC_2018_RTS_SCA}{misc}{}
      \name{author}{1}{}{%
        {{hash=a1b813a6e85874b4c945aec2cdbea74c}{%
           family={{European Commission}},
           familyi={E\bibinitperiod}}}%
      }
      \strng{namehash}{a1b813a6e85874b4c945aec2cdbea74c}
      \strng{fullhash}{a1b813a6e85874b4c945aec2cdbea74c}
      \strng{bibnamehash}{a1b813a6e85874b4c945aec2cdbea74c}
      \strng{authorbibnamehash}{a1b813a6e85874b4c945aec2cdbea74c}
      \strng{authornamehash}{a1b813a6e85874b4c945aec2cdbea74c}
      \strng{authorfullhash}{a1b813a6e85874b4c945aec2cdbea74c}
      \field{labelalpha}{Eur18}
      \field{sortinit}{E}
      \field{sortinithash}{c554bd1a0b76ea92b9f105fe36d9c7b0}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{Online}
      \field{title}{{Commission Delegated Regulation (EU) 2018/389 of 27 November 2017 supplementing Directive (EU) 2015/2366 with regard to regulatory technical standards for strong customer authentication and common and secure open standards of communication}}
      \field{year}{2018}
      \verb{urlraw}
      \verb https://eur-lex.europa.eu/legal-content/EN/TXT/PDF/?uri=CELEX:32018R0389
      \endverb
      \verb{url}
      \verb https://eur-lex.europa.eu/legal-content/EN/TXT/PDF/?uri=CELEX:32018R0389
      \endverb
    \endentry
    \entry{eu_260_2012}{misc}{}
      \name{author}{1}{}{%
        {{hash=3179956fa9e74184739a2680047976ee}{%
           family={{European Parliament and Council}},
           familyi={E\bibinitperiod}}}%
      }
      \strng{namehash}{3179956fa9e74184739a2680047976ee}
      \strng{fullhash}{3179956fa9e74184739a2680047976ee}
      \strng{bibnamehash}{3179956fa9e74184739a2680047976ee}
      \strng{authorbibnamehash}{3179956fa9e74184739a2680047976ee}
      \strng{authornamehash}{3179956fa9e74184739a2680047976ee}
      \strng{authorfullhash}{3179956fa9e74184739a2680047976ee}
      \field{labelalpha}{Eur12}
      \field{sortinit}{E}
      \field{sortinithash}{c554bd1a0b76ea92b9f105fe36d9c7b0}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{Online}
      \field{note}{Consultado el 23-06-2025}
      \field{title}{{Regulation (EU) No 260/2012 of 14 March 2012 on the establishment of technical and business requirements for credit transfers and direct debits in euros}}
      \field{year}{2012}
      \verb{urlraw}
      \verb https://eur-lex.europa.eu/eli/reg/2012/260/oj
      \endverb
      \verb{url}
      \verb https://eur-lex.europa.eu/eli/reg/2012/260/oj
      \endverb
    \endentry
    \entry{sdd_chargebacks_adyen}{misc}{}
      \name{author}{1}{}{%
        {{hash=57c3cbb2900921a5e689683d906e78d5}{%
           family={N.V.},
           familyi={N\bibinitperiod},
           given={Adyen},
           giveni={A\bibinitperiod}}}%
      }
      \strng{namehash}{57c3cbb2900921a5e689683d906e78d5}
      \strng{fullhash}{57c3cbb2900921a5e689683d906e78d5}
      \strng{bibnamehash}{57c3cbb2900921a5e689683d906e78d5}
      \strng{authorbibnamehash}{57c3cbb2900921a5e689683d906e78d5}
      \strng{authornamehash}{57c3cbb2900921a5e689683d906e78d5}
      \strng{authorfullhash}{57c3cbb2900921a5e689683d906e78d5}
      \field{labelalpha}{NV24}
      \field{sortinit}{N}
      \field{sortinithash}{98cf339a479c0454fe09153a08675a15}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{Online}
      \field{title}{{SEPA chargebacks – guidelines}}
      \field{year}{2024}
      \true{nocite}
      \verb{urlraw}
      \verb https://docs.adyen.com/risk-management/chargeback-guidelines/sepa-chargebacks/
      \endverb
      \verb{url}
      \verb https://docs.adyen.com/risk-management/chargeback-guidelines/sepa-chargebacks/
      \endverb
    \endentry
    \entry{reg260_2012}{misc}{}
      \name{author}{2}{}{%
        {{hash=c25d305ea83de23a244dd39c979ff060}{%
           family={Parliament},
           familyi={P\bibinitperiod},
           given={European},
           giveni={E\bibinitperiod}}}%
        {{hash=842ce398b1702101f875c12f96474778}{%
           family={Council},
           familyi={C\bibinitperiod}}}%
      }
      \strng{namehash}{483cdb9be83ff2a79f86cddbd546801f}
      \strng{fullhash}{483cdb9be83ff2a79f86cddbd546801f}
      \strng{bibnamehash}{483cdb9be83ff2a79f86cddbd546801f}
      \strng{authorbibnamehash}{483cdb9be83ff2a79f86cddbd546801f}
      \strng{authornamehash}{483cdb9be83ff2a79f86cddbd546801f}
      \strng{authorfullhash}{483cdb9be83ff2a79f86cddbd546801f}
      \field{labelalpha}{PC12}
      \field{sortinit}{P}
      \field{sortinithash}{bb5b15f2db90f7aef79bb9e83defefcb}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{Online}
      \field{title}{{Regulation (EU) No 260/2012 on credit transfers and direct debits}}
      \field{year}{2012}
      \true{nocite}
      \verb{urlraw}
      \verb https://eur-lex.europa.eu/eli/reg/2012/260/oj
      \endverb
      \verb{url}
      \verb https://eur-lex.europa.eu/eli/reg/2012/260/oj
      \endverb
    \endentry
    \entry{sdd_study_steinbeis}{misc}{}
      \name{author}{1}{}{%
        {{hash=1003db1fc58de142f1ee1aa09bcdfbc0}{%
           family={Research\bibnamedelimb Center\bibnamedelimb for\bibnamedelimb Financial\bibnamedelima Services},
           familyi={R\bibinitperiod\bibinitdelim C\bibinitperiod\bibinitdelim f\bibinitperiod\bibinitdelim F\bibinitperiod\bibinitdelim S\bibinitperiod},
           given={Steinbeis\bibnamedelimb University\bibnamedelima Berlin},
           giveni={S\bibinitperiod\bibinitdelim U\bibinitperiod\bibinitdelim B\bibinitperiod}}}%
      }
      \strng{namehash}{1003db1fc58de142f1ee1aa09bcdfbc0}
      \strng{fullhash}{1003db1fc58de142f1ee1aa09bcdfbc0}
      \strng{bibnamehash}{1003db1fc58de142f1ee1aa09bcdfbc0}
      \strng{authorbibnamehash}{1003db1fc58de142f1ee1aa09bcdfbc0}
      \strng{authornamehash}{1003db1fc58de142f1ee1aa09bcdfbc0}
      \strng{authorfullhash}{1003db1fc58de142f1ee1aa09bcdfbc0}
      \field{labelalpha}{Res10}
      \field{sortinit}{R}
      \field{sortinithash}{b9c68a358aea118dfa887b6e902414a7}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{PDF}
      \field{title}{{SEPA Direct Debit – a success story for the European payment market}}
      \field{year}{2010}
      \true{nocite}
      \verb{urlraw}
      \verb https://www.steinbeis-research.de/pdf/Study_SEPA_Direct_Debit.pdf
      \endverb
      \verb{url}
      \verb https://www.steinbeis-research.de/pdf/Study_SEPA_Direct_Debit.pdf
      \endverb
    \endentry
    \entry{iso20022_55005}{misc}{}
      \name{author}{1}{}{%
        {{hash=d09e7fcc2435a0349538e27d16bc4365}{%
           family={Standardization},
           familyi={S\bibinitperiod},
           given={International\bibnamedelima Organization},
           giveni={I\bibinitperiod\bibinitdelim O\bibinitperiod},
           prefix={for},
           prefixi={f\bibinitperiod}}}%
      }
      \strng{namehash}{d09e7fcc2435a0349538e27d16bc4365}
      \strng{fullhash}{d09e7fcc2435a0349538e27d16bc4365}
      \strng{bibnamehash}{d09e7fcc2435a0349538e27d16bc4365}
      \strng{authorbibnamehash}{d09e7fcc2435a0349538e27d16bc4365}
      \strng{authornamehash}{d09e7fcc2435a0349538e27d16bc4365}
      \strng{authorfullhash}{d09e7fcc2435a0349538e27d16bc4365}
      \field{labelalpha}{Sta13}
      \field{sortinit}{S}
      \field{sortinithash}{c319cff79d99c853d775f88277d4e45f}
      \field{labelnamesource}{author}
      \field{labeltitlesource}{title}
      \field{howpublished}{Online}
      \field{title}{{ISO 20022 Financial services – Universal financial industry message scheme}}
      \field{year}{2013}
      \verb{urlraw}
      \verb https://www.iso.org/standard/55005.html
      \endverb
      \verb{url}
      \verb https://www.iso.org/standard/55005.html
      \endverb
    \endentry
  \enddatalist
\endrefsection
\endinput



# END FILE CONTENTS
